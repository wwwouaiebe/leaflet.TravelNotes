/*! leaflet.travelnotes - version 1.5.0 - build 0203 - 2019-11-06T14:25:27+0100 - Copyright 2017 2019 wwwouaiebe - Contact: http//www.ouaie.be/ - This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.*/


!function r(i,s,l){function d(t,e){if(!s[t]){if(!i[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(c)return c(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var a=s[t]={exports:{}};i[t][0].call(a.exports,function(e){return d(i[t][1][e]||e)},a,a.exports,r,i,s,l)}return s[t].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)d(l[e]);return d}({1:[function(e,t,o){"use strict";var n={};function r(e){return Math.floor(Math.abs(e)+.5)*(0<=e?1:-1)}function s(e,t,o){var n=(e=r(e*o))-(t=r(t*o));n<<=1,e-t<0&&(n=~n);for(var a="";32<=n;)a+=String.fromCharCode(63+(32|31&n)),n>>=5;return a+=String.fromCharCode(n+63)}function a(e){for(var t=[],o=0;o<e.length;o++)t.push(e[o].slice().reverse());return t}n.decode=function(e,t){for(var o,n=0,a=0,r=0,i=[],s=0,l=0,d=null,c=Math.pow(10,Number.isInteger(t)?t:5);n<e.length;){for(d=null,l=s=0;l|=(31&(d=e.charCodeAt(n++)-63))<<s,s+=5,32<=d;);for(o=1&l?~(l>>1):l>>1,s=l=0;l|=(31&(d=e.charCodeAt(n++)-63))<<s,s+=5,32<=d;);a+=o,r+=1&l?~(l>>1):l>>1,i.push([a/c,r/c])}return i},n.encode=function(e,t){if(!e.length)return"";for(var o=Math.pow(10,Number.isInteger(t)?t:5),n=s(e[0][0],0,o)+s(e[0][1],0,o),a=1;a<e.length;a++){var r=e[a],i=e[a-1];n+=s(r[0],i[0],o),n+=s(r[1],i[1],o)}return n},n.fromGeoJSON=function(e,t){if(e&&"Feature"===e.type&&(e=e.geometry),!e||"LineString"!==e.type)throw new Error("Input must be a GeoJSON LineString");return n.encode(a(e.coordinates),t)},n.toGeoJSON=function(e,t){return{type:"LineString",coordinates:a(n.decode(e,t))}},"object"==typeof t&&t.exports&&(t.exports=n)},{}],2:[function(v,e,t){!function(){"use strict";var c=v("../L.TravelNotes"),s=!1;void 0!==e&&e.exports&&(e.exports=function(){function o(){for(var e=c.travel.routes.iterator,t=0;!e.done;){e.value.chain?(e.value.chainedDistance=t,t+=e.value.distance):e.value.chainedDistance=0;for(var o=e.value.notes.iterator;!o.done;)o.value.chainedDistance=e.value.chainedDistance}}var n=v("../Data/DataSearchEngine")(),a=v("../UI/Translator")(),r=(v("../core/NoteEditor")(),v("../core/MapEditor")()),i=v("../UI/RouteEditorUI")(),u=function(e,t){if(0===e.itinerary.itineraryPoints.length)return null;for(var o=e.itinerary.itineraryPoints.iterator,n=(o.done,Number.MAX_VALUE),a=L.Projection.SphericalMercator.project(L.latLng(t[0],t[1])),r=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),i=null,s=0,l=o.value.distance;!o.done;){var d=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),c=L.LineUtil.pointToSegmentDistance(a,r,d);c<n&&(n=c,s=l-(i=L.Projection.SphericalMercator.unproject(L.LineUtil.closestPointOnSegment(a,r,d))).distanceTo(L.latLng(o.value.lat,o.value.lng))),l+=o.value.distance,r=d}return{latLng:[i.lat,i.lng],distance:s}},t=function(){if(r.removeRoute(c.travel.editedRoute,!0,!0),-1!==c.editedRouteObjId){var e=n.getRoute(c.editedRouteObjId);e.edited=0,r.addRoute(e,!0,!1)}c.travel.editedRoute=v("../data/Route")(),c.editedRouteObjId=-1,v("../UI/TravelEditorUI")().setRoutesList(),i.setWayPointsList(),i.reduce(),v("../UI/DataPanesUI")().setItinerary(),o(),v("../core/TravelEditor")().updateRoadBook()};return Object.seal({cutRoute:function(e,t){return function(e,t){var o=[v("../data/Route")(),v("../data/Route")()];o[0].object=e.object,o[1].object=e.object,o[0].itinerary.itineraryPoints.removeAll(),o[1].itinerary.itineraryPoints.removeAll();for(var n,a=u(e,t),r=e.itinerary.itineraryPoints.iterator,i=0,s=null,l=0;!r.done;){if((n=v("../data/ItineraryPoint")()).object=r.value.object,0===l&&0!=i&&i>a.distance){var d=L.latLng(a.latLng).distanceTo(L.latLng(r.value.latLng)),c=v("../data/ItineraryPoint")();c.latLng=a.latLng,o[0].itinerary.itineraryPoints.add(c),o[0].distance=i-d,s&&(s.distance-=d),l=1,(c=v("../data/ItineraryPoint")()).latLng=a.latLng,c.distance=d,o[1].itinerary.itineraryPoints.add(c),i=d}o[l].itinerary.itineraryPoints.add(n),i+=r.value.distance,s=n}return o[l].distance=i,o}(e,t)},computeRouteDistances:function(e){!function(e){var t=e.itinerary.itineraryPoints.iterator,o=e.itinerary.maneuvers.iterator;t.done;o.done;var n=t.value,a=o.value;for(a.distance=0,o.done,e.distance=0,e.duration=0;!t.done;)n.distance=L.latLng(n.latLng).distanceTo(L.latLng(t.value.latLng)),o.value.itineraryPointObjId===t.value.objId&&(e.duration+=a.duration,a=o.value,o.value.distance=0,o.done),e.distance+=n.distance,a.distance+=n.distance,n=t.value}(e)},getClosestLatLngDistance:function(e,t){return u(e,t)},saveGpx:function(){!function(){var e="\n\t",t="\n\t\t",o="time='"+(new Date).toISOString()+"' ",n="<?xml version='1.0'?>\n";n+="<gpx xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xsi:schemaLocation='http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd' version='1.1' creator='leaflet.TravelNotes'>";for(var a=c.travel.editedRoute.wayPoints.iterator;!a.done;)n+=e+"<wpt lat='"+a.value.lat+"' lon='"+a.value.lng+"' "+o+"/>";n+=e+"<rte>";for(var r=c.travel.editedRoute.itinerary.maneuvers.iterator;!r.done;){var i=c.travel.editedRoute.itinerary.itineraryPoints.getAt(r.value.itineraryPointObjId),s=r.value.instruction.replace("&","&amp;").replace("'","&apos;").replace('"',"&quote;").replace(">","&gt;").replace("<","&lt;");n+=t+"<rtept lat='"+i.lat+"' lon='"+i.lng+"' "+o+"desc='"+s+"' />"}n+=e+"</rte>",n+=e+"<trk>",n+=t+"<trkseg>";for(var l=c.travel.editedRoute.itinerary.itineraryPoints.iterator;!l.done;)n+="\n\t\t\t<trkpt lat='"+l.value.lat+"' lon='"+l.value.lng+"' "+o+" />";n+=t+"</trkseg>",n+=e+"</trk>",n+="\n</gpx>";var d=c.travel.editedRoute.name;""===d&&(d="TravelNote"),d+=".gpx",v("../util/Utilities")().saveFile(d,n)}()},getRouteHTML:function(e,t){return function(e,t){var o=v("../util/Utilities")(),n='<div class="'+t+'Route-Header-Name">'+e.name+"</div>";return 0!==e.distance&&(n+='<div class="'+t+'Route-Header-Distance">'+a.getText("RouteEditor - Distance",{distance:o.formatDistance(e.distance)})+"</div>"),c.travel.readOnly||(n+='<div class="'+t+'Route-Header-Duration">'+a.getText("RouteEditor - Duration",{duration:o.formatTime(e.duration)})+"</div>"),n}(e,t)},chainRoutes:function(){o()},startRouting:function(){c.config.routing.auto&&(s=0===c.travel.editedRoute.itinerary.itineraryPoints.length,v("../core/Router")().startRouting(c.travel.editedRoute))},endRouting:function(){!function(){r.removeRoute(c.travel.editedRoute,!0,!0);for(var e=c.travel.editedRoute.notes.iterator;!e.done;){var t=u(c.travel.editedRoute,e.value.latLng);e.value.latLng=t.latLng,e.value.distance=t.distance}c.travel.editedRoute.notes.sort(function(e,t){return e.distance-t.distance}),r.addRoute(c.travel.editedRoute,!0,!0),s&&r.zoomToRoute(c.travel.editedRoute.objId),v("../UI/DataPanesUI")().setItinerary(),i.setWayPointsList(),o(),v("../core/TravelEditor")().updateRoadBook()}()},saveEdition:function(){!function(){var e=v("../data/Route")();e.object=c.travel.editedRoute.object,c.travel.routes.replace(c.editedRouteObjId,e),c.editedRouteObjId=e.objId,t()}()},cancelEdition:function(){t()},routeProperties:function(e){!function(e){var t=n.getRoute(e);v("../UI/RoutePropertiesDialog")(t)}(e)},hideRoute:function(e){!function(e){var t=n.getRoute(e);t&&(r.removeRoute(t,!0,!0),t.hidden=!0)}(e)},showRoutes:function(){!function(){for(var e=c.travel.routes.iterator;!e.done;)e.value.hidden&&r.addRoute(e.value,!0,!0,!1)}()}})})}()},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/DataPanesUI":14,"../UI/RouteEditorUI":22,"../UI/RoutePropertiesDialog":23,"../UI/Translator":26,"../UI/TravelEditorUI":27,"../core/MapEditor":34,"../core/NoteEditor":35,"../core/Router":38,"../core/TravelEditor":40,"../data/ItineraryPoint":47,"../data/Route":52,"../util/Utilities":58}],3:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var n=e("../L.TravelNotes");return Object.seal({getRoute:function(e){return function(e){var t=null;return(t=n.travel.routes.getAt(e))||e===n.travel.editedRoute.objId&&(t=n.travel.editedRoute),t||console.log("Invalid noteObjId "+e+" for function DataSearchEngine.getRoute ( )"),t}(e)},getNoteAndRoute:function(e){return function(e){var t=null;if(t=n.travel.notes.getAt(e))return{note:t,route:null};for(var o=n.travel.routes.iterator;!o.done;)if(t=o.value.notes.getAt(e))return{note:t,route:o.value};return(t=n.travel.editedRoute.notes.getAt(e))?{note:t,route:n.travel.editedRoute}:(console.log("Invalid noteObjId "+e+" for function DataSearchEngine.getNote ( )"),{note:null,route:null})}(e)},getWayPoint:function(e){return function(e){for(var t=null,o=n.travel.routes.iterator;!o.done;)if(t=o.value.wayPoints.getAt(e))return t;return(t=n.travel.editedRoute.wayPoints.getAt(e))||(console.log("Invalid wayPointObjId "+e+" for function DataSearchEngine.getWayPoint ( )"),null)}(e)}})})}()},{"../L.TravelNotes":8}],4:[function(u,e,t){!function(){"use strict";var c=u("../data/ObjType")("Itinerary",u("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var r="",i="",s=u("../data/Collection")("ItineraryPoint"),l=u("../data/Collection")("Maneuver"),d=u("../data/ObjId")();return Object.seal({get itineraryPoints(){return s},get maneuvers(){return l},get provider(){return r},set provider(e){r=e},get transitMode(){return i},set transitMode(e){i=e},get objId(){return d},get objType(){return c},get object(){return{itineraryPoints:s.object,maneuvers:l.object,provider:r,transitMode:i,objId:d,objType:c.object}},set object(e){!function(e){e=c.validate(e),s.object=e.itineraryPoints||[],l.object=e.maneuvers||[],r=e.provider||"",i=e.transitMode||"",d=u("../data/ObjId")();for(var t=new Map,o=0,n=s.iterator;!n.done;)t.set(e.itineraryPoints[o].objId,n.value.objId),o++;for(var a=l.iterator;!a.done;)a.value.itineraryPointObjId=t.get(a.value.itineraryPointObjId)}(e)}})})}()},{"../data/Collection":43,"../data/ObjId":50,"../data/ObjType":51,"./Version":7}],5:[function(f,e,t){!function(){"use strict";var m=f("../data/ObjType")("Route",f("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var t="",o=f("../data/Collection")("WayPoint");o.add(f("../data/Waypoint")()),o.add(f("../data/Waypoint")());var n=f("../data/Collection")("Note"),a=f("../data/Itinerary")(),r=5,i="#ff0000",s=0;f("../L.TravelNotes").config&&(r=f("../L.TravelNotes").config.route.width,i=f("../L.TravelNotes").config.route.color,s=f("../L.TravelNotes").config.route.dashArray);var l=!1,d=0,c=0,u=0,v=0,g=!1,p=f("../data/ObjId")();return Object.seal({get wayPoints(){return o},get itinerary(){return a},get notes(){return n},get name(){return t},set name(e){t=e},get width(){return r},set width(e){r=e},get color(){return i},set color(e){i=e},get dashArray(){return s},set dashArray(e){s=e},get chain(){return l},set chain(e){l=e},get chainedDistance(){return d},set chainedDistance(e){d=e},get distance(){return c},set distance(e){c=e},get duration(){return u},set duration(e){u=e},get edited(){return v},set edited(e){!function(e){if("number"!=typeof e||e<0||2<e)throw"Invalid value for Route.edited : "+e;v=e}(e)},get hidden(){return g},set hidden(e){g=e},get objId(){return p},get objType(){return m},get object(){return{name:t,wayPoints:o.object,notes:n.object,itinerary:a.object,width:r,color:i,dashArray:s,chain:l,distance:parseFloat(c.toFixed(2)),duration:u,edited:v,hidden:g,chainedDistance:parseFloat(d.toFixed(2)),objId:p,objType:m.object}},set object(e){!function(e){e=m.validate(e),t=e.name||"",o.object=e.wayPoints||[],n.object=e.notes||[],a.object=e.itinerary||f("./Itinerary")().object,r=e.width||5,i=e.color||"#000000",s=e.dashArray||0,l=e.chain||!1,c=e.distance,u=e.duration,v=e.edited||0,g=e.hidden||!1,d=e.chainedDistance,p=f("../data/ObjId")()}(e)}})})}()},{"../L.TravelNotes":8,"../data/Collection":43,"../data/Itinerary":46,"../data/ObjId":50,"../data/ObjType":51,"../data/Waypoint":57,"./Itinerary":4,"./Version":7}],6:[function(d,e,t){!function(){"use strict";var l=d("../data/ObjType")("Travel",d("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var t=d("../data/Route")(),o="TravelNotes",n=d("../data/Collection")("Route"),a=d("../data/Collection")("Note"),r=d("../data/ObjId")(),i=!1,s={};return Object.seal({get editedRoute(){return t},set editedRoute(e){t=e},get routes(){return n},get notes(){return a},get name(){return o},set name(e){o=e},get readOnly(){return i},set readOnly(e){i=e},get userData(){return s},set userData(e){s=e},get objId(){return r},get objType(){return l},get object(){return{editedRoute:t.object,name:o,routes:n.object,notes:a.object,userData:s,readOnly:i,objId:r,objType:l.object}},set object(e){!function(e){e=l.validate(e),t.object=e.editedRoute||d("../data/Route")(),o=e.name||"",s=e.userData||{},i=e.readOnly||!1,n.object=e.routes||[],a.object=e.notes||[],r=d("../data/ObjId")()}(e)}})})}()},{"../data/Collection":43,"../data/ObjId":50,"../data/ObjType":51,"../data/Route":52,"./Version":7}],7:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports="1.5.0")}()},{}],8:[function(g,e,t){!function(){"use strict";L.travelNotes=function(){var r=g("./data/TravelNotesData")();void 0!==e&&e.exports&&(e.exports=r);function n(t,o){var n=new XMLHttpRequest;n.timeout=2e4,n.ontimeout=function(e){o("XMLHttpRequest TimeOut. File : "+n.responseURL)},n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){var e;try{e=JSON.parse(n.responseText)}catch(e){o("JSON parsing error. File : "+n.responseURL)}t(e)}else o("Error XMLHttpRequest - Status : "+n.status+" - StatusText : "+n.statusText+" - File : "+n.responseURL)},n.open("GET",v,!0),n.overrideMimeType("application/json"),n.send(null)}function o(e,t){r.map=e,function(){var a="?";decodeURI(window.location.search).substr(1).split("&").forEach(function(e){if("fil="===e.substr(0,4).toLowerCase())u=decodeURIComponent(escape(atob(e.substr(4)))),a+="?"===a?"":"&",a+=e;else{var t=e.split("=");if(2===t.length)if(-1!==t[0].indexOf("ProviderKey")){var o=t[0].substr(0,t[0].length-11).toLowerCase(),n=r.providers.get(o);n&&n.providerKeyNeeded&&(n.providerKey=t[1]),sessionStorage.setItem(o,btoa(t[1]))}else a+="?"===a?"":"&",a+=e,"lng"===t[0].toLowerCase()&&(c=t[1].toLowerCase())}});history.replaceState({index:"bar"},"page",a),r.providers.forEach(function(e){if(e.providerKeyNeeded&&0===e.providerKey){var t=null;g("./util/Utilities")().storageAvailable("sessionStorage")&&(t=sessionStorage.getItem(e.name.toLowerCase())),t?e.providerKey=atob(t):r.providers.delete(e.name.toLowerCase())}})}();var o=[];v=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesConfig.json",o.push(new Promise(n)),v=window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotes"+(c||r.config.language).toUpperCase()+".json",o.push(new Promise(n)),u&&(v=u,o.push(new Promise(n))),Promise.all(o).then(function(e){c&&(e[0].language=c),r.config=e[0],window.osmSearch?window.osmSearch.getDictionaryPromise(r.config.language,"travelNotes").then(function(){console.log("Dictionary loaded")},function(e){console.log(e)}):console.log("osmSearch not found"),r.providers.forEach(function(e){e.userLanguage=r.config.language}),g("./UI/Translator")().setTranslations(e[1]),r.travel=g("./data/Travel")(),r.travel.routes.add(g("./data/Route")()),document.getElementById(t).appendChild(g("./UI/UserInterface")().UI),g("./UI/TravelEditorUI")().setRoutesList(r.travel.routes),g("./core/TravelEditor")().updateRoadBook(!0),u?g("./core/FileLoader")().openDistantFile(e[2]):r.config.travelEditor.startupRouteEdition?g("./core/TravelEditor")().editRoute(r.travel.routes.first.objId):g("./UI/RouteEditorUI")().reduce()}).catch(function(e){console.log(e)})}function a(e){r.travel.readOnly||g("./UI/ContextMenu")(e,g("./UI/ContextMenuFactory")().getMapContextMenu([e.latlng.lat,e.latlng.lng]).concat(i))}function t(e){r.travel.readOnly||g("./UI/ContextMenu")(e,g("./UI/ContextMenuFactory")().getMapContextMenu([e.latlng.lat,e.latlng.lng]).concat(s))}var i=[],s=[],l=!1,d=!1,c=null,u=null,v="";return{addControl:function(e,t){return o(e,t)},addProvider:function(e){r.providers.set(e.name.toLowerCase(),e)},addMapContextMenu:function(e,t){e&&(r.map.on("click",a),l=!0),t&&(r.map.on("contextmenu",a),d=!0)},get baseDialog(){return g("./UI/baseDialog")()},get userData(){return r.travel.userData},set userData(e){r.travel.userData=e},get rightContextMenu(){return d},set rightContextMenu(e){e&&!d?(r.map.on("contextmenu",t),d=!0):!e&&d&&(r.map.off("contextmenu",t),d=!1)},get leftContextMenu(){return l},set leftContextMenu(e){e&&!l?(r.map.on("click",a),l=!0):!e&&l&&(r.map.off("click",a),l=!1)},get leftUserContextMenu(){return i},set leftUserContextMenu(e){i=e},get rightUserContextMenu(){return s},set rightUserContextMenu(e){s=e},get maneuver(){return g("./data/Maneuver")()},get itineraryPoint(){return g("./data/ItineraryPoint")()},get version(){return g("./data/Version")}}}()}()},{"./UI/ContextMenu":12,"./UI/ContextMenuFactory":13,"./UI/RouteEditorUI":22,"./UI/Translator":26,"./UI/TravelEditorUI":27,"./UI/UserInterface":29,"./UI/baseDialog":30,"./core/FileLoader":32,"./core/TravelEditor":40,"./data/ItineraryPoint":47,"./data/Maneuver":48,"./data/Route":52,"./data/Travel":53,"./data/TravelNotesData":54,"./data/Version":55,"./util/Utilities":58}],9:[function(o,e,t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(e){var t=o("../UI/BaseDialog")();return t.title=o("../UI/Translator")().getText("AboutDialog - About Travel & Notes"),o("./HTMLElementsFactory")().create("div",{id:"TravelNotes-AboutDialog-AboutDiv"},t.content).innerHTML="<p>This  program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or any later version.</p><p>Copyright - 2017 2019 - wwwouaiebe</p><p>Contact : <a href='http://www.ouaie.be/blog/pages/contact' target='_blank'>http://www.ouaie.be/</a></p><p>GitHub : <a href='https://github.com/wwwouaiebe/leaflet.TravelNotes' target='_blank'>https://github.com/wwwouaiebe/leaflet.TravelNotes</a></p><p>Version : "+o("../data/Version")+".<p>This program uses: <a href='https://leafletjs.com/' target='_blank'>leaflet</a>, <a href='https://github.com/mapbox/polyline' target='_blank'>mapbox/polyline</a>, <a href='https://github.com/Project-OSRM/osrm-text-instructions' target='_blank'>Project-OSRM/osrm-text-instructions</a> and  <a href='https://github.com/drolbr/Overpass-API' target='_blank'>the Overpass API</a></p>",t.center(),t})}()},{"../UI/BaseDialog":10,"../UI/Translator":26,"../data/Version":55,"./HTMLElementsFactory":16}],10:[function(N,e,t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var t=null,o=null,n=null,e=N("./HTMLElementsFactory")(),a=function(e){if("Escape"===e.key||"Esc"===e.key){if(n&&!n())return;document.removeEventListener("keydown",a,!0),document.getElementsByTagName("body")[0].removeChild(document.getElementById("TravelNotes-BaseDialog-BackgroundDiv"))}},r=document.getElementsByTagName("body")[0],i=e.create("div",{id:"TravelNotes-BaseDialog-BackgroundDiv",className:"TravelNotes-BaseDialog-BackgroundDiv"},r);i.addEventListener("dragover",function(e){},!1),i.addEventListener("drop",function(e){},!1);var s=i.clientWidth,l=i.clientHeight,d=0,c=0,u=0,v=0,g=e.create("div",{id:"TravelNotes-BaseDialog-Container",className:"TravelNotes-BaseDialog-Container"},i),p=e.create("div",{id:"TravelNotes-BaseDialog-TopBar",className:"TravelNotes-BaseDialog-TopBar",draggable:!0},g);e.create("div",{innerHTML:"&#x274c",id:"TravelNotes-BaseDialog-CancelButton",title:N("../UI/Translator")().getText("BaseDialog - Cancel")},p).addEventListener("click",function(){o&&!o()||(document.removeEventListener("keydown",a,!0),document.getElementsByTagName("body")[0].removeChild(i))},!1),p.addEventListener("dragstart",function(e){try{e.dataTransfer.setData("Text","1")}catch(e){}d=e.screenX,c=e.screenY},!1),p.addEventListener("dragend",function(e){u+=e.screenX-d,v+=e.screenY-c,u=Math.min(Math.max(u,20),s-g.clientWidth-20),v=Math.max(v,20);var t=l-Math.max(v,0)-20;g.setAttribute("style","top:"+v+"px;left:"+u+"px;max-height:"+t+"px;")},!1);var m=e.create("div",{className:"TravelNotes-BaseDialog-HeaderDiv",id:"TravelNotes-BaseDialog-HeaderDiv"},g),f=e.create("div",{className:"TravelNotes-BaseDialog-ContentDiv",id:"TravelNotes-BaseDialog-ContentDiv"},g),T=(e.create("div",{className:"TravelNotes-BaseDialog-ErrorDiv TravelNotes-BaseDialog-ErrorDivHidden",id:"TravelNotes-BaseDialog-ErrorDiv"},g),e.create("div",{className:"TravelNotes-BaseDialog-FooterDiv",id:"TravelNotes-BaseDialog-FooterDiv"},g));return e.create("div",{innerHTML:"&#x1f4be;",id:"TravelNotes-BaseDialog-OkButton",className:"TravelNotes-BaseDialog-Button"},T).addEventListener("click",function(){t&&!t()||(document.removeEventListener("keydown",a,!0),document.getElementsByTagName("body")[0].removeChild(i))},!1),document.addEventListener("keydown",a,!0),{addClickOkButtonEventListener:function(e){t=e},addClickCancelButtonEventListener:function(e){o=e},addEscapeKeyEventListener:function(e){n=e},get title(){return m.innerHTML},set title(e){m.innerHTML=e},center:function(){u=(s-g.clientWidth)/2,v=(l-g.clientHeight)/2,u=Math.min(Math.max(u,20),s-g.clientWidth-20),v=Math.max(v,20);var e=l-Math.max(v,0)-20;g.setAttribute("style","top:"+v+"px;left:"+u+"px;max-height:"+e+"px;")},get header(){return m},set header(e){m=e},get content(){return f},set content(e){f=e},get footer(){return T},set footer(e){T=e}}})}()},{"../UI/Translator":26,"./HTMLElementsFactory":16}],11:[function(D,e,t){!function(){"use strict";function b(){return!0}void 0!==e&&e.exports&&(e.exports=function(e){function o(e){return{r:parseInt(e.substr(1,2),16),g:parseInt(e.substr(3,2),16),b:parseInt(e.substr(5,2),16)}}function s(e,t,o){return String.prototype.padStart||(String.prototype.padStart=function(e,t){return e>>=0,t=String(t||" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}),"#"+parseInt(e).toString(16).padStart(2,"0")+parseInt(t).toString(16).padStart(2,"0")+parseInt(o).toString(16).padStart(2,"0")}function t(e){r=e.target.colorValue;var t=o(r);y.value=t.r,h.value=t.g,E.value=t.b,document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+e.target.colorValue+";")}function n(e){for(var t=e.target.redValue,o=255,n=255,a=0;++a<7;){var r=0;for(o=255;++r<7;){var i=document.getElementById("TravelNotes-ColorDialog-CellColorDiv"+a+r);i.colorValue=s(t,o,n),i.setAttribute("style","background-color:"+s(t,o,n)),o-=51}n-=51}}function a(){r=s(y.value,h.value,E.value),document.getElementById("TravelNotes-ColorDialog-ColorSampleDiv").setAttribute("style","background-color:"+r+";")}var r=e,i=D("../UI/Translator")(),l=D("./HTMLElementsFactory")(),d=D("../UI/BaseDialog")();d.title=i.getText("ColorDialog - Colors"),d.addClickOkButtonEventListener(b),d.getNewColor=function(){return r};for(var c=l.create("div",{className:"TravelNotes-ColorDialog-ColorDiv",id:"TravelNotes-ColorDialog-ColorDiv"},d.content),u=l.create("div",{className:"TravelNotes-ColorDialog-ButtonsDiv",id:"TravelNotes-ColorDialog-ButtonsDiv"},c),v=255,g=255,p=255,m=0;++m<8;){var f=l.create("div",{className:"TravelNotes-ColorDialog-RowColorDiv",id:"TravelNotes-ColorDialog-RowColorDiv"+m},u),T=0;for(g=255;++T<7;){m<7&&"TravelNotes-ColorDialog-CellColorDiv TravelNotes-ColorDialog-RedDiv";var N=l.create("div",{className:"TravelNotes-ColorDialog-CellColorDiv",id:"TravelNotes-ColorDialog-CellColorDiv"+m+T},f);if(m<7)N.setAttribute("style","background-color:"+s(v,g,p)),N.colorValue=s(v,g,p),N.addEventListener("click",t,!1),g-=51;else{var I=s(255,v=51*(T-1),v);N.setAttribute("style","background-color:"+I),N.redValue=255-v,N.addEventListener("click",n,!1)}}p-=51}var L=l.create("div",{className:"TravelNotes-ColorDialog-DataDiv",id:"TravelNotes-ColorDialog-DataDiv"},c);l.create("text",{data:i.getText("ColorDialog - Red")},L);var y=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-RedInput"},L);y.value=o(e).r,y.min=0,y.max=255,y.addEventListener("input",a,!1),l.create("text",{data:i.getText("ColorDialog - Green")},L);var h=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-GreenInput"},L);h.value=o(e).g,h.min=0,h.max=255,h.addEventListener("input",a,!1),l.create("text",{data:i.getText("ColorDialog - Blue")},L);var E=l.create("input",{type:"number",className:"TravelNotes-ColorDialog-NumberInput",id:"TravelNotes-ColorDialog-BlueInput"},L);return E.value=o(e).b,E.min=0,E.max=255,E.addEventListener("input",a,!1),l.create("div",{className:"TravelNotes-ColorDialog-ColorSampleDiv",id:"TravelNotes-ColorDialog-ColorSampleDiv"},c).setAttribute("style","background-color:"+e+";"),d.center(),d})}()},{"../UI/BaseDialog":10,"../UI/Translator":26,"./HTMLElementsFactory":16}],12:[function(y,e,t){!function(){"use strict";function c(e){e.stopPropagation(),u[e.target.menuItem].param?u[e.target.menuItem].action.call(u[e.target.menuItem].context,u[e.target.menuItem].param,g):u[e.target.menuItem].action.call(u[e.target.menuItem].context,g),T()}var u=[],v=null,g=null,o=0,p=0,m=0,f=null,T=function(){f&&(clearTimeout(f),f=null),m=p=0,document.removeEventListener("keydown",N,!0),document.removeEventListener("keypress",I,!0),document.removeEventListener("keyup",L,!0);var e=v.childNodes;e[0].firstChild.removeEventListener("click",T,!1);for(var t=1;t<e.length;t++)e[t].firstChild.removeEventListener("click",T,!1);document.getElementsByTagName("body")[0].removeChild(v),v=null,o=0},N=function(e){v&&(e.preventDefault(),e.stopPropagation()),"Escape"!==e.key&&"Esc"!==e.key||T(),"ArrowDown"!==e.key&&"ArrowRight"!==e.key&&"Tab"!==e.key||(o=o>=u.length?1:++o,v.childNodes[o].firstChild.focus()),"ArrowUp"!==e.key&&"ArrowLeft"!==e.key||(o=o<=1?u.length:--o,v.childNodes[o].firstChild.focus()),"Home"===e.key&&(o=1,v.childNodes[o].firstChild.focus()),"End"===e.key&&(o=u.length,v.childNodes[o].firstChild.focus()),"Enter"===e.key&&0<o&&u[o-1].action&&v.childNodes[o].firstChild.click()},I=function(e){e.preventDefault(),e.stopPropagation()},L=function(e){e.preventDefault(),e.stopPropagation()};void 0!==e&&e.exports&&(e.exports=function(e,t){if(e.latlng.lat!==p||e.latlng.lng!==m)if(p=e.latlng.lat,m=e.latlng.lng,g=e,v)T();else{u=t;var o=document.getElementsByTagName("body")[0],n=y("./HTMLElementsFactory")(),a=n.create("div",{className:"TravelNotes-ContextMenu-Panel"},o),r=a.clientWidth,i=a.clientHeight;o.removeChild(a),(v=n.create("div",{id:"TravelNotes-ContextMenu-Container",className:"TravelNotes-ContextMenu-Container"},o)).addEventListener("mouseenter",function(){f&&(clearTimeout(f),f=null)},!1),v.addEventListener("mouseleave",function(){f=setTimeout(T,y("../L.TravelNotes").config.contextMenu.timeout)},!1),n.create("div",{innerHTML:"&#x274c",className:"TravelNotes-ContextMenu-CloseButton",title:y("./Translator")().getText("ContextMenu - Close")},v).addEventListener("click",T,!1);var s=0;u.forEach(function(e){var t=n.create("div",{className:"TravelNotes-ContextMenu-ItemContainer"},v),o=n.create("button",{innerHTML:e.name,id:"TravelNotes-ContextMenu-Item"+s,className:e.action?"TravelNotes-ContextMenu-Item":"TravelNotes-ContextMenu-Item TravelNotes-ContextMenu-ItemDisabled"},t);e.action&&o.addEventListener("click",c,!1),o.menuItem=s,++s});var l=Math.min(e.originalEvent.clientY,i-v.clientHeight-20),d=Math.min(e.originalEvent.clientX,r-v.clientWidth-20);v.setAttribute("style","top:"+l+"px;left:"+d+"px;"),document.addEventListener("keydown",N,!0),document.addEventListener("keypress",I,!0),document.addEventListener("keyup",L,!0)}else m=p=0})}()},{"../L.TravelNotes":8,"./HTMLElementsFactory":16,"./Translator":26}],13:[function(l,e,t){!function(){"use strict";var s=l("../L.TravelNotes");void 0!==e&&e.exports&&(e.exports=function(){var t=l("../core/MapEditor")(),n=l("../core/NoteEditor")(),o=l("../core/RouteEditor")(),a=l("../core/TravelEditor")(),r=l("../core/waypointEditor")(),i=l("../UI/Translator")();return Object.seal({getMapContextMenu:function(e){return function(e){return[{context:r,name:i.getText("ContextMenuFactory - Select this point as start point"),action:-1!==s.editedRouteObjId&&0===s.travel.editedRoute.wayPoints.first.lat?l("../core/waypointEditor")().setStartPoint:null,param:e},{context:r,name:i.getText("ContextMenuFactory - Select this point as way point"),action:-1!==s.editedRouteObjId?l("../core/waypointEditor")().addWayPoint:null,param:e},{context:r,name:i.getText("ContextMenuFactory - Select this point as end point"),action:-1!==s.editedRouteObjId&&0===s.travel.editedRoute.wayPoints.last.lat?l("../core/waypointEditor")().setEndPoint:null,param:e},{context:n,name:i.getText("ContextMenuFactory - New travel note"),action:n.newTravelNote,param:e},{context:n,name:i.getText("ContextMenuFactory - Hide notes"),action:n.hideNotes},{context:n,name:i.getText("ContextMenuFactory - Show notes"),action:n.showNotes},{context:o,name:i.getText("ContextMenuFactory - Show all routes"),action:o.showRoutes},{context:t,name:i.getText("ContextMenuFactory - Zoom to travel"),action:t.zoomToTravel},{context:null,name:i.getText("ContextMenuFactory - About Travel & Notes"),action:l("../UI/AboutDialog")}]}(e)},getWayPointContextMenu:function(e){return function(e){return[{context:r,name:i.getText("ContextMenuFactory - Delete this waypoint"),action:s.travel.editedRoute.wayPoints.first.objId!==e&&s.travel.editedRoute.wayPoints.last.objId!==e?l("../core/waypointEditor")().removeWayPoint:null,param:e}]}(e)},getRouteContextMenu:function(e){return function(e){return[{context:o,name:i.getText("ContextMenuFactory - Edit this route"),action:s.editedRouteObjId!==e&&2!==s.travel.editedRoute.edited?a.editRoute:null,param:e},{context:a,name:i.getText("ContextMenuFactory - Delete this route"),action:s.editedRouteObjId!==e&&2!==s.travel.editedRoute.edited?a.removeRoute:null,param:e},{context:o,name:i.getText("ContextMenuFactory - Hide this route"),action:s.travel.editedRoute.objId!==e?o.hideRoute:null,param:e},{context:r,name:i.getText("ContextMenuFactory - Add a waypoint on the route"),action:-1!==s.editedRouteObjId?r.addWayPointOnRoute:null,param:e},{context:n,name:i.getText("ContextMenuFactory - Add a note on the route"),action:n.newRouteNote,param:e},{context:o,name:i.getText("ContextMenuFactory - Properties"),action:o.routeProperties,param:e},{context:t,name:i.getText("ContextMenuFactory - Zoom to route"),action:t.zoomToRoute,param:e},{context:o,name:i.getText("ContextMenuFactory - Save modifications on this route"),action:s.travel.editedRoute.objId===e?o.saveEdition:null},{context:o,name:i.getText("ContextMenuFactory - Cancel modifications on this route"),action:s.travel.editedRoute.objId===e?o.cancelEdition:null}]}(e)},getNoteContextMenu:function(e){return function(e){var t=[];t.push({context:n,name:i.getText("ContextMenuFactory - Edit this note"),action:n.editNote,param:e}),t.push({context:n,name:i.getText("ContextMenuFactory - Delete this note"),action:n.removeNote,param:e}),t.push({context:n,name:i.getText("ContextMenuFactory - Zoom to note"),action:n.zoomToNote,param:e});var o=l("../data/DataSearchEngine")().getNoteAndRoute(e).route;return t.push({context:n,name:o?i.getText("ContextMenuFactory - Detach note from route"):i.getText("ContextMenuFactory - Attach note to route"),action:0!==s.travel.routes.length&&-1===s.editedRouteObjId?o?n.detachNoteFromRoute:n.attachNoteToRoute:null,param:e}),t}(e)}})})}()},{"../L.TravelNotes":8,"../UI/AboutDialog":9,"../UI/Translator":26,"../core/MapEditor":34,"../core/NoteEditor":35,"../core/RouteEditor":37,"../core/TravelEditor":40,"../core/waypointEditor":42,"../data/DataSearchEngine":45}],14:[function(d,e,t){!function(){"use strict";function a(e){e.deltaY&&(e.target.scrollTop=e.target.scrollTop+10*e.deltaY),e.stopPropagation()}function r(e){t().setItinerary()}function i(e){t().setTravelNotes()}function s(e){t().setSearch()}var l=-1,t=function(){function e(){switch(l){case 0:n.remove();break;case 1:t.remove();break;case 2:window.osmSearch&&o.remove()}}var t=d("../UI/TravelNotesPaneUI")(),o=d("../UI/SearchPaneUI")(),n=d("../UI/ItineraryPaneUI")();return Object.seal({createUI:function(e){!function(e){if(!document.getElementById("TravelNotes-Control-ItineraryDataDiv")){var t=d("../UI/HTMLElementsFactory")(),o=t.create("div",{id:"TravelNotes-Control-ItineraryHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},e);t.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Itinerary"),id:"TravelNotes-Control-ItineraryPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",r,!1),t.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Travel notes"),id:"TravelNotes-Control-TravelNotesPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",i,!1),window.osmSearch&&t.create("div",{innerHTML:d("../UI/Translator")().getText("DataPanesUI - Search"),id:"TravelNotes-Control-SearchPaneButton",className:"TravelNotes-Control-PaneButton"},o).addEventListener("click",s,!1),t.create("div",{id:"TravelNotes-Control-ItineraryDataDiv",className:"TravelNotes-Control-DataDiv"},e).addEventListener("wheel",a,!1)}}(e)},setItinerary:function(){e(),n.add(),l=0},updateItinerary:function(){0===l&&(n.remove(),n.add())},setTravelNotes:function(){e(),t.add(),l=1},updateTravelNotes:function(){1===l&&(t.remove(),t.add())},setSearch:function(){e(),o.add(),l=2},updateSearch:function(){2===l&&(o.remove(),o.add())}})};void 0!==e&&e.exports&&(e.exports=t)}()},{"../UI/HTMLElementsFactory":16,"../UI/ItineraryPaneUI":19,"../UI/SearchPaneUI":24,"../UI/Translator":26,"../UI/TravelNotesPaneUI":28}],15:[function(i,e,t){!function(){"use strict";var t=null;void 0!==e&&e.exports&&(e.exports=function(){function a(){document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.add("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML=""}var r=i("./Translator")();return{createUI:function(e){!function(e){if(!document.getElementById("TravelNotes-Control-ErrorDataDiv")){var t=i("./HTMLElementsFactory")(),o=t.create("div",{id:"TravelNotes-Control-ErrorDataDiv",className:"TravelNotes-Control-DataDiv TravelNotes-Control-HiddenList"},e),n=t.create("div",{id:"TravelNotes-Control-ErrorHeaderDiv",className:"TravelNotes-Control-HeaderDiv TravelNotes-Control-HiddenList"},o);t.create("span",{innerHTML:"&#x274c",title:r.getText("ErrorEditorUI - Hide"),id:"TravelNotes-Control-ErrorExpandButton",className:"TravelNotes-Control-HiddenList"},n).addEventListener("click",function(e){e.stopPropagation(),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML.length&&a()},!1);t.create("div",{id:"TravelNotes-Control-ErrorMessageDiv"},o)}}(e)},set message(e){!function(e){t&&(clearTimeout(t),t=null),document.getElementById("TravelNotes-Control-ErrorMessageDiv").innerHTML=e,document.getElementById("TravelNotes-Control-ErrorDataDiv").classList.remove("TravelNotes-Control-HiddenList"),t=setTimeout(a,i("../L.TravelNotes").config.errorMessages.timeout)}(e)},get message(){return document.getElementById("TravelNotes-Control-ErrorDataDiv").innerHTML}}})}()},{"../L.TravelNotes":8,"./HTMLElementsFactory":16,"./Translator":26}],16:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){return{create:function(e,t,o){var n;if(n="text"===e.toLowerCase()?document.createTextNode(""):document.createElement(e),o&&o.appendChild(n),t)for(var a in t)try{n[a]=t[a]}catch(e){console.log("Invalid property : "+a)}return n}}})}()},{}],17:[function(T,e,t){!function(){"use strict";var d=T("../L.TravelNotes"),g=T("../UI/HTMLElementsFactory")(),p=T("../UI/Translator")(),m=T("../util/Utilities")(),c=T("../core/NoteEditor")(),t=T("../core/RouteEditor")(),u=T("../L.TravelNotes").config.note.svgIconWidth,f="TravelNotes-Control-";void 0!==e&&e.exports&&(e.exports=function(){function v(e,t){var o=g.create("div",{className:f+"Travel-Notes-IconCell",innerHTML:e.iconContent},t);"svg"===o.firstChild.tagName&&"TravelNotes-Roadbook-"===f&&o.firstChild.setAttributeNS(null,"viewBox","0 0 "+u+" "+u),g.create("div",{className:f+"Travel-Notes-Cell",innerHTML:c.getNoteHTML(e,f)},t),t.noteObjId=e.objId}function n(){var e=g.create("div",{className:f+"Travel-Header"});g.create("div",{className:f+"Travel-Header-Name",innerHTML:d.travel.name},e);for(var t=0,o=d.travel.routes.iterator;!o.done;)g.create("div",{className:f+"Travel-Header-RouteName",innerHTML:'<a href="#route'+o.value.objId+'">'+o.value.name+"</a>&nbsp;:&nbsp;"+m.formatDistance(o.value.distance)+"."},e),o.value.chain&&(t+=o.value.distance);return g.create("div",{className:f+"Travel-Header-TravelDistance",innerHTML:p.getText("HTMLViewsFactory - Travel distance&nbsp;:&nbsp;{distance}",{distance:m.formatDistance(t)})},e),e}function a(){for(var e=g.create("div",{className:f+"Travel-Notes"}),t=d.travel.notes.iterator;!t.done;){var o=g.create("div",{className:f+"Travel-Notes-Row"},e);v(t.value,o)}return e}function r(e){return g.create("div",{className:f+"Route-Header",id:"route"+e.objId,innerHTML:t.getRouteHTML(e,f)})}function i(e){for(var t=g.create("div",{className:f+"Route-ManeuversAndNotes"}),o=e.notes.iterator,n=o.done,a=n?Number.MAX_VALUE:o.value.distance,r=a,i=e.itinerary.maneuvers.iterator,s=i.done,l=0;!s||!n;){var d=g.create("div",{className:f+"Route-ManeuversAndNotes-Row"},t);if(l<=a){if(!s){d.className=f+"Route-Maneuvers-Row",g.create("div",{className:f+"Route-ManeuversAndNotes-IconCell TravelNotes-ManeuverNote-"+i.value.iconName},d);var c="<div>"+i.value.instruction+"</div>";0<i.value.distance&&(c+="<div>"+p.getText("HTMLViewsFactory - To next instruction&nbsp;:&nbsp;{distance}&nbsp;-&nbsp;{duration}",{distance:m.formatDistance(i.value.distance),duration:m.formatTime(i.value.duration)})+"</div>"),g.create("div",{className:f+"Route-ManeuversAndNotes-Cell",innerHTML:c},d),d.objId=T("../data/ObjId")(),d.latLng=e.itinerary.itineraryPoints.getAt(i.value.itineraryPointObjId).latLng,d.maneuverObjId=i.value.objId,l+=i.value.distance,(s=i.done)&&(l=Number.MAX_VALUE)}}else if(!n&&(d.className=f+"Route-Notes-Row",v(o.value,d),d.objId=T("../data/ObjId")(),d.latLng=o.value.latLng,d.noteObjId=o.value.objId,r=o.value.distance,a=(n=o.done)?Number.MAX_VALUE:o.value.distance,!n)){var u=o.value.distance-r;9<u&&g.create("div",{className:f+"NoteHtml-NextDistance",innerHTML:p.getText("HTMLViewsFactory - Next distance&nbsp;:&nbsp;{distance}",{distance:m.formatDistance(u)})},d.lastChild)}}return t}function s(e){var t="";return""!==e.itinerary.provider&&""!==e.itinerary.transitMode&&(t=p.getText("HTMLViewsFactory - Itinerary computed by {provider} and optimized for {transitMode}",{provider:e.itinerary.provider,transitMode:p.getText("HTMLViewsFactory - TransitMode "+e.itinerary.transitMode)})),g.create("div",{className:f+"RouteFooter",innerHTML:t})}function l(){return g.create("div",{className:f+"TravelFooter",innerHTML:p.getText("HTMLViewsFactory - Travel footer")})}return{set classNamePrefix(e){f=e},get classNamePrefix(){return f},get travelHeaderHTML(){return n()},get travelNotesHTML(){return a()},get routeHeaderHTML(){return r(d.travel.editedRoute)},get routeManeuversAndNotesHTML(){return i(d.travel.editedRoute)},get routeFooterHTML(){return s(d.travel.editedRoute)},get travelFooterHTML(){return l()},get travelHTML(){return function(){var e=g.create("div",{className:f+"Travel"});e.appendChild(n()),e.appendChild(a());for(var t=d.travel.routes.iterator;!t.done;){var o=d.config.routeEditor.displayEditionInHTMLPage&&t.value.objId===d.editedRouteObjId;e.appendChild(r(o?d.travel.editedRoute:t.value)),e.appendChild(i(o?d.travel.editedRoute:t.value)),e.appendChild(s(o?d.travel.editedRoute:t.value))}return e.appendChild(l()),e}()}}})}()},{"../L.TravelNotes":8,"../UI/HTMLElementsFactory":16,"../UI/Translator":26,"../core/NoteEditor":35,"../core/RouteEditor":37,"../data/ObjId":50,"../util/Utilities":58}],18:[function(e,t,o){arguments[4][16][0].apply(o,arguments)},{dup:16}],19:[function(c,e,t){!function(){"use strict";function i(e){e.stopPropagation();for(var t=e.target;!t.latLng;)t=t.parentNode;c("../core/MapEditor")().zoomToPoint(t.latLng)}function s(e){e.stopPropagation(),e.preventDefault();for(var t=e.target;!t.latLng;)t=t.parentNode;t.maneuverObjId?c("../core/NoteEditor")().newManeuverNote(t.maneuverObjId,t.latLng):t.noteObjId&&c("../core/NoteEditor")().editNote(t.noteObjId)}function l(e){e.stopPropagation(),c("../core/MapEditor")().addItineraryPointMarker(e.target.objId,e.target.latLng)}function d(e){e.stopPropagation(),c("../core/MapEditor")().removeObject(e.target.objId)}void 0!==e&&e.exports&&(e.exports=function(){return Object.seal({remove:function(){!function(){var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){var t,o,n,a=document.getElementsByClassName("TravelNotes-Control-Route-Header")[0];a&&e.removeChild(a);var r=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0];if(r){for(o=r.childNodes,t=0;t<o.length;t++)(n=o[t]).removeEventListener("click",i,!1),n.removeEventListener("contextmenu",s,!1),n.removeEventListener("mouseenter",l,!1),n.removeEventListener("mouseleave",d,!1);e.removeChild(r)}}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.add("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),window.osmSearch&&document.getElementById("TravelNotes-Control-SearchPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton");var e=c("../UI/HTMLViewsFactory")();e.classNamePrefix="TravelNotes-Control-";var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var o,n,a;t.appendChild(e.routeHeaderHTML),t.appendChild(e.routeManeuversAndNotesHTML);var r=document.getElementsByClassName("TravelNotes-Control-Route-ManeuversAndNotes")[0];if(r)for(n=r.childNodes,o=0;o<n.length;o++)(a=n[o]).addEventListener("click",i,!1),a.addEventListener("contextmenu",s,!1),a.addEventListener("mouseenter",l,!1),a.addEventListener("mouseleave",d,!1)}}()}})})}()},{"../UI/HTMLViewsFactory":17,"../core/MapEditor":34,"../core/NoteEditor":35}],20:[function(D,e,t){!function(){"use strict";var y=D("../UI/Translator")(),h={editionButtons:[],preDefinedIconsList:[]},E={editionButtons:[],preDefinedIconsList:[]},b={editionButtons:[],preDefinedIconsList:[]};void 0!==e&&e.exports&&(e.exports=function(o,n,t){function e(){return 0===document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value.length?(document.getElementById("TravelNotes-BaseDialog-ErrorDiv").innerHTML=y.getText("Notedialog - The icon content cannot be empty"),document.getElementById("TravelNotes-BaseDialog-ErrorDiv").classList.remove("TravelNotes-BaseDialog-ErrorDivHidden"),!1):(o.iconWidth=document.getElementById("TravelNotes-NoteDialog-WidthNumberInput").value,o.iconHeight=document.getElementById("TravelNotes-NoteDialog-HeightNumberInput").value,o.iconContent=document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value,o.popupContent=document.getElementById("TravelNotes-NoteDialog-TextArea-PopupContent").value,o.tooltipContent=document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value,o.address=document.getElementById("TravelNotes-NoteDialog-InputText-Adress").value,o.url=document.getElementById("TravelNotes-NoteDialog-InputText-Link").value,o.phone=document.getElementById("TravelNotes-NoteDialog-InputText-Phone").value,o.latLng=f,D("../core/NoteEditor")().afterNoteDialog(o,n),!0)}function a(e){N=T="",e.address.house_number&&(T+=e.address.house_number+" "),e.address.road?T+=e.address.road+" ":e.address.pedestrian&&(T+=e.address.pedestrian+" "),e.address.village?N=e.address.village:e.address.town?N=e.address.town:e.address.city&&(N=e.address.city),""!==N&&(T+=D("../L.TravelNotes").config.note.cityPrefix+N+D("../L.TravelNotes").config.note.cityPostfix),0===T.length&&(T+=e.address.country),D("../L.TravelNotes").config.note.reverseGeocoding&&""===o.address&&t&&(document.getElementById("TravelNotes-NoteDialog-InputText-Adress").value=T)}function r(e){document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value=e.svg.outerHTML;var t="";if(null!==e.direction){var o=D("../L.TravelNotes").config.note.svgAnleMaxDirection;t=e.direction<o.right?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=y.getText("NoteDialog - Turn right"),String.fromCodePoint(129154)):e.direction<o.slightRight?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=y.getText("NoteDialog - Turn slight right"),String.fromCodePoint(129157)):e.direction<o.continue?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=y.getText("NoteDialog - Continue"),String.fromCodePoint(129153)):e.direction<o.slightLeft?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=y.getText("NoteDialog - Turn slight left"),String.fromCodePoint(129156)):e.direction<o.left?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=y.getText("NoteDialog - Turn left"),String.fromCodePoint(129152)):e.direction<o.sharpLeft?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=y.getText("NoteDialog - Turn sharp left"),String.fromCodePoint(129159)):e.direction<o.sharpRight?(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=y.getText("NoteDialog - Turn sharp right"),String.fromCodePoint(129158)):(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=y.getText("NoteDialog - Turn right"),String.fromCodePoint(129154))}-1===e.startStop?document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=y.getText("NoteDialog - Start"):1===e.startStop&&(document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=y.getText("NoteDialog - Stop"));for(var n="",a=0,r=0;r<e.streets.length;r++)switch(0!==r&&e.streets.length-1!==r||""!==e.streets[r]?(n+=e.streets[r],a--):(n+="???",a++),r){case e.streets.length-2:n+=t;break;case e.streets.length-1:break;default:n+=String.fromCodePoint(10917)}e.city||""===N||(e.city=N),e.city&&(n+=" "+D("../L.TravelNotes").config.note.cityPrefix+e.city+D("../L.TravelNotes").config.note.cityPostfix),e.place&&e.place!==e.city&&2!==a&&(n+=" ("+e.place+")"),document.getElementById("TravelNotes-NoteDialog-InputText-Adress").value=n,document.getElementById("TravelNotes-BaseDialog-OkButton").style.visibility="visible",f=e.latLng}function i(){document.getElementById("TravelNotes-BaseDialog-ErrorDiv").innerHTML=y.getText("Notedialog - an error occurs when creating the SVG icon"),document.getElementById("TravelNotes-BaseDialog-ErrorDiv").classList.remove("TravelNotes-BaseDialog-ErrorDivHidden"),document.getElementById("TravelNotes-BaseDialog-OkButton").style.visibility="visible"}function s(e){var t=b.preDefinedIconsList[e.target.selectedIndex];t.name===y.getText("NoteDialog - SVG icon from OSM")?(document.getElementById("TravelNotes-BaseDialog-OkButton").style.visibility="hidden",D("../core/SvgIconFromOsmFactory")().getPromiseSvgIcon(o.latLng,n).then(r,i)):(document.getElementById("TravelNotes-NoteDialog-WidthNumberInput").value=t.width,document.getElementById("TravelNotes-NoteDialog-HeightNumberInput").value=t.height,document.getElementById("TravelNotes-NoteDialog-TextArea-IconHtmlContent").value=t.icon,document.getElementById("TravelNotes-NoteDialog-InputText-Tooltip").value=t.tooltip)}function l(e){if(p){for(var t=e.target;!t.htmlBefore;)t=t.parentNode;var o=t.htmlAfter&&0<t.htmlAfter.length,n=p.selectionStart,a=p.selectionEnd,r=p.value;p.value=r.substring(0,n)+(o?t.htmlBefore+r.substring(n,a)+t.htmlAfter:t.htmlBefore)+r.substring(a),p.setSelectionRange(o||n===a?n+t.htmlBefore.length:n,(o?a:n)+t.htmlBefore.length),p.focus()}}function d(e){var o=new FileReader;o.onload=function(e){try{var t=JSON.parse(o.result);h.editionButtons=h.editionButtons.concat(t.editionButtons),h.preDefinedIconsList=h.preDefinedIconsList.concat(t.preDefinedIconsList),L(t.editionButtons),I()}catch(e){}},e.target.files[0].name,o.readAsText(e.target.files[0])}function c(e){p=e.target}var u,v=null,g=null,p=null,m=D("./HTMLElementsFactory")(),f=o.latLng,T="",N="",I=function(){b.preDefinedIconsList=E.preDefinedIconsList.concat(h.preDefinedIconsList),-1<n&&b.preDefinedIconsList.push({name:y.getText("NoteDialog - SVG icon from OSM"),icon:"",tooltip:"",width:40,height:40}),b.preDefinedIconsList.sort(function(e,t){return e.name.localeCompare(t.name)});var e=0,t=document.getElementById("TravelNotes-NoteDialog-IconSelect");for(e=t.length-1;0<=e;e--)t.remove(e);for(e=0;e<b.preDefinedIconsList.length;e++){var o=m.create("option",{text:b.preDefinedIconsList[e].name});t.add(o)}},L=function(e){e.forEach(function(e){m.create("button",{type:"button",innerHTML:e.title||"?",htmlBefore:e.htmlBefore||"",htmlAfter:e.htmlAfter||"",className:"TravelNotes-NoteDialog-EditorButton"},document.getElementById("TravelNotes-NoteDialog-ToolbarDiv")).addEventListener("click",l,!1)})};(v=D("../UI/BaseDialog")()).title=y.getText("NoteDialog - Note"),v.addClickOkButtonEventListener(e),g=m.create("div",{id:"TravelNotes-NoteDialog-MainDataDiv"},v.content),function(){var e=m.create("div",{className:"TravelNotes-NoteDialog-ToolbarDiv",id:"TravelNotes-NoteDialog-ToolbarDiv"},g);m.create("select",{className:"TravelNotes-NoteDialog-Select",id:"TravelNotes-NoteDialog-IconSelect"},e).addEventListener("change",s,!1);var t=m.create("div",{id:"TravelNotes-NoteDialog-OpenEditorFileDiv"},e),o=m.create("input",{id:"TravelNotes-NoteDialog-OpenEditorFileInput",type:"file",accept:".json"},t);o.addEventListener("change",d,!1);var n=m.create("div",{id:"TravelNotes-NoteDialog-OpenStyleFakeDiv"},t);m.create("button",{id:"TravelNotes-NoteDialog-OpenEditorFileButton",className:"TravelNotes-NoteDialog-EditorButton",title:y.getText("NoteDialog - Open a configuration file"),innerHTML:"&#x23CD;"},n).addEventListener("click",function(){o.click()},!1),L(E.editionButtons),L(h.editionButtons),I()}(),u=m.create("div",{className:"TravelNotes-NoteDialog-DataDiv",id:"TravelNotes-NoteDialog-DimensionsDataDiv"},g),m.create("text",{data:y.getText("NoteDialog - Icon width")},u),m.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-WidthNumberInput"},u).value=o.iconWidth,m.create("text",{data:y.getText("NoteDialog - Icon height")},u),m.create("input",{type:"number",className:"TravelNotes-NoteDialog-NumberInput",id:"TravelNotes-NoteDialog-HeightNumberInput"},u).value=o.iconHeight,function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",id:"TravelNotes-NoteDialog-IconContentTitleDiv",innerHTML:y.getText("NoteDialog - Icon content")},g);var e=m.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-IconHtmlContent"},g);e.addEventListener("focus",c,!1),e.value=o.iconContent}(),function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:y.getText("NoteDialog - Text")},g);var e=m.create("textarea",{className:"TravelNotes-NoteDialog-TextArea",id:"TravelNotes-NoteDialog-TextArea-PopupContent"},g);e.addEventListener("focus",c,!1),e.value=o.popupContent}(),function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:y.getText("NoteDialog - Tooltip content")},g);var e=m.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Tooltip"},g);e.addEventListener("focus",c,!1),e.value=o.tooltipContent}(),function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:"<span id='TravelNotes-NoteDialog-Reset-Address-Button'>&#x1f504;</span>&nbsp;"+y.getText("NoteDialog - Address&nbsp;:")},g),document.getElementById("TravelNotes-NoteDialog-Reset-Address-Button").addEventListener("click",function(){e.value=T},!1);var e=m.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Adress"},g);e.addEventListener("focus",c,!1),e.value=o.address,D("../core/GeoCoder")().getPromiseAddress(o.lat,o.lng).then(a)}(),function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:y.getText("NoteDialog - Link")},g);var e=m.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Link"},g);e.addEventListener("focus",function(e){p=null},!1),e.value=o.url}(),function(){m.create("div",{className:"TravelNotes-NoteDialog-TitleDiv",innerHTML:y.getText("NoteDialog - Phone")},g);var e=m.create("input",{type:"text",className:"TravelNotes-NoteDialog-InputText",id:"TravelNotes-NoteDialog-InputText-Phone"},g);e.addEventListener("focus",c,!1),e.value=o.phone}(),function(){if(0===E.preDefinedIconsList.length){var t=new XMLHttpRequest;t.onreadystatechange=function(e){if(this.readyState===t.DONE)if(200===this.status)try{E=JSON.parse(this.responseText),L(E.editionButtons),E.preDefinedIconsList.push({name:"",icon:"",tooltip:"",width:40,height:40}),I()}catch(e){console.log("Error reading TravelNotesNoteDialog.json")}else console.log("Error sending request for TravelNotesNoteDialog"+D("../L.TravelNotes").config.language.toUpperCase()+".json")},t.open("GET",window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotesNoteDialog"+D("../L.TravelNotes").config.language.toUpperCase()+".json",!0),t.send(null)}}(),v.center()})}()},{"../L.TravelNotes":8,"../UI/BaseDialog":10,"../UI/Translator":26,"../core/GeoCoder":33,"../core/NoteEditor":35,"../core/SvgIconFromOsmFactory":39,"./HTMLElementsFactory":16}],21:[function(m,e,t){!function(){"use strict";var p=m("../L.TravelNotes");void 0!==e&&e.exports&&(e.exports=function(){function t(e){p.routing.provider=e,document.getElementsByClassName("TravelNotes-Control-ActiveProviderImgButton")[0].classList.remove("TravelNotes-Control-ActiveProviderImgButton"),document.getElementById("TravelNotes-Control-"+e+"ImgButton").classList.add("TravelNotes-Control-ActiveProviderImgButton");var t=p.providers.get(e.toLowerCase());t.transitModes.car?document.getElementById("TravelNotes-Control-carImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-carImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.bike?document.getElementById("TravelNotes-Control-bikeImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-bikeImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.pedestrian?document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-pedestrianImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),t.transitModes.train?document.getElementById("TravelNotes-Control-trainImgButton").classList.remove("TravelNotes-Control-InactiveTransitModeImgButton"):document.getElementById("TravelNotes-Control-trainImgButton").classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),p.providers.get(e.toLowerCase()).transitModes[p.routing.transitMode]||(t.transitModes.bike?g("bike"):t.transitModes.pedestrian?g("pedestrian"):t.transitModes.car?g("car"):t.transitModes.train&&g("train"))}function o(e){e.stopPropagation(),t(e.target.provider),m("../core/RouteEditor")().startRouting()}function n(e){e.stopPropagation(),g(e.target.transitMode),m("../core/RouteEditor")().startRouting()}function a(e){var t=s.create("img",{src:"data:image/png;base64,"+e.icon,id:"TravelNotes-Control-"+e.name+"ImgButton",className:"TravelNotes-Control-ImgButton",title:e.name},i);t.provider=e.name,t.addEventListener("click",o,!1),l||(t.classList.add("TravelNotes-Control-ActiveProviderImgButton"),p.routing.provider=t.provider,l=!0,e.transitModes.bike?(d.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),p.routing.transitMode="bike"):e.transitModes.pedestrian?(c.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),p.routing.transitMode="pedestrian"):e.transitModes.car?(u.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),p.routing.transitMode="car"):e.transitModes.train&&(v.classList.add("TravelNotes-Control-ActiveTransitModeImgButton"),p.routing.transitMode="train"),e.transitModes.car||u.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.pedestrian||c.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.bike||d.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"),e.transitModes.train||v.classList.add("TravelNotes-Control-InactiveTransitModeImgButton"))}function r(e){i=s.create("div",{id:"TravelNotes-Control-ItineraryButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},e),(d=s.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESkaC0SxrgAABMdJREFUSMfNl1loVGcYhp//n+WcZmbiJE4WjVKVaLWOGxglilFTSmYUF1ILKiIILSjplQiKS65EXG4UvBGrQvVCUAdjoRrEGmtwjQbtWKlpEsTGGDMxkzKTzHr+XiRucbK4ts/lOd/5X853vuU9gj4YN+48Dx58DUBOzrmhnZ0qXykWJBKqKJlkYjyusgAsFtFqMnHPbBa/CcEvaWnir5YWT1vvM3ojUl2cPv1XamqK8fv/MBcWPtwfDhuLlWKYUvSLECAEzTabPHP16uc/uN1fJp6fNShhpRROZ+WSzk7jVDyuTLwDFotIpqXJb4LBkgohRP/Cbvc5/H6krhsnolFVOtAbDoQQoGnCF4nIb91uDL/f8+KefDXQ70e6XOpIJPL+ot2Zg0hElbpc6ojf/7qWBPB6q1FKoevqRCBgrOYDEwgYq3VdnVBK4fVWd2cjL6+SpqYSnM5zi4PBZAUfEafTtCQY9JzJy6tENjWVsH79ZWs4bJziIxMOG6fWr79sbWoq6S4uTTt7MBo1vuMToGnyx2jU+71ITz/rCoWM3w2D3AFKBUj0NIL5nYWl5IndLidJw2CsUgOJwtSp6SQSC7h5czZO50vhIUPMTJrkYMIEO8OHa4Op9FzDYKyUEs9gWqelJUpbm8GcOdcJBmOAARjEYgZFRUOoqZnNyJGDEkZKPOZIRM0bTIricUU8blBePhaQKAXJZBzDUMyYkcnly21cvx7sPRpSEomoeWZgQv9hSUAxYoSD8+efsmdPIxkZVgBMJrDZTKxdO4YLF56Sm/sZT5509jzX76SdYI7FurdMKoqKMti8eQyZmVakFOTkaGzaFGP79gZCoSSaJpk82UFl5VN2727k+PEpxGIGHR0Jdu5s4Natf1KeG4uprD7Lc86cDPbuHc/y5Xd4/DhKa+tXNDZ2cfJkC9euFXLw4EMMA6ZNG8KOHfUcPjyZKVPSWbnyNg0NEXy+aaxadYcbN1KLS6tVtKZK75YtY1ix4i51dZ0sWpTF3bshurqSZGdruN3VLFyYS3HxUEKhJAsXZpGbq1Faeovt28dz716IpUtvs21bfs+neh2rVbSagftAVu+edTotdHUl0XVJdraV+fOvcejQJPLzbSj1lHXr/GiapL09gc83lWg0ycyZDk6ffozNZiIUSpKdbe3p/ze4LzVNVKVIBJcuteHxuOjqSrJvXyNpaSaKi134fM2AoL6+C6/Xxf79X7Bx45/Y7RZ27XpIeXkdoVCcuXMzuXIldZVrmqgSdvvZwnDYuNK7l9PTzVRVzUAIQV1dmLlzh7Jhw32OHm16ZY0r8vPTSCQUXm8WW7fmc/p0C263g5wcK7NmXePZs/gbO9pmk7MGGJkJvN5cRo9O4+efW3j0KNKXaQEMJk50sGzZMOrrwxw79nfKlno+MgexJFR/Lumt458vCQlQVmYvs1hEgj79oHiLNdB3vMUiEmVl9rL/3gh4vdW0t5ec0XXp+1iiui597e0lZ7zeal4YgZecky6XOvKhfZfLJX8KBMQa8BgpXabbjREIiDW6LnxCvL+gEKDrwhcIiDVuN8b/wtCnXJ4FBRfp6PBU1NaO0h0OeUBKmgeTASFASpodDnmgtnaU3tHhqSgouDj4f6dP8dP2L6C7Ld6Z4dDBAAAAAElFTkSuQmCC",id:"TravelNotes-Control-bikeImgButton",className:"TravelNotes-Control-ImgButton"},i)).transitMode="bike",d.addEventListener("click",n,!1),(c=s.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESo7bADyMwAABNlJREFUSMe1V19oU1cY/52Te5Ob3DR/SfzTNNCufxRXxmarONCnPbi+ykYrFdRSkeJLX5ykZcKcFfG5oIJ2Y2sVFZQ+iPoiUhC128OIiJrUlgQTm9o0t23SJufmnj2k2ura5syx7ynknu/7nd93vr8E6wghBJxzAEAgAEsmc3pToWD1y3L6M8NQfABA6eIUY54xs3kh5Xb3JONx5D/WXdX2Wh9crkPIZAbAOVBRcbpvYaHuO87lDZyTCs7lFaochDAQwucANmmzRa7PzfWECFm2IQTsdrdiZuYqHI5quVg80J7P113WdR+AIsTEBEmagsUSOayq539PpVLM5WpFJnO1POOtW+GMRH4dKRa9jZxTABz/TggIMSDLU+Fg8NDuaBTaxyfoux8ORxsAwG7vrI5Ehl7pur+Rc/IJoCX3c05QKGxsnJgYemW3d1avxPgH42AQzkRi6JWuOz3ljReX7k3KnpQkLb158/6aWGyZOS0F0kF4vX45mRwY0XV3WdCGBhsePvwa3d1BAEZZYF13e5LJgRGv1y87nQdLjCmlMAwDqvrj4Wx2x6XyDAw8eLADe/b4AQCqehu5nJj7bbYnHbncT5cppaCGYYBzIJ+vu7TiydcNnP7+GBKJRQwPJ5HL6YLvTlEo1F3iHDAMo4Rkt5/qK6UMFwK+du0NurvDePt2EQ0NdkE9Dl33wW4/1QcApKoKltevrz01DLVWNGKbmhwYHd1dCrEiR0vLY9y7Ny0UaJRmo5WV339OZ2b6NgGyXzRRVFXC4OCXKwwBd+/uRH//VkHmsn9mpm8TZUzxcU4comzb2zciEFCg6yWQZ8/mcOJEGF1dNaivV8tb4MTBmOKjkpSuLdXe8lJZacb5819g374/QEiphJpMBGfPvlxiTwSAZUjSdC0tdZnyCiYTwfBwMx49SuPOnSkA7P3/7/QZM4SC0zCsPkn0bX0+GU+eTCMUGgNAcO7cGEwmCbOzFITI2Lv3ESYmFsWruar2tmWzu4bEjhtLxY4jn/8G2ayByck8mpsfY36+CPEAfbif6ronSggTLgKAgQsXtmF+nuLIkTC2bHGhpcUj3EwIYdB1b5TK8uIUIXxW9LbBoBXt7VW4ciWOGzeSuHnzNQYHvxJ3MeGzZvPiFHW7Q0mApcTUiujtrYHVChw79hyAjOPHX6JYJLh4cZtQwyCEpVyuUJLG48hbrS+uA6aySvX1Kjo7q9HV9fS9a6PRHG7dSqCtLYBAwFp2OlGUF9fjceRJKbcAWf6N67p3zbciBBgZ2Ym6OjsaGh4gk1luDmYzQT7/LUKhZzhzZnyN0kkgSdNg7AAhBKCUUhACWCyRjvVc1dxcgV273Dh58jkymQ+DsVAwcPToX1AUsm5GmM2RjiXQ0tVcroMAbsvZ7Nk/GdvYuNoF/H4ZGzZYEA7PrcpIUSgoBXI5Y9VskOU3Yafzh+2MtTBN++W/jD7iIklauqpqf834+Eejz7tBLBaDpij3myRJS4sNBeXzXpK0tKLcbxofh+Z0tq0/3tbWwhmLDYww5vv/x9vlDaIV0Sg0jye03WYbPSxJ0xBJtQ8H+mlus412eDwntkej0Fyu1k9dYX7uW1ioX3OFoZQB4HOEsEmr9RNXmLWWtspKWDRt9aVN1z1jsryQcjh6komE2NL2N0SHF0QJfjNNAAAAAElFTkSuQmCC",id:"TravelNotes-Control-pedestrianImgButton",className:"TravelNotes-Control-ImgButton"},i)).transitMode="pedestrian",c.addEventListener("click",n,!1),(u=s.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AoaESgBmDpJAwAABQBJREFUSMe9V09MFFcY/703szOz7PLP2WVBV6rtdm21HqhG2wiCh8bL2jWhsl71IhqJJ4oHL4RIxKP1HzESLh4MEGPkoAeNYRWtGkPShGRF+aeFld2psd0BZnZmXg+LW4SdrW3EX/Iub775fe/7977vEdigrCyMmZnrAABZbvGoavkGSh0hy3LtNAzuS57nZAAwTVPhOHOEUnXAstL9Ltd0TFFOJ5dyLAXJtSnLMhRFwaNHoDt3nj2v66vDjHHljDkAsIXf2CKKzB4haRBixgVh6vrAwNEj27bB8ng8SCaTH6aYMcDtPh3StM/6DKNIACz8N1Dw/J+6KI7Xp1It/YTkkliEwsJmnD8PIopdvbOzX90wDPf/UAoAFgzDLczOfn1Dkrp6T5wAKSpqtre4tRXk5MkLV3W9ch8+IgRhsqel5XCkrS0bn4xiWZaRTCqQpK5eTfPVYwUgiq/75ucP/uT1ZmJOvd4wFEWBy9UR0nXPiigFAF331LtcHaFkMomysnDG4mgUdNeuq3OZmK4ceD6lP34ccVZVwSIZN5y9qGlfHLJPJAa/X4LbzeUlnp21MDk5Z1csAChE8XmnpjU1Eln+2fPmzXe/WZZYbkcoyxympn6AaaahKCrIkvpgjKGkpACSJCAQuI2JibR9oVEtXlz862ZeVSs2MMaV57NkzRoHBIFi06aHGB5+m/XC4sIIBAoxMrILfr+YVzFjXPncXPkGSikfytxIeapyIQKHDlUAAIJBN3p7t+Lata0IBt0AGBobVy/IsrxcjDlACL+Htyx3zT+nz3GnEqCyUkJ39wSOHYvh7t1vUVvrz37fu3cNotHfUVs7BElywO+XAKj5VIMxdw01TS5onwwWHjzYjp6ebaiokFBdXYJUSl8mNT9voq6uBH6/hO7uLXjy5HtQamsKTJMLUo7j5NwWMxw44Mf27TIKCnjs3u1DNFqDVGq5bDJp4M6dHQiHV6OggMeWLaU4enQt7Hg5jltF88WjqIjPNo13aGj4fJnc/v3r32swAFBcnD9vqGmaSm5XE5w58xINDYMgBKiru4ebN+NIpxlGR1WMjWXW6KgKTbMwOKigunoAhACHDz/CqVNjsOM1TVPhBOHHsGG4KnOfK41z577BunWFcDgscByDzyfh9u04Xr5UMTmZWT6fhFevVAQCBaiqKkVpKYfLl6fzNI3UEE9pKgr4duSOB0EqZQAAVNXAyIiKp0/fgudJ1qWEAJcujYEQAll2LMiaiwaG5ZyEpKK8ZRn9hKSPM8bnul3R1TWJUGgtLlyYwtDQX3njtn69E01NQVy58gqMEZvyTIMxo586ndMxQsy4Hdn4eBr37ycwPj6/YIH9mprScO9eAs+eaXnuBTPudE7HFprELxc1LZCnSVhLh5W804e9LIUgPO/U9aZGAgDDw6CbN1+dM82VbYscl9JjsYgzEIBFy8rC2LgRlihO1BNirphSQkyI4nh9IAArOwh4vV7MzCQ+7egDAIlEAoQAra0H9wnCRM/HVioIEz2trQf3EYLsjP1eFrS3N7Pjx49ERPF138dwe8a9r/va2o5E2tub2QcO9B0hTVv3aQb6d/B4ZKhqS/+tWxGnJL3opFSLE2IsOifJcXYCQgxQqsUl6UXn4GDEqaot/V6v58PfTpmECyORWPpo4/dYlrvGMLggz3OrFh5tf1BqPuO4VNSyjBsuVzymKB3/+mj7G1dPIltjqpC6AAAAAElFTkSuQmCC",id:"TravelNotes-Control-carImgButton",className:"TravelNotes-Control-ImgButton"},i)).transitMode="car",u.addEventListener("click",n,!1),(v=s.create("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4goTCiEjvCsRvgAABXRJREFUSMe9V11MFFcU/u7MsDPLrgvu7A80BEhLsRIxEFIlcSXBF41BN2ExqC8kPHQraV80iA+GhKAYaLUihkLaaErig1FCiCZq2kQDjS0YfcGYQKtBg7DL7hbFHdaZnTu3D0tR7C7aRvxeJrn3zP3O3z3nXIIUcLm8mJ0dBADIcpNDUbLWcVxalWFYKnSd/1QQeBkAKKURnqd/cJwyZBjxqxbLzHgk0hF+84w3QZItyrKMSCSC0VFwFRVnuzXtIy9jfBZjaQDY4m/stSMSa4TEQQgNmEzTg0NDXzVs2gTD4XAgHA6/GzFjgNXaUaWqef26bjMBBv4bOAjCvCaKk75otOkqIckkXsOaNY3o7gYRxXOXFxY+u6Lr1v9BCgAGdN1qWlhYf0WSzl0+ehTEZmtMbXFLC8jx499f1LTcPXiPMJmeXGpqOlDb2roUnwSxLMsIhyOQpHOXVdXtwypAFIP9L1/W1zidiZhzTqcXkUgEFkt7laY5VoUUADTN4bNY2qvC4TBcLm/C4uFhcJWVF2OJmK4eBCGq3blTay4thUESbjjbo6qf+JMlks3GYX7egNfrgtv9A+bn55Geng673Y7du3eD0iL4/ffx6JECm03A3JwOxlJnuyj+2auqX3/Jy/Jhh6Ks72SMtyZPDAJNY9i40Yq+vi9QU1OD6elp5OXlIRgMorp6C4qL14BSBkWhCAY1CAJgJL0MDIyl52Rm5v8kKEr2Osb4rJQXw0iob7ebMDIygvLy8qW9/Px89PT0oKSkBGfOfItTpwK4fz8KWU5DMBhH8hrBZ8ViWes4jhOqEhUpORwOEW63Cdu2CSgvL8fY2BgYY2CMobOzEzt27IDD4UBnZydevEi42WYTUp7HWBoIEXYJhmHd+qr8/Rvd3RuQns5j374NOH/+PLKzs9HX1wdCCOx2O+rq6pCTkwNN00AIQSCgYnx8AUAsFTUYs24VKOULl9fe5XjyJIbm5s9x4sQJlJSUwO12g1KaUtHe3l7k5lbg3r35FBIElPKFHM/z8koWHzu2BUNDQ7h27RpKS0tXJAUAv9+Pykr7ChIMPM/bhbfdPb/fj4GBAfT39y+tud1ubN68GRkZGQiFQpiamsKzZ8+gKApisRhGR/sAFK18pymlEYA4U1lNKUVlZSUuXLiA7du3w25fbg1J0nri8Tiam39ewdU0IvA8nYjHmTOVZnv37kVhYSE8Hg/YYmX45zs5OYmZmRmUlZVBkqTF0qhB1/W3uJpOcBwXHU7RlgEA1dXV4HkegiDgwIEGdHR8A13XQQjBxMQEPB4P2tvbl+T379+PgwcPrUBMQEh0mEjSd1tU9eNfGUse7p07HcjOlvD0aRPMZjMGBgaW9nw+HyoqKqAoCjRNA6UUU1NTuH79OmZmfkxOS3SI4iMPWbv2sOP58/IxwxBTVi9CgPr6HITDzXC5XJAkCV1dXSltOnToF5w8qSav1pwayMj4vViYm+sIi2LXoKoWJG0SZjOBIHAoK7OB484gM/M31NXV4e7du7h5U0Ju7gzM5hhu3bqFkZEReDzHcfr0wgoj0dPBubmOMAGABw/AFRdfjFG6um2R56Pa+HituaAABudyeVFUBEMUH/sIoatGSgiFKE76CgpgLA0CTqcTs7OhDzv6AEAoFAIhQEtL/R6T6fGl901qMj2+1NJSv4cQLM3Yy8bbtrZGduRIQ60oBvvfh9sT7g32t7Y21La1NbJ3HOjbq1Q1/8MM9K+avwxFabp640atWZIe9nKcGiBEf01PkkR3AkJ0cJwakKSHvbdv15oVpemq0+l497dTIuG8CIXefLQJuwzDulXX+UJB4O2LTeQvjqMTPB8dNgz9isUSGI9E2t/6aPsbwfNWty4y/a8AAAAASUVORK5CYII=",id:"TravelNotes-Control-trainImgButton",className:"TravelNotes-Control-ImgButton"},i)).transitMode="train",v.addEventListener("click",n,!1),p.providers&&(l=!1,p.providers.forEach(a))}var i=null,s=m("../UI/HtmlElementsFactory")(),l=!1,d=null,c=null,u=null,v=null,g=function(e){p.routing.transitMode=e,document.getElementsByClassName("TravelNotes-Control-ActiveTransitModeImgButton")[0].classList.remove("TravelNotes-Control-ActiveTransitModeImgButton"),document.getElementById("TravelNotes-Control-"+e+"ImgButton").classList.add("TravelNotes-Control-ActiveTransitModeImgButton")};return Object.seal({createUI:function(e){r(e)},get provider(){return p.routing.provider},set provider(e){t(e)},get transitMode(){return p.routing.transitMode},set transitMode(e){g(e)}})})}()},{"../L.TravelNotes":8,"../UI/HtmlElementsFactory":18,"../core/RouteEditor":37}],22:[function(I,e,t){!function(){"use strict";function r(e){if(e.stopPropagation(),-1!==I("../L.TravelNotes").editedRouteObjId){document.getElementById("TravelNotes-Control-RouteHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var t=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML=t?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title=t?T.getText("RouteEditorUI - Show"):T.getText("RouteEditorUI - Hide")}}function i(e){e.stopPropagation(),I("../core/WaypointEditor")().removeWayPoint(e.itemNode.dataObjId)}function s(e){e.stopPropagation(),I("../core/WaypointEditor")().swapWayPoints(e.itemNode.dataObjId,!0)}function l(e){e.stopPropagation(),I("../core/WaypointEditor")().swapWayPoints(e.itemNode.dataObjId,!1)}function d(e){e.stopPropagation(),I("../core/WaypointEditor")().renameWayPoint(e.dataObjId,e.changeValue)}function c(e){e.stopPropagation(),I("../core/WaypointEditor")().wayPointDropped(e.draggedObjId,e.targetObjId,e.draggedBefore)}function u(e){e.stopPropagation(),document.getElementById("TravelNotes-Control-RouteDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var t=document.getElementById("TravelNotes-Control-RouteDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").innerHTML=t?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandWayPointsListButton").title=t?T.getText("RouteEditorUI - Reduce the list"):T.getText("RouteEditorUI - Expand the list")}function v(e){e.stopPropagation(),I("../core/RouteEditor")().cancelEdition()}function g(e){e.stopPropagation(),I("../core/RouteEditor")().saveEdition()}function p(e){e.stopPropagation(),I("../core/RouteEditor")().saveGpx()}function m(e){e.stopPropagation(),I("../core/WaypointEditor")().reverseWayPoints()}function f(e){e.stopPropagation(),I("../core/WaypointEditor")().removeAllWayPoints()}var T=I("./Translator")(),N=null;void 0!==e&&e.exports&&(e.exports=function(){return Object.seal({createUI:function(e){!function(e){if(!document.getElementById("TravelNotes-Control-RouteDataDiv")){var t=I("./HTMLElementsFactory")(),o=t.create("div",{id:"TravelNotes-Control-RouteHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},e);t.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-Control-RouteExpandButton",className:"TravelNotes-Control-ExpandButton"},o).addEventListener("click",r,!1),t.create("span",{innerHTML:T.getText("RouteEditorUI - Waypoints"),id:"TravelNotes-Control-RouteHeaderText",className:"TravelNotes-Control-HeaderText"},o);var n=t.create("div",{id:"TravelNotes-Control-RouteDataDiv",className:"TravelNotes-Control-DataDiv"},e);(N=I("./SortableList")({minSize:0,listStyle:"LimitedSort",id:"TravelNotes-Control-RouteWaypointsList"},n)).container.addEventListener("SortableListDelete",i,!1),N.container.addEventListener("SortableListUpArrow",s,!1),N.container.addEventListener("SortableListDownArrow",l,!1),N.container.addEventListener("SortableListChange",d,!1),N.container.addEventListener("SortableListDrop",c,!1);var a=t.create("div",{id:"TravelNotes-Control-RouteButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},e);t.create("div",{id:"TravelNotes-Control-ExpandWayPointsListButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Expand the list"),innerHTML:"&#x25bd;"},a).addEventListener("click",u,!1),t.create("div",{id:"TravelNotes-Control-CancelRouteButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Cancel"),innerHTML:"&#x274c"},a).addEventListener("click",v,!1),t.create("div",{id:"TravelNotes-Control-SaveRouteButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Save"),innerHTML:"&#x1f4be;"},a).addEventListener("click",g,!1),t.create("div",{id:"TravelNotes-Control-gpxButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Save the route in a gpx file"),innerHTML:"gpx"},a).addEventListener("click",p,!1),t.create("div",{id:"TravelNotes-Control-ReverseWayPointsButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Invert waypoints"),innerHTML:"&#x21C5;"},a).addEventListener("click",m,!1),t.create("div",{id:"TravelNotes-Control-RemoveAllWayPointsButton",className:"TravelNotes-Control-Button",title:T.getText("RouteEditorUI - Delete all waypoints"),innerHTML:"&#x267b;"},a).addEventListener("click",f,!1)}}(e)},expand:function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25bc;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Masquer",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.remove("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.remove("TravelNotes-Control-HiddenList")},reduce:function(){document.getElementById("TravelNotes-Control-RouteExpandButton").innerHTML="&#x25b6;",document.getElementById("TravelNotes-Control-RouteExpandButton").title="Afficher",document.getElementById("TravelNotes-Control-RouteDataDiv").classList.add("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-Control-RouteButtonsDiv").classList.add("TravelNotes-Control-HiddenList")},setWayPointsList:function(){!function(){if(N.removeAllItems(),-1!==I("../L.TravelNotes").editedRouteObjId)for(var e=I("../L.TravelNotes").travel.editedRoute.wayPoints.iterator;!e.done;){var t=e.first?"A":e.last?" B":e.index,o=e.first?T.getText("RouteEditorUI - Start"):e.last?T.getText("RouteEditorUI - End"):T.getText("RouteEditorUI - Via");N.addItem(e.value.UIName,t,o,e.value.objId,e.last)}}()}})})}()},{"../L.TravelNotes":8,"../core/RouteEditor":37,"../core/WaypointEditor":41,"./HTMLElementsFactory":16,"./SortableList":25,"./Translator":26}],23:[function(g,e,t){!function(){"use strict";var v=g("../UI/Translator")();void 0!==e&&e.exports&&(e.exports=function(e){var t=g("../UI/ColorDialog")(e.color);t.title=v.getText("RoutePropertiesDialog - Route properties"),t.addClickOkButtonEventListener(function(){return e.color=t.getNewColor(),e.width=parseInt(r.value),e.chain=u.checked,e.dashArray=s.selectedIndex,g("../core/MapEditor")().editRoute(e),g("../core/RouteEditor")().chainRoutes(),g("../UI/TravelEditorUI")().setRoutesList(),g("../core/TravelEditor")().updateRoadBook(),!0});var o=g("./HTMLElementsFactory")(),n=o.create("div",{id:"TravelNotes-RoutePropertiesDialog-MainDataDiv"},t.content),a=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-WithDiv"},n);a.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Width")+"</span>";var r=o.create("input",{type:"number",id:"TravelNotes-RoutePropertiesDialog-WidthInput"},a);r.value=e.width,r.min=1,r.max=40;var i=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-dashDiv"},n);i.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Linetype")+"</span>";for(var s=o.create("select",{className:"TravelNotes-RoutePropertiesDialog-Select",id:"TravelNotes-RoutePropertiesDialog-DashSelect"},i),l=g("../L.TravelNotes").config.route.dashChoices,d=0;d<l.length;d++)s.add(o.create("option",{text:l[d].text}));s.selectedIndex=e.dashArray<l.length?e.dashArray:0;var c=o.create("div",{className:"TravelNotes-RoutePropertiesDialog-DataDiv",id:"TravelNotes-RoutePropertiesDialog-ChainDiv"},n);c.innerHTML="<span>"+v.getText("RoutePropertiesDialog - Chained route")+"</span>";var u=o.create("input",{type:"checkbox",id:"TravelNotes-RoutePropertiesDialog-ChainInput"},c);return u.checked=e.chain,t})}()},{"../L.TravelNotes":8,"../UI/ColorDialog":11,"../UI/Translator":26,"../UI/TravelEditorUI":27,"../core/MapEditor":34,"../core/RouteEditor":37,"../core/TravelEditor":40,"./HTMLElementsFactory":16}],24:[function(g,e,t){!function(){"use strict";function r(e){"Enter"===e.key&&l(e)}var i=g("../core/OsmSearchEngine")(),s="",l=function(e){s=document.getElementById("TravelNotes-Control-SearchInput").value;for(var t=document.getElementById("TravelNotes-Control-SearchDiv"),o=document.getElementsByClassName("TravelNotes-Control-SearchResult");0!==o.length;)o[0].removeEventListener("click",d,!1),o[0].removeEventListener("contextmenu",c,!1),o[0].removeEventListener("mouseenter",u,!1),o[0].removeEventListener("mouseleave",v,!1),t.removeChild(o[0]);if(!document.getElementById("TravelNotes-Control-SearchWaitBullet")){var n=g("./HTMLElementsFactory")();n.create("div",{id:"TravelNotes-Control-SearchWaitBullet"},n.create("div",{id:"TravelNotes-Control-SearchWait"},t))}i.search()},d=function(e){e.stopPropagation();for(var t=e.target;!t.latLng;)t=t.parentNode;g("../core/MapEditor")().zoomToSearchResult(t.latLng,t.geometry)},c=function(e){e.stopPropagation(),e.preventDefault();for(var t=e.target;!t.latLng;)t=t.parentNode;g("../core/NoteEditor")().newSearchNote(t.searchResult)},u=function(e){e.stopPropagation(),g("../core/MapEditor")().addSearchPointMarker(e.target.objId,e.target.latLng,e.target.geometry)},v=function(e){e.stopPropagation(),g("../core/MapEditor")().removeObject(e.target.objId)};void 0!==e&&e.exports&&(e.exports=function(){return Object.seal({remove:function(){!function(){var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){i.hide();var t=document.getElementById("TravelNotes-Control-SearchButton");t&&t.removeEventListener("click",l,!1);var o=document.getElementById("TravelNotes-Control-SearchInput");o&&o.removeEventListener("change",l,!1);var n=document.getElementById("TravelNotes-Control-SearchDiv"),a=document.getElementsByClassName("TravelNotes-Control-SearchResult");Array.prototype.forEach.call(a,function(e){e.removeEventListener("click",d,!1),e.removeEventListener("contextmenu",c,!1),e.removeEventListener("mouseenter",u,!1),e.removeEventListener("mouseleave",v,!1)}),n&&e.removeChild(n)}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-SearchPaneButton").classList.add("TravelNotes-Control-ActivePaneButton");var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){i.show();var o=g("./HTMLElementsFactory")(),n=o.create("div",{id:"TravelNotes-Control-SearchDiv"},e);o.create("div",{id:"TravelNotes-Control-SearchButton",className:"TravelNotes-Control-Button",title:g("./Translator")().getText("SearchPaneUI - Search OpenStreetMap"),innerHTML:"&#x1f50e"},n).addEventListener("click",l,!1);var t=o.create("input",{type:"text",id:"TravelNotes-Control-SearchInput",placeholder:g("./Translator")().getText("SearchPaneUI - Search phrase"),value:s},n);t.addEventListener("change",l,!1),t.addEventListener("keydown",r,!1),t.focus();var a=0;g("../L.TravelNotes").searchData.forEach(function(e){var t=o.create("div",{id:"TravelNotes-Control-SearchResult"+a++,className:"TravelNotes-Control-SearchResult",innerHTML:(""!=e.description?"<p class='TravelNotes-Control-SearchResultDescription'>"+e.description+"</p>":"")+(e.tags.name?"<p>"+e.tags.name+"</p>":"")+(e.tags["addr:street"]?"<p>"+e.tags["addr:street"]+" "+(e.tags["addr:housenumber"]?e.tags["addr:housenumber"]:"")+"</p>":"")+(e.tags["addr:city"]?"<p>"+(e.tags["addr:postcode"]?e.tags["addr:postcode"]+" ":"")+e.tags["addr:city"]+"</p>":"")+(e.tags.phone?"<p>"+e.tags.phone+"</p>":"")+(e.tags.email?"<p><a href='mailto:"+e.tags.email+"'>"+e.tags.email+"</a></p>":"")+(e.tags.website?"<p><a href='"+e.tags.website+"' target='_blank'>"+e.tags.website+"</a></p>":"")+(e.ranking?"<p>&#x26ab;"+e.ranking+"</p>":"")},n);t.searchResult=e,t.objId=g("../data/ObjId")(),t.osmId=e.id,t.latLng=L.latLng([e.lat,e.lon]),t.geometry=e.geometry,t.addEventListener("click",d,!1),t.addEventListener("contextmenu",c,!1),t.addEventListener("mouseenter",u,!1),t.addEventListener("mouseleave",v,!1)})}}()}})})}()},{"../L.TravelNotes":8,"../core/MapEditor":34,"../core/NoteEditor":35,"../core/OsmSearchEngine":36,"../data/ObjId":50,"./HTMLElementsFactory":16,"./Translator":26}],25:[function(n,e,t){!function(){"use strict";function d(e){e.stopPropagation();try{e.dataTransfer.setData("Text",e.target.dataObjId),e.dataTransfer.dropEffect="move"}catch(e){}s=e.target.dataObjId-1}function a(e){e.preventDefault()}function r(e){e.preventDefault();for(var t=e.target;!t.dataObjId;)t=t.parentElement;var o=t.getBoundingClientRect(),n=new Event("SortableListDrop");n.draggedObjId=s+1,n.targetObjId=t.dataObjId,n.draggedBefore=e.clientY-o.top<o.bottom-e.clientY,t.parentNode.dispatchEvent(n)}function c(e){var t=new Event("SortableListDelete");t.itemNode=e.target.parentNode,e.target.parentNode.parentNode.dispatchEvent(t),e.stopPropagation()}function u(e){var t=new Event("SortableListUpArrow");t.itemNode=e.target.parentNode,e.target.parentNode.parentNode.dispatchEvent(t),e.stopPropagation()}function v(e){var t=new Event("SortableListDownArrow");t.itemNode=e.target.parentNode,e.target.parentNode.parentNode.dispatchEvent(t),e.stopPropagation()}function g(e){var t=new Event("SortableListRightArrow");t.itemNode=e.target.parentNode,e.target.parentNode.parentNode.dispatchEvent(t),e.stopPropagation()}function p(e){var t=new Event("SortableListChange");t.dataObjId=e.target.parentNode.dataObjId,t.changeValue=e.target.value,e.target.parentNode.parentNode.dispatchEvent(t),e.stopPropagation()}function i(e){e.deltaY&&(e.target.scrollTop=e.target.scrollTop+10*e.deltaY),e.stopPropagation()}function o(e,t){var l=n("./HTMLElementsFactory")();this.items=[],this.removeAllItems=function(){for(var e=0;e<this.items.length;e++)this.container.removeChild(this.items[e]);this.items.length=0},this.addItem=function(e,t,o,n,a){e=e||"",t=t||"",o=o||"",n=n||-1;var r=l.create("div",{draggable:!1,className:"TravelNotes-SortableList-Item"});l.create("div",{className:"TravelNotes-SortableList-ItemTextIndex",innerHTML:t},r);var i=l.create("input",{type:"text",className:"TravelNotes-SortableList-ItemInput",placeholder:o,value:e},r);i.addEventListener("change",p,!1),i.addEventListener("focus",function(e){e.target.parentElement.draggable=!1},!1),i.addEventListener("blur",function(e){e.target.parentElement.draggable=e.target.parentElement.canDrag},!1),l.create("div",{className:"TravelNotes-SortableList-ItemUpArrowButton",title:m.getText("SortableList - Move up"),innerHTML:String.fromCharCode(8679)},r).addEventListener("click",u,!1),l.create("div",{className:"TravelNotes-SortableList-ItemDownArrowButton",title:m.getText("SortableList - Move down"),innerHTML:String.fromCharCode(8681)},r).addEventListener("click",v,!1);var s=l.create("div",{className:"TravelNotes-SortableList-ItemRightArrowButton",title:m.getText("SortableList - Edit"),innerHTML:String.fromCharCode(8688)},r);"AllSort"===this.options.listStyle&&s.addEventListener("click",g,!1),l.create("div",{className:"TravelNotes-SortableList-ItemDeleteButton",title:m.getText("SortableList - Delete"),innerHTML:"&#x267b;"},r).addEventListener("click",c,!1),r.dataObjId=n,r.canDrag=!1,("LimitedSort"!==this.options.listStyle||1<this.items.length)&&!a&&(r.draggable=!0,r.addEventListener("dragstart",d,!1),r.classList.add("TravelNotes-SortableList-MoveCursor"),r.canDrag=!0),this.items.push(r),this.container.appendChild(r)},this._create=function(e,t){for(var o in this.options={minSize:2,listStyle:"AllSort",id:"TravelNotes-SortableList-Container"},e)this.options[o]=e[o];"LimitedSort"===this.options.listStyle&&this.options.minSize<2&&(this.options.minSize=0),this.container=l.create("div",{id:e.id,className:"TravelNotes-SortableList-Container"}),this.container.classList.add(this.options.listStyle),this.container.addEventListener("drop",r,!1),this.container.addEventListener("dragover",a,!1),this.container.addEventListener("wheel",i,!1),t&&t.appendChild(this.container);for(var n=0;n<this.options.minSize;n++)this.addItem()},this._create(e,t)}var m=n("../UI/Translator")(),s=0;void 0!==e&&e.exports&&(e.exports=function(e,t){return new o(e,t)})}()},{"../UI/Translator":26,"./HTMLElementsFactory":16}],26:[function(e,t,o){(function(n){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){return n.translations||(n.translations=new Map),{setTranslations:function(e){e.forEach(function(e){n.translations.set(e.msgid,e.msgstr)})},getText:function(e,t){var o=n.translations.get(e);return t&&o&&Object.getOwnPropertyNames(t).forEach(function(e){o=o.replace("{"+e+"}",t[e])}),o||e}}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(P,e,t){!function(){"use strict";function c(e){o&&(clearTimeout(o),o=null),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Minimize"),document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Maximize")}function t(){document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Maximize"),document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Minimize")}function u(e){o=setTimeout(t,M.config.travelEditor.timeout)}function v(e){e.stopPropagation(),document.getElementById("TravelNotes-Control-TravelHeaderDiv").classList.toggle("TravelNotes-Control-SmallHeader"),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-HiddenList"),document.getElementById("TravelNotes-ControlTravelButtonsDiv").classList.toggle("TravelNotes-Control-HiddenList");var t=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-HiddenList");document.getElementById("TravelNotes-ControlTravelExpandButton").innerHTML=t?"&#x25b6;":"&#x25bc;",document.getElementById("TravelNotes-ControlTravelExpandButton").title=t?R.getText("TravelEditorUI - Show"):R.getText("TravelEditorUI - Hide"),e.stopPropagation()}function g(e){var t=document.getElementById("TravelNotes-Control-MainDiv");10060===e.target.innerHTML.charCodeAt(0)?(e.target.innerHTML="&#x1f4cc;",t.addEventListener("mouseenter",c,!1),t.addEventListener("mouseleave",u,!1)):(e.target.innerHTML="&#x274c;",t.removeEventListener("mouseenter",c,!1),t.removeEventListener("mouseleave",u,!1))}function p(e){e.stopPropagation(),P("../core/TravelEditor")().removeRoute(e.itemNode.dataObjId)}function m(e){e.stopPropagation(),P("../core/TravelEditor")().swapRoute(e.itemNode.dataObjId,!0)}function f(e){e.stopPropagation(),P("../core/TravelEditor")().swapRoute(e.itemNode.dataObjId,!1)}function T(e){e.stopPropagation(),P("../core/TravelEditor")().editRoute(e.itemNode.dataObjId)}function N(e){e.stopPropagation(),P("../core/TravelEditor")().renameRoute(e.dataObjId,e.changeValue)}function I(e){e.stopPropagation(),P("../core/TravelEditor")().routeDropped(e.draggedObjId,e.targetObjId,e.draggedBefore)}function L(e){e.stopPropagation(),document.getElementById("TravelNotes-Control-TravelDataDiv").classList.toggle("TravelNotes-Control-ExpandedList");var t=document.getElementById("TravelNotes-Control-TravelDataDiv").classList.contains("TravelNotes-Control-ExpandedList");document.getElementById("TravelNotes-Control-ExpandRoutesListButton").innerHTML=t?"&#x25b3;":"&#x25bd;",document.getElementById("TravelNotes-Control-ExpandRoutesListButton").title=t?R.getText("TravelEditorUI - Reduce the list"):R.getText("TravelEditorUI - Expand the list")}function y(e){e.stopPropagation(),P("../core/TravelEditor")().clear(),P("../L.TravelNotes").config.travelEditor.startupRouteEdition&&P("../core/TravelEditor")().editRoute(P("../L.TravelNotes").travel.routes.first.objId),P("../L.TravelNotes").map.fire("travelnotesfileloaded",{readOnly:!1,name:""})}function h(e){e.stopPropagation(),P("../core/TravelEditor")().saveTravel()}function E(e){e.stopPropagation(),P("../core/RouteEditor")().cancelEdition(),P("../core/FileLoader")().openLocalFile(e)}function b(){P("../core/TravelEditor")().confirmClose()&&document.getElementById("TravelNotes-Control-OpenTravelInput").click()}function D(e){e.stopPropagation(),P("../core/FileLoader")().mergeLocalFile(e)}function C(e){-1!==M.editedRouteObjId?P("../core/ErrorEditor")().showError(R.getText("TravelEditorUI - Not possible to merge a travel when a route is edited")):document.getElementById("TravelNotes-Control-ImportTravelInput").click()}function x(e){e.stopPropagation(),P("../core/TravelEditor")().addRoute()}var R=P("../UI/Translator")(),M=P("../L.TravelNotes"),j=null,o=null;void 0!==e&&e.exports&&(e.exports=function(){return Object.seal({createUI:function(e){!function(e){if(!document.getElementById("TravelNotes-Control-TravelDataDiv")){var t=P("./HTMLElementsFactory")(),o=t.create("div",{id:"TravelNotes-Control-TravelHeaderDiv",className:"TravelNotes-Control-HeaderDiv"},e);t.create("span",{innerHTML:"&#x25bc;",id:"TravelNotes-ControlTravelExpandButton",className:"TravelNotes-Control-ExpandButton"},o).addEventListener("click",v,!1),t.create("span",{innerHTML:R.getText("TravelEditorUI - Travel routes"),id:"TravelNotes-Control-TravelHeaderText",className:"TravelNotes-Control-HeaderText"},o);var n=t.create("span",{innerHTML:"&#x274c;",id:"TravelNotes-Control-PinButton"},o);n.addEventListener("click",g,!1);var a=t.create("div",{id:"TravelNotes-Control-TravelDataDiv",className:"TravelNotes-Control-DataDiv"},e);(j=P("./SortableList")({minSize:0,id:"TravelNotes-Control-TravelRoutesList"},a)).container.addEventListener("SortableListDelete",p,!1),j.container.addEventListener("SortableListUpArrow",m,!1),j.container.addEventListener("SortableListDownArrow",f,!1),j.container.addEventListener("SortableListRightArrow",T,!1),j.container.addEventListener("SortableListChange",N,!1),j.container.addEventListener("SortableListDrop",I,!1);var r=t.create("div",{id:"TravelNotes-ControlTravelButtonsDiv",className:"TravelNotes-Control-ButtonsDiv"},e);t.create("div",{id:"TravelNotes-Control-ExpandRoutesListButton",className:"TravelNotes-Control-Button",title:R.getText("TravelEditorUI - Expand the list"),innerHTML:"&#x25bd;"},r).addEventListener("click",L,!1),t.create("div",{id:"TravelNotes-Control-CancelTravelButton",className:"TravelNotes-Control-Button",title:R.getText("TravelEditorUI - Cancel travel"),innerHTML:"&#x274c"},r).addEventListener("click",y,!1),t.create("div",{id:"TravelNotes-Control-SaveTravelButton",className:"TravelNotes-Control-Button",title:R.getText("TravelEditorUI - Save travel"),innerHTML:"&#x1f4be;"},r).addEventListener("click",h,!1);var i=t.create("div",{id:"TravelNotes-Control-OpenTravelDiv"},r);t.create("input",{id:"TravelNotes-Control-OpenTravelInput",type:"file",accept:".trv"},i).addEventListener("change",E,!1);var s=t.create("div",{id:"TravelNotes-Control-OpenTravelFakeDiv"},i);t.create("div",{id:"TravelNotes-Control-OpenTravelButton",className:"TravelNotes-Control-Button",title:R.getText("TravelEditorUI - Open travel"),innerHTML:"&#x1F4C2;"},s).addEventListener("click",b,!1);var l=t.create("div",{id:"TravelNotes-Control-ImportTravelDiv"},r);t.create("input",{id:"TravelNotes-Control-ImportTravelInput",type:"file",accept:".trv,.map"},l).addEventListener("change",D,!1);var d=t.create("div",{id:"TravelNotes-Control-ImportTravelFakeDiv"},l);t.create("div",{id:"TravelNotes-Control-ImportTravelButton",className:"TravelNotes-Control-Button",title:R.getText("TravelEditorUI - Import travel"),innerHTML:"&#x1F30F;"},d).addEventListener("click",C,!1),t.create("div",{id:"TravelNotes-Control-OpenTravelRoadbookButton",className:"TravelNotes-Control-Button",title:R.getText("TravelEditorUI - Open travel roadbook"),innerHTML:'<a id="TravelNotes-Control-OpenTravelRoadbookLink" href="TravelNotesRoadbook.html?lng='+M.config.language+"&page="+M.UUID+'" target="_blank">&#x1F4CB;</a>'},r),t.create("div",{id:"TravelNotes-Control-AddRoutesButton",className:"TravelNotes-Control-Button",title:R.getText("TravelEditorUI - New route"),innerHTML:"+"},r).addEventListener("click",x,!1),M.config.travelEditor.startMinimized?(n.innerHTML="&#x1f4cc;",e.addEventListener("mouseenter",c,!1),e.addEventListener("mouseleave",u,!1),e.classList.add("TravelNotes-Control-MainDiv-Minimize")):e.classList.add("TravelNotes-Control-MainDiv-Maximize")}}(e)},setRoutesList:function(){!function(){j.removeAllItems();for(var e=M.travel.routes.iterator;!e.done;)j.addItem(e.value.name,e.value.chain?"&#x26d3;":"",R.getText("TravelEditorUI - Route"),e.value.objId,!1)}()}})})}()},{"../L.TravelNotes":8,"../UI/Translator":26,"../core/ErrorEditor":31,"../core/FileLoader":32,"../core/RouteEditor":37,"../core/TravelEditor":40,"./HTMLElementsFactory":16,"./SortableList":25}],28:[function(d,e,t){!function(){"use strict";function n(e){e.stopPropagation();try{e.dataTransfer.setData("Text",e.target.dataObjId),e.dataTransfer.dropEffect="move"}catch(e){}l=e.target.noteObjId-1}function a(e){e.preventDefault()}function r(e){e.preventDefault();for(var t=e.target;!t.noteObjId;)t=t.parentElement;var o=t.getBoundingClientRect();d("../core/NoteEditor")().noteDropped(l+1,t.noteObjId,e.clientY-o.top<o.bottom-e.clientY)}function i(e){e.stopPropagation(),e.preventDefault();for(var t=e.target;!t.noteObjId;)t=t.parentNode;d("../core/MapEditor")().zoomToNote(t.noteObjId)}function s(e){e.stopPropagation(),e.preventDefault();for(var t=e.target;!t.noteObjId;)t=t.parentNode;d("../core/NoteEditor")().editNote(t.noteObjId)}var l=0;void 0!==e&&e.exports&&(e.exports=function(){return Object.seal({remove:function(){!function(){var e=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(e){var t=e.firstChild;t&&(t.childNodes.forEach(function(e){e.removeEventListener("click",i,!1),e.removeEventListener("contextmenu",s,!1),e.removeEventListener("dragstart",n,!1)}),e.removeChild(t))}}()},add:function(){!function(){document.getElementById("TravelNotes-Control-ItineraryPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton"),document.getElementById("TravelNotes-Control-TravelNotesPaneButton").classList.add("TravelNotes-Control-ActivePaneButton"),window.osmSearch&&document.getElementById("TravelNotes-Control-SearchPaneButton").classList.remove("TravelNotes-Control-ActivePaneButton");var e=d("../UI/HTMLViewsFactory")();e.classNamePrefix="TravelNotes-Control-";var t=document.getElementById("TravelNotes-Control-ItineraryDataDiv");if(t){var o=e.travelNotesHTML;o.addEventListener("drop",r,!1),o.addEventListener("dragover",a,!1),t.appendChild(o),o.childNodes.forEach(function(e){e.addEventListener("click",i,!1),e.addEventListener("contextmenu",s,!1),e.draggable=!0,e.addEventListener("dragstart",n,!1),e.classList.add("TravelNotes-SortableList-MoveCursor")})}}()}})})}()},{"../UI/HTMLViewsFactory":17,"../core/MapEditor":34,"../core/NoteEditor":35}],29:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){var e=document.getElementById("TravelNotes-Control-MainDiv");return e||(e=t("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv"}),t("./HTMLElementsFactory")().create("div",{id:"TravelNotes-Control-MainDiv-Title",innerHTML:"Travel&nbsp;&amp;&nbsp;Notes"},e),t("./TravelEditorUI")().createUI(e),t("./RouteEditorUI")().createUI(e),t("./DataPanesUI")().createUI(e),t("./ProvidersToolbarUI")().createUI(e),t("./ErrorEditorUI")().createUI(e),e.addEventListener("click",function(e){e.target.classList.contains("TravelNotes-SortableList-ItemInput")||e.target.id&&-1!==["TravelNotes-Control-OpenTravelInput","TravelNotes-Control-OpenTravelButton","TravelNotes-Control-ImportTravelInput","TravelNotes-Control-ImportTravelButton","TravelNotes-Control-OpenTravelRoadbookLink"].indexOf(e.target.id)||(e.stopPropagation(),e.preventDefault())},!1),e.addEventListener("dblclick",function(e){e.stopPropagation(),e.preventDefault()},!1),e.addEventListener("wheel",function(e){e.stopPropagation(),e.preventDefault()},!1)),{get UI(){return e}}})}()},{"./DataPanesUI":14,"./ErrorEditorUI":15,"./HTMLElementsFactory":16,"./ProvidersToolbarUI":21,"./RouteEditorUI":22,"./TravelEditorUI":27}],30:[function(e,t,o){arguments[4][10][0].apply(o,arguments)},{"../UI/Translator":26,"./HTMLElementsFactory":16,dup:10}],31:[function(t,e,o){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){return{showError:function(e){t("../UI/ErrorEditorUI")().message='<span class="TravelNotes-Control-Error">'+e+"</span>"},clear:function(){t("../UI/ErrorEditorUI")().message=""}}})}()},{"../UI/ErrorEditorUI":15}],32:[function(v,e,t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(){function e(o){o.itinerary.itineraryPoints.latLngs=v("@mapbox/polyline").decode(o.itinerary.itineraryPoints.latLngs,6);var n=[],a=0;o.itinerary.itineraryPoints.latLngs.forEach(function(e){var t={};t.lat=e[0],t.lng=e[1],t.distance=o.itinerary.itineraryPoints.distances[a],t.objId=o.itinerary.itineraryPoints.objIds[a],t.objType=o.itinerary.itineraryPoints.objType,n.push(t),a++}),o.itinerary.itineraryPoints=n}function o(){r.routes.forEach(e),r.editedRoute&&e(r.editedRoute),n?d():c()}function t(e){a=e.target.files[0].name;var t=new FileReader;t.onload=function(e){try{r=JSON.parse(t.result),o()}catch(e){console.log(e)}},t.readAsText(e.target.files[0])}var i=v("../L.TravelNotes"),s=v("../UI/Translator")(),n=!1,a="",l=!1,r={},d=function(){var e=v("../Data/Travel")();e.object=r;for(var t=e.routes.iterator;!t.done;)i.travel.routes.add(t.value);for(var o=e.notes.iterator;!o.done;)i.travel.notes.add(o.value);v("../Core/RouteEditor")().chainRoutes(),u()},c=function(){i.travel.object=r,i.editedRouteObjId=-1,""!==a&&(i.travel.name=a.substr(0,a.lastIndexOf("."))),i.travel.readOnly=l,i.travel.routes.forEach(function(e){0!==e.edited&&(i.editedRouteObjId=e.objId)}),u()},u=function(){var e=v("../core/MapEditor")();e.removeAllObjects();for(var t=i.travel.routes.iterator;!t.done;)0===t.value.edited&&e.addRoute(t.value,!0,!1,l);-1!==i.editedRouteObjId&&e.addRoute(i.travel.editedRoute,!0,!l,l);for(var o=i.travel.notes.iterator;!o.done;)e.addNote(o.value,l);if(e.zoomToTravel(),l)document.getElementById("TravelNotes-Control-MainDiv").classList.add("TravelNotes-Control-MainDiv-Hidden"),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Maximize"),document.getElementById("TravelNotes-Control-MainDiv").classList.remove("TravelNotes-Control-MainDiv-Minimize");else{if(v("../UI/TravelEditorUI")().setRoutesList(),-1!==i.editedRouteObjId){var n=i.travel.editedRoute.itinerary.provider;if(n&&""!==n&&!i.providers.get(n.toLowerCase()))v("../core/ErrorEditor")().showError(s.getText("FileLoader - Not possible to select as provider",{provider:n}));else{var a=i.travel.editedRoute.itinerary.transitMode;v("../UI/ProvidersToolbarUI")().provider=n,a&&""!==a&&(v("../UI/ProvidersToolbarUI")().transitMode=a)}v("../core/RouteEditor")().chainRoutes();var r=v("../UI/RouteEditorUI")();r.expand(),r.setWayPointsList(),v("../UI/DataPanesUI")().setItinerary()}v("../core/TravelEditor")().updateRoadBook(!1)}i.map.fire("travelnotesfileloaded",{readOnly:l,name:i.travel.name})};return Object.seal({openLocalFile:function(e){!function(e){l=n=!1,t(e)}(e)},mergeLocalFile:function(e){!function(e){l=!(n=!0),t(e)}(e)},openDistantFile:function(e){!function(e){L.travelNotes.rightContextMenu=!1,l=!0,r=e,o()}(e)}})})}()},{"../Core/RouteEditor":2,"../Data/Travel":6,"../L.TravelNotes":8,"../UI/DataPanesUI":14,"../UI/ProvidersToolbarUI":21,"../UI/RouteEditorUI":22,"../UI/Translator":26,"../UI/TravelEditorUI":27,"../core/ErrorEditor":31,"../core/MapEditor":34,"../core/RouteEditor":37,"../core/TravelEditor":40,"@mapbox/polyline":1}],33:[function(d,e,t){!function(){"use strict";var l=!1;void 0!==e&&e.exports&&(e.exports=function(){function n(t,o){var n=new XMLHttpRequest;n.timeout=d("../L.TravelNotes").config.note.svgTimeOut,n.ontimeout=function(e){o("TimeOut error")},n.onreadystatechange=function(){if(4==n.readyState)if(200==n.status){var e;l=!1;try{e=JSON.parse(this.responseText)}catch(e){l=!1,o("Parsing error")}l=!1,e.objId=r,t(e)}else l=!1,o("Status : "+this.status+" statusText : "+this.statusText)};var e=d("../L.TravelNotes").config.nominatim.url+"reverse?format=json&lat="+i+"&lon="+s+"&zoom=18&addressdetails=1",a=d("../L.TravelNotes").config.nominatim.language;a&&"*"!==a&&(e+="&accept-language="+a),n.open("GET",e,!0),a&&"*"===a&&n.setRequestHeader("accept-language",""),n.overrideMimeType("application/json"),n.send(null)}var r=-1,i=0,s=0;return Object.seal({getPromiseAddress:function(e,t,o){return function(e,t,o){return l?Promise.reject():(l=!0,r=o||-1,i=e,s=t,new Promise(n))}(e,t,o)}})})}()},{"../L.TravelNotes":8}],34:[function(f,e,t){!function(){"use strict";var m=f("../L.TravelNotes");void 0!==e&&e.exports&&(e.exports=function(){function d(e){var t=v.getRoute(e.target.objId),o=f("../core/RouteEditor")().getClosestLatLngDistance(t,[e.latlng.lat,e.latlng.lng]).distance;o+=t.chainedDistance,o=f("../util/Utilities")().formatDistance(o);var n=m.mapObjects.get(e.target.objId);n.closeTooltip();var a=v.getRoute(e.target.objId).name;m.travel.readOnly||(a+=0===a.length?"":" - ",a+=o),n.setTooltipContent(a),n.openTooltip(e.latlng)}function c(e,t){t.objId=e,t.addTo(m.map),m.mapObjects.set(e,t)}function r(e){var t=m.mapObjects.get(e);t&&(L.DomEvent.off(t),m.map.removeLayer(t),m.mapObjects.delete(e))}function s(e){var t=L.latLng([90,180]),o=L.latLng([-90,-180]);return e.forEach(function(e){t.lat=Math.min(t.lat,e[0]),t.lng=Math.min(t.lng,e[1]),o.lat=Math.max(o.lat,e[0]),o.lng=Math.max(o.lng,e[1])}),L.latLngBounds(t,o)}function o(e){var t=[];return e.itinerary.itineraryPoints.forEach(function(e){t.push(e.latLng)}),e.notes.forEach(function(e){t.push(e.latLng),t.push(e.iconLatLng)}),t}function u(e){e.dashArray>=m.config.route.dashChoices.length&&(e.dashArray=0);var t=m.config.route.dashChoices[e.dashArray].iDashArray;if(t){var o="",n=0;for(n=0;n<t.length-1;n++)o+=t[n]*e.width+",";return o+=t[n]*e.width}return null}function n(e){m.map.setView(e,m.config.itineraryPointZoom)}var v=f("../Data/DataSearchEngine")(),g=function(e,t){if(0!==e.lat||0!==e.lng){var o='<div class="TravelNotes-WayPoint TravelNotes-WayPoint'+("A"===t?"Start":"B"===t?"End":"Via")+'"></div><div class="TravelNotes-WayPointText">'+t+"</div>",n=L.marker(e.latLng,{icon:L.divIcon({iconSize:[40,40],iconAnchor:[20,40],html:o,className:"TravelNotes-WayPointStyle"}),draggable:!0});n.bindTooltip(function(e){return v.getWayPoint(e.objId).UIName}),n.getTooltip().options.offset=[20,-20],L.DomEvent.on(n,"contextmenu",function(e){f("../UI/ContextMenu")(e,f("../UI/ContextMenuFactory")().getWayPointContextMenu(e.target.objId))}),n.objId=e.objId,c(e.objId,n),L.DomEvent.on(n,"dragend",function(e){m.travel.editedRoute.wayPoints.getAt(e.target.objId).latLng=[e.target.getLatLng().lat,e.target.getLatLng().lng],f("../core/WaypointEditor")().wayPointDragEnd(e.target.objId)})}},p=function(e,t){t=t||!1;var o=L.marker(e.latLng,{icon:L.divIcon({iconSize:[m.config.note.grip.size,m.config.note.grip.size],iconAnchor:[m.config.note.grip.size/2,m.config.note.grip.size/2],html:"<div></div>"}),zIndexOffset:-1e3,opacity:m.config.note.grip.opacity,draggable:!t});o.objId=e.objId,t||(L.DomEvent.on(o,"dragend",function(e){var t=v.getNoteAndRoute(e.target.objId),o=t.note,n=t.route,a=m.mapObjects.get(e.target.objId);if(null!=n){var r=f("../core/RouteEditor")().getClosestLatLngDistance(n,[e.target.getLatLng().lat,e.target.getLatLng().lng]);o.latLng=r.latLng,o.distance=r.distance,n.notes.sort(function(e,t){return e.distance-t.distance}),a.getLayer(a.bulletId).setLatLng(r.latLng),f("../UI/DataPanesUI")().updateItinerary()}else o.latLng=[e.target.getLatLng().lat,e.target.getLatLng().lng],f("../UI/DataPanesUI")().updateTravelNotes();a.getLayer(a.polylineId).setLatLngs([o.latLng,o.iconLatLng]),f("../core/TravelEditor")().updateRoadBook()}),L.DomEvent.on(o,"drag",function(e){var t=v.getNoteAndRoute(e.target.objId).note,o=m.mapObjects.get(e.target.objId);o.getLayer(o.polylineId).setLatLngs([[e.latlng.lat,e.latlng.lng],t.iconLatLng])}));var n=L.divIcon({iconSize:[e.iconWidth,e.iconHeight],iconAnchor:[e.iconWidth/2,e.iconHeight/2],popupAnchor:[0,-e.iconHeight/2],html:e.iconContent,className:m.config.note.style}),a=L.marker(e.iconLatLng,{icon:n,draggable:!t});a.objId=e.objId,a.bindPopup(function(e){var t=v.getNoteAndRoute(e.objId).note;return f("../core/NoteEditor")().getNoteHTML(t,"TravelNotes-")}),0!==e.tooltipContent.length&&(a.bindTooltip(function(e){return v.getNoteAndRoute(e.objId).note.tooltipContent}),a.getTooltip().options.offset[0]=e.iconWidth/2),t||(L.DomEvent.on(a,"contextmenu",function(e){f("../UI/ContextMenu")(e,f("../UI/ContextMenuFactory")().getNoteContextMenu(e.target.objId))}),L.DomEvent.on(a,"dragend",function(e){var t=v.getNoteAndRoute(e.target.objId).note;t.iconLatLng=[e.target.getLatLng().lat,e.target.getLatLng().lng];var o=m.mapObjects.get(e.target.objId);o.getLayer(o.polylineId).setLatLngs([t.latLng,t.iconLatLng])}),L.DomEvent.on(a,"drag",function(e){var t=v.getNoteAndRoute(e.target.objId).note,o=m.mapObjects.get(e.target.objId);o.getLayer(o.polylineId).setLatLngs([t.latLng,[e.latlng.lat,e.latlng.lng]])}));var r=L.polyline([e.latLng,e.iconLatLng],m.config.note.polyline);r.objId=e.objId;var i=L.layerGroup([a,r,o]);i.markerId=L.Util.stamp(a),i.polylineId=L.Util.stamp(r),i.bulletId=L.Util.stamp(o),c(e.objId,i)};return Object.seal({removeRoute:function(e,t,o){!function(e,t,o){if(r(e.objId),t)for(var n=e.notes.iterator;!n.done;)r(n.value.objId);if(o)for(var a=e.wayPoints.iterator;!a.done;)r(a.value.objId)}(e,t,o)},addRoute:function(e,t,o,n){!function(e,t,o,n){n=n||!1;for(var a=[],r=e.itinerary.itineraryPoints.iterator;!r.done;)a.push(r.value.latLng);var i=L.polyline(a,{color:e.color,weight:e.width,dashArray:u(e)});if(c(e.objId,i),i.bindTooltip(e.name,{sticky:!0,direction:"right"}),i.on("mouseover",d),i.on("mousemove",d),i.bindPopup(function(e){var t=v.getRoute(e.objId);return f("../core/RouteEditor")().getRouteHTML(t,"TravelNotes-")}),L.DomEvent.on(i,"click",function(e){e.target.openPopup(e.latlng)}),n||L.DomEvent.on(i,"contextmenu",function(e){f("../UI/ContextMenu")(e,f("../UI/ContextMenuFactory")().getRouteContextMenu(e.target.objId))}),t)for(var s=e.notes.iterator;!s.done;)p(s.value,n);if(o)for(var l=m.travel.editedRoute.wayPoints.iterator;!l.done;)g(l.value,l.first?"A":l.last?"B":l.index)}(e,t,o,n)},editRoute:function(e){!function(e){m.mapObjects.get(e.objId).setStyle({color:e.color,weight:e.width,dashArray:u(e)})}(e)},removeObject:function(e){r(e)},removeAllObjects:function(){m.mapObjects.forEach(function(e,t,o){L.DomEvent.off(e),m.map.removeLayer(e)}),m.mapObjects.clear()},zoomToPoint:function(e){n(e)},zoomToSearchResult:function(e,t){!function(e,t){if(t){var o=[];t.forEach(function(e){o=o.concat(e)}),m.map.fitBounds(s(o))}else n(e)}(e,t)},zoomToNote:function(e){!function(e){n(v.getNoteAndRoute(e).note.iconLatLng)}(e)},zoomToRoute:function(e){!function(e){var t=o(v.getRoute(e));0!==t.length&&m.map.fitBounds(s(t))}(e)},zoomToTravel:function(){!function(){var t=[];m.travel.routes.forEach(function(e){t=t.concat(o(e))}),t=t.concat(o(m.travel.editedRoute)),m.travel.notes.forEach(function(e){t.push(e.latLng),t.push(e.iconLatLng)}),0!==t.length&&m.map.fitBounds(s(t))}()},addItineraryPointMarker:function(e,t){!function(e,t){c(e,L.circleMarker(t,m.config.itineraryPointMarker))}(e,t)},addSearchPointMarker:function(e,t,o){!function(e,t,o){var n=!1;if(o){var a=[];o.forEach(function(e){a=a.concat(e)});var r=s(a),i=m.map.getBounds();n=.01<(r.getEast()-r.getWest())/(i.getEast()-i.getWest())&&.01<(r.getNorth()-r.getSouth())/(i.getNorth()-i.getSouth())}c(e,n?L.polyline(o,m.config.searchPointPolyline):L.circleMarker(t,m.config.searchPointMarker))}(e,t,o)},addRectangle:function(e,t,o){!function(e,t,o){c(e,L.rectangle(t,o))}(e,t,o)},addWayPoint:function(e,t){g(e,t)},redrawNote:function(e){!function(e){r(e.objId),p(e)}(e)},addNote:function(e,t){p(e,t)},editNote:function(e){!function(e){var t=L.divIcon({iconSize:[e.iconWidth,e.iconHeight],iconAnchor:[e.iconWidth/2,e.iconHeight/2],popupAnchor:[0,-e.iconHeight/2],html:e.iconContent,className:m.config.note.style}),o=m.mapObjects.get(e.objId),n=o.getLayer(o.markerId);n.setIcon(t),n.unbindTooltip(),0!==e.tooltipContent.length&&(n.bindTooltip(function(e){return v.getNoteAndRoute(e.objId).note.tooltipContent}),n.getTooltip().options.offset[0]=e.iconWidth/2),n.isPopupOpen()&&(n.closePopup(),n.openPopup())}(e)}})})}()},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/ContextMenu":12,"../UI/ContextMenuFactory":13,"../UI/DataPanesUI":14,"../core/NoteEditor":35,"../core/RouteEditor":37,"../core/TravelEditor":40,"../core/WaypointEditor":41,"../util/Utilities":58}],35:[function(c,e,t){!function(){"use strict";var d=c("../L.TravelNotes");void 0!==e&&e.exports&&(e.exports=function(){function r(e){var t=c("../data/Note")();return t.latLng=e,t.iconLatLng=e,t}function o(){for(var e=d.travel.notes.iterator;!e.done;)c("../core/MapEditor")().removeObject(e.value.objId);for(var t=d.travel.routes.iterator;!t.done;)for(e=t.value.notes.iterator;!e.done;)c("../core/MapEditor")().removeObject(e.value.objId)}var a=c("../UI/Translator")(),l=c("../Data/DataSearchEngine")();return Object.seal({newRouteNote:function(e,t){!function(e,t){var o=c("../core/RouteEditor")().getClosestLatLngDistance(l.getRoute(e),[t.latlng.lat,t.latlng.lng]),n=r(o.latLng);n.distance=o.distance,c("../UI/NoteDialog")(n,e,!0)}(e,t)},newSearchNote:function(e){!function(e){var t=r([e.lat,e.lon]);t.address=(e.tags["addr:housenumber"]?e.tags["addr:housenumber"]+" ":"")+(e.tags["addr:street"]?e.tags["addr:street"]+" ":"")+(e.tags["addr:city"]?e.tags["addr:city"]+" ":""),t.url=e.tags.website||"",t.phone=e.tags.phone||"",t.tooltipContent=e.tags.name||"",t.popupContent=e.tags.name||"",c("../UI/NoteDialog")(t,-1,!0)}(e)},newManeuverNote:function(e,t){!function(e,t){var o=c("../core/RouteEditor")().getClosestLatLngDistance(d.travel.editedRoute,t),n=d.travel.editedRoute.itinerary.maneuvers.getAt(e),a=r(t);a.distance=o.distance,a.iconContent="<div class='TravelNotes-ManeuverNote TravelNotes-ManeuverNote-"+n.iconName+"'></div>",a.popupContent=n.instruction,a.iconWidth=40,a.iconHeight=40,c("../UI/NoteDialog")(a,d.travel.editedRoute.objId,!0)}(e,t)},newTravelNote:function(e){!function(e){var t=r(e);c("../UI/NoteDialog")(t,-1,!0)}(e)},afterNoteDialog:function(e,t){!function(e,t){var o=l.getNoteAndRoute(e.objId);if(o.note)c("../core/MapEditor")().redrawNote(e),o.route?c("../UI/DataPanesUI")().setItinerary():c("../UI/DataPanesUI")().setTravelNotes();else{if(-1===t)d.travel.notes.add(e),c("../UI/DataPanesUI")().setTravelNotes();else{var n=l.getRoute(t);n.notes.add(e),e.chainedDistance=n.chainedDistance,n.notes.sort(function(e,t){return e.distance-t.distance}),c("../UI/DataPanesUI")().setItinerary()}c("../core/MapEditor")().addNote(e)}c("../core/TravelEditor")().updateRoadBook()}(e,t)},editNote:function(e){!function(e){var t=l.getNoteAndRoute(e);c("../UI/NoteDialog")(t.note,null===t.route?-1:t.route.objId,!1)}(e)},removeNote:function(e){!function(e){c("../core/MapEditor")().removeObject(e);var t=l.getNoteAndRoute(e);t.route?(t.route.notes.remove(e),c("../UI/DataPanesUI")().updateItinerary()):(d.travel.notes.remove(e),c("../UI/DataPanesUI")().updateTravelNotes()),c("../core/TravelEditor")().updateRoadBook()}(e)},hideNotes:function(){o()},showNotes:function(){!function(){o();for(var e=d.travel.notes.iterator;!e.done;)c("../core/MapEditor")().addNote(e.value);for(var t=d.travel.routes.iterator;!t.done;)for(e=t.value.notes.iterator;!e.done;)c("../core/MapEditor")().addNote(e.value)}()},zoomToNote:function(e){!function(e){c("../core/MapEditor")().zoomToPoint(l.getNoteAndRoute(e).note.latLng)}(e)},attachNoteToRoute:function(e){!function(e){var n=l.getNoteAndRoute(e),a=Number.MAX_VALUE,r=null,i=null,s=null;d.travel.routes.forEach(function(e){var t=c("../core/RouteEditor")().getClosestLatLngDistance(e,n.note.latLng);if(t){var o=L.latLng(n.note.latLng).distanceTo(L.latLng(t.latLng));o<a&&(a=o,r=e,i=t.latLng,s=t.distance)}}),r&&(d.travel.notes.remove(e),n.note.distance=s,n.note.latLng=i,n.note.chainedDistance=r.chainedDistance,r.notes.add(n.note),r.notes.sort(function(e,t){return e.distance-t.distance}),c("../core/MapEditor")().redrawNote(n.note),c("../UI/DataPanesUI")().updateItinerary(),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook())}(e)},detachNoteFromRoute:function(e){!function(e){var t=l.getNoteAndRoute(e);t.route.notes.remove(e),t.note.distance=-1,t.note.chainedDistance=0,d.travel.notes.add(t.note),c("../UI/DataPanesUI")().updateItinerary(),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook()}(e)},noteDropped:function(e,t,o){!function(e,t,o){d.travel.notes.moveTo(e,t,o),c("../UI/DataPanesUI")().updateTravelNotes(),c("../core/TravelEditor")().updateRoadBook()}(e,t,o)},getNoteHTML:function(e,t){return function(e,t){var o="";0!==e.tooltipContent.length&&(o+='<div class="'+t+'NoteHtml-TooltipContent">'+e.tooltipContent+"</div>"),0!==e.popupContent.length&&(o+='<div class="'+t+'NoteHtml-PopupContent">'+e.popupContent+"</div>"),0!==e.address.length&&(o+='<div class="'+t+'NoteHtml-Address">'+a.getText("NoteEditor - Address")+e.address+"</div>"),0!==e.phone.length&&(o+='<div class="'+t+'NoteHtml-Phone">'+a.getText("NoteEditor - Phone")+e.phone+"</div>"),0!==e.url.length&&(o+='<div class="'+t+'NoteHtml-Url">'+a.getText("NoteEditor - Link")+'<a href="'+e.url+'" target="_blank">'+e.url.substr(0,40)+"...</a></div>");var n=c("../util/Utilities")();return o+='<div class="'+t+'NoteHtml-LatLng">'+a.getText("NoteEditor - Latitude Longitude",{lat:n.formatLat(e.lat),lng:n.formatLng(e.lng)})+"</div>",-1!==e.distance&&(o+='<div class="'+t+'NoteHtml-Distance">'+a.getText("NoteEditor - Distance",{distance:n.formatDistance(e.chainedDistance+e.distance)})+"</div>"),o}(e,t)}})})}()},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/DataPanesUI":14,"../UI/NoteDialog":20,"../UI/Translator":26,"../core/MapEditor":34,"../core/RouteEditor":37,"../core/TravelEditor":40,"../data/Note":49,"../util/Utilities":58}],36:[function(c,u,e){!function(){"use strict";function t(){i.bbox&&(-1!==s?c("../core/MapEditor")().removeObject(s):s=c("../data/ObjId")(),c("../core/MapEditor")().addRectangle(s,L.latLngBounds(i.bbox.southWest,i.bbox.northEast),a.config.previousSearchLimit))}function o(e){a.searchData=e,r=!1,t(),c("../UI/DataPanesUI")().updateSearch()}function n(e){console.log(e),r=!1}function e(e){var t=a.map.getCenter();-1!==l?c("../core/MapEditor")().removeObject(l):l=c("../data/ObjId")(),c("../core/MapEditor")().addRectangle(l,L.latLngBounds(L.latLng(t.lat-d.lat,t.lng-d.lng),L.latLng(t.lat+d.lat,t.lng+d.lng)),a.config.nextSearchLimit)}var a=c("../L.TravelNotes"),r=!1,i={searchPhrase:"",bbox:null},s=-1,l=-1,d=window.osmSearch?window.osmSearch.searchLimits:null;void 0!==u&&u.exports&&(u.exports=function(){return Object.seal({search:function(){!function(){if(!r){r=!0;var e=a.map.getBounds();i={bbox:{southWest:e.getSouthWest(),northEast:e.getNorthEast()},searchPhrase:document.getElementById("TravelNotes-Control-SearchInput").value},a.searchData=[],window.osmSearch.getSearchPromise(i).then(o,n)}}()},show:function(){a.map.on("zoom",e),a.map.on("move",e),e(),t()},hide:function(){a.map.off("zoom",e),a.map.off("move",e),-1!==l&&(c("../core/MapEditor")().removeObject(l),l=-1),-1!==s&&(c("../core/MapEditor")().removeObject(s),s=-1)}})})}()},{"../L.TravelNotes":8,"../UI/DataPanesUI":14,"../core/MapEditor":34,"../data/ObjId":50}],37:[function(e,t,o){arguments[4][2][0].apply(o,arguments)},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/DataPanesUI":14,"../UI/RouteEditorUI":22,"../UI/RoutePropertiesDialog":23,"../UI/Translator":26,"../UI/TravelEditorUI":27,"../core/MapEditor":34,"../core/NoteEditor":35,"../core/Router":38,"../core/TravelEditor":40,"../data/ItineraryPoint":47,"../data/Route":52,"../util/Utilities":58,dup:2}],38:[function(r,e,t){!function(){"use strict";var n=!1,a=r("../L.TravelNotes");void 0!==e&&e.exports&&(e.exports=function(){function t(e){n=!1,r("../core/ErrorEditor")().showError(e)}function o(e){n=!1,r("./RouteEditor")().computeRouteDistances(a.travel.editedRoute);for(var t=a.travel.editedRoute.wayPoints.iterator;!t.done;)t.first?t.value.latLng=a.travel.editedRoute.itinerary.itineraryPoints.first.latLng:t.last?t.value.latLng=a.travel.editedRoute.itinerary.itineraryPoints.last.latLng:t.value.latLng=r("./RouteEditor")().getClosestLatLngDistance(a.travel.editedRoute,t.value.latLng).latLng;r("./RouteEditor")().endRouting()}function e(){if(n)return!1;if(!a.travel.editedRoute.wayPoints.forEach(function(e,t){return null===t&&(t=!0),t&=0!==e.lat&&0!==e.lng}))return!1;n=!0;var e=a.providers.get(a.routing.provider.toLowerCase());return a.travel.editedRoute.itinerary.provider=e.name,a.travel.editedRoute.itinerary.transitMode=a.routing.transitMode,e.getPromiseRoute(a.travel.editedRoute,null).then(o,t),!0}return Object.seal({startRouting:function(){return e()}})})}()},{"../L.TravelNotes":8,"../core/ErrorEditor":31,"./RouteEditor":37}],39:[function(M,e,t){!function(){"use strict";var x=M("../L.TravelNotes"),R=!1;void 0!==e&&e.exports&&(e.exports=function(){function r(e,t){g.clear(),p.clear(),i.elements.forEach(function(e){switch(e.type){case"area":e.tags&&e.tags.boundary&&e.tags.name&&(u=e.tags.name);break;case"way":e.nodesIds=e.nodes,delete e.nodes,g.set(e.id,e);break;case"node":p.set(e.id,e),e.tags&&e.tags.place&&["town","city","village","hamlet"].includes(e.tags.place)&&n.push(e)}}),(m=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttributeNS(null,"viewBox",y/4+" "+y/4+" "+y/2+" "+y/2),m.setAttributeNS(null,"class","TravelNotes-SvgIcon"),function(){var o=Number.MAX_VALUE,n=0;d.itinerary.itineraryPoints.forEach(function(e){var t=s.distanceTo(L.latLng(e.latLng));t<o&&(o=t,v=e,l=n),n+=e.distance}),s=L.latLng(v.latLng);function e(t){var o=!0;return d.wayPoints.forEach(function(e){Math.abs(t.lat-e.lat)<1e-5&&Math.abs(t.lng-e.lng)<1e-5&&(o=!1)}),o&&(v.lat!==t.lat||v.lng!==t.lng)}b=d.itinerary.itineraryPoints.previous(v.objId,e),D=d.itinerary.itineraryPoints.next(v.objId,e)}(),function(){var s=-1,l=-1,d=-1,t=Number.MAX_VALUE,o=Number.MAX_VALUE,n=Number.MAX_VALUE,a=0;p.forEach(function(e){v&&(a=L.latLng(e.lat,e.lon).distanceTo(L.latLng(v.lat,v.lng)))<t&&(s=e.id,t=a),b&&(a=L.latLng(e.lat,e.lon).distanceTo(L.latLng(b.lat,b.lng)))<o&&(l=e.id,o=a),D&&(a=L.latLng(e.lat,e.lon).distanceTo(L.latLng(D.lat,D.lng)))<n&&(d=e.id,n=a)});var c="",u="";g.forEach(function(e){var t=(e.tags.name?e.tags.name:"")+(e.tags.name&&e.tags.ref?" ":"")+(e.tags.ref?"["+e.tags.ref+"]":"");if(e.nodesIds.includes(s)){var o=e.nodesIds[0]===e.nodesIds[e.nodesIds.length-1],n=0!==e.nodesIds.indexOf(s)&&e.nodesIds.length-1!==e.nodesIds.lastIndexOf(s),a=e.nodesIds.includes(l),r=e.nodesIds.includes(d),i=""!=t;!n&&!a&&!r&&i&&C.push(t),(n&&i||o&&i)&&(a||r?(a&&!r||!a&&r)&&C.push(t):(C.push(t),C.push(t))),a&&(c=i?t:"???"),r&&(u=i?t:"???")}}),C.unshift(c),C.push(u)}(),function(){var o=Number.MAX_VALUE;n.forEach(function(e){var t=L.latLng(v.latLng).distanceTo(L.latLng(e.lat,e.lon));t<o&&(o=t,c=e.tags.name)})}(),T=L.point(y/2,y/2).subtract(x.map.project(s,h)),function(){var t=0,o=d.itinerary.itineraryPoints.first,n=d.itinerary.itineraryPoints.last,a=!1;d.itinerary.itineraryPoints.forEach(function(e){E<l-t&&(o=e),E<t-l&&!a&&(n=e,a=!0),t+=e.distance});var e=x.map.project(s,h).add(T);if(v.objId!==d.itinerary.itineraryPoints.first.objId){var r=x.map.project(L.latLng(o.latLng),h).add(T);(N=180*Math.atan((e.y-r.y)/(r.x-e.x))/Math.PI)<0&&(N+=360),N-=270,r.x-e.x<0&&(N+=180)}if(v.objId!==d.itinerary.itineraryPoints.last.objId){var i=x.map.project(L.latLng(n.latLng),h).add(T);for(I=180*Math.atan((e.y-i.y)/(i.x-e.x))/Math.PI,i.x-e.x<0&&(I+=180),I-=N;I<0;)I+=360;for(;360<I;)I-=360}v.objId===d.itinerary.itineraryPoints.first.objId&&(N=-I-90,I=null,f=-1),s.lat===d.itinerary.itineraryPoints.last.lat&&s.lng===d.itinerary.itineraryPoints.last.lng&&(I=null,f=1)}(),function(){var o=-1,n=-1,a=-1,r=[];if(d.itinerary.itineraryPoints.forEach(function(e){o++;var t=x.map.project(L.latLng(e.latLng),h).add(T);r.push(t),0<=t.x&&0<=t.y&&t.x<=y&&t.y<=y&&(-1===n&&(n=o),a=o)}),-1!==n&&-1!==a){0<n&&n--,d.itinerary.itineraryPoints.length-1>a&&a++;var e="";for(o=n;o<=a;o++)e+=r[o].x.toFixed(0)+","+r[o].y.toFixed(0)+" ";var t=document.createElementNS("http://www.w3.org/2000/svg","polyline");t.setAttributeNS(null,"points",e),t.setAttributeNS(null,"class","TravelNotes-OSM-Itinerary"),t.setAttributeNS(null,"transform","rotate("+N+","+y/2+","+y/2+")"),m.appendChild(t)}}(),g.forEach(function(e){var n=-1,a=-1,r=-1,i=[];if(e.nodesIds.forEach(function(e){r++;var t=p.get(e),o=x.map.project(L.latLng(t.lat,t.lon),h).add(T);i.push(o),0<=o.x&&0<=o.y&&o.x<=y&&o.y<=y&&(-1===n&&(n=r),a=r)}),-1!==n&&-1!==a){0<n&&n--,e.nodesIds.length-1>a&&a++;var t="";for(r=n;r<=a;r++)t+=i[r].x.toFixed(0)+","+i[r].y.toFixed(0)+" ";var o=document.createElementNS("http://www.w3.org/2000/svg","polyline");o.setAttributeNS(null,"points",t),o.setAttributeNS(null,"class","TravelNotes-OSM-Highway TravelNotes-OSM-Highway-"+e.tags.highway),o.setAttributeNS(null,"transform","rotate("+N+","+y/2+","+y/2+")"),m.appendChild(o)}})}function o(e,t){var o=new XMLHttpRequest;o.timeout=M("../L.TravelNotes").config.note.svgTimeOut,o.ontimeout=function(e){t("TimeOut error")},o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){try{i=JSON.parse(o.responseText)}catch(e){R=!1,t("Parsing error")}r(),R=!1,e({svg:m,direction:I,startStop:f,city:u,place:c,streets:C,latLng:v.latLng})}else R=!1,t("Status : "+this.status+" statusText : "+this.statusText)};var n=s.lat.toFixed(6)+","+s.lng.toFixed(6),a=M("../L.TravelNotes").config.overpassApiUrl+"?data=[out:json][timeout:"+M("../L.TravelNotes").config.note.svgTimeOut+"];way[highway](around:"+(1.5*y).toFixed(0)+","+n+")->.a;(.a >;.a;)->.a;.a out;is_in("+n+')->.e;area.e[admin_level="2"][name="United Kingdom"]->.f;area.e[admin_level="8"]->.g;area.e[admin_level="10"]->.h;if(f.count(deriveds)==0){.g->.i;}else{if(h.count(deriveds)==0){.g->.i;}else{.h->.i;}}.i out;(node(area.i)[place="village"];node(area.i)[place="hamlet"];node(area.i)[place="city"];node(area.i)[place="town"];)->.k;( node(around:'+M("../L.TravelNotes").config.note.svgHamletDistance+","+n+')[place="hamlet"];node(around:'+M("../L.TravelNotes").config.note.svgVillageDistance+","+n+')[place="village"];node(around:'+M("../L.TravelNotes").config.note.svgCityDistance+","+n+')[place="city"];node(around:'+M("../L.TravelNotes").config.note.svgTownDistance+","+n+')[place="town"];)->.l;node.k.l->.m;.m out;';o.open("GET",a,!0),o.overrideMimeType("application/json"),o.send(null)}var s=L.latLng(0,0),l=0,v=null,d=null,i={},g=new Map,p=new Map,n=[],c=null,u=null,m=null,f=0,T=L.point(0,0),N=0,I=null,y=M("../L.TravelNotes").config.note.svgIconWidth,h=M("../L.TravelNotes").config.note.svgZoom,E=M("../L.TravelNotes").config.note.svgAngleDistance,b=null,D=null,C=[];return Object.seal({getPromiseSvgIcon:function(e,t){return function(e,t){return R?Promise.reject():(R=!0,s=L.latLng(e),d=M("../Data/DataSearchEngine")().getRoute(t),i={},u=m=null,new Promise(o))}(e,t)}})})}()},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8}],40:[function(d,e,t){!function(){"use strict";var s=d("../L.TravelNotes"),r=!1,l=!1;void 0!==e&&e.exports&&(e.exports=function(){function n(e){if(l||(window.addEventListener("unload",function(e){localStorage.removeItem(d("../L.TravelNotes").UUID+"-TravelNotesHTML")}),l=!0),e||r||!s.config.haveBeforeUnloadWarning||(window.addEventListener("beforeunload",function(e){return e.returnValue="x"}),r=!0),d("../util/Utilities")().storageAvailable("localStorage")){var t=d("../UI/HTMLViewsFactory")();t.classNamePrefix="TravelNotes-Roadbook-",localStorage.setItem(s.UUID+"-TravelNotesHTML",t.travelHTML.outerHTML)}}function o(e){var t={};0!==e.itinerary.itineraryPoints.length&&(t=e.itinerary.itineraryPoints[0].objType);var o={latLngs:[],distances:[],objIds:[],objType:t};e.itinerary.itineraryPoints.forEach(function(e){o.latLngs.push([e.lat,e.lng]),o.distances.push(e.distance),o.objIds.push(e.objId)}),o.latLngs=d("@mapbox/polyline").encode(o.latLngs,6),e.itinerary.itineraryPoints=o}function e(){return!r||window.confirm(i.getText("TravelEditor - This page ask to close; data are perhaps not saved."))}var i=d("../UI/Translator")(),a=d("../UI/TravelEditorUI")(),t=function(e){if(2!==s.travel.editedRoute.edited){-1!==s.editedRouteObjId&&d("../core/RouteEditor")().cancelEdition();var t=d("../data/DataSearchEngine")().getRoute(e),o=t.itinerary.provider;if(!o||""===o||s.providers.get(o.toLowerCase())){o&&""!==o&&(d("../UI/ProvidersToolbarUI")().provider=o);var n=t.itinerary.transitMode;n&&""!==n&&(d("../UI/ProvidersToolbarUI")().transitMode=n),s.travel.editedRoute=d("../data/Route")(),t.edited=1,s.travel.editedRoute.object=t.object,s.editedRouteObjId=t.objId,s.travel.editedRoute.hidden=!1,t.hidden=!1;var a=d("../core/MapEditor")();a.removeRoute(t,!0,!1),a.addRoute(s.travel.editedRoute,!0,!0),d("../core/RouteEditor")().chainRoutes();var r=d("../UI/RouteEditorUI")();r.expand(),r.setWayPointsList(),d("../UI/DataPanesUI")().setItinerary()}else d("../core/ErrorEditor")().showError(i.getText("RouteEditor - Not possible to edit a route created with this provider",{provider:o}))}else d("../core/ErrorEditor")().showError(i.getText("RouteEditor - Not possible to edit a route without a save or cancel"))};return Object.seal({updateRoadBook:function(e){n(e)},addRoute:function(){!function(){var e=d("../Data/Route")();s.travel.routes.add(e),a.setRoutesList(),d("../core/RouteEditor")().chainRoutes(),n(),2!==s.travel.editedRoute.edited&&t(e.objId)}()},removeRoute:function(e){!function(e){e!==s.editedRouteObjId||2!==s.travel.editedRoute.edited?(d("./MapEditor")().removeRoute(d("../Data/DataSearchEngine")().getRoute(e),!0,!0),s.travel.routes.remove(e),a.setRoutesList(),e===s.editedRouteObjId&&d("./RouteEditor")().cancelEdition(),d("../core/RouteEditor")().chainRoutes(),n()):d("./ErrorEditor")().showError(i.getText("TravelEditor - Cannot remove an edited route"))}(e)},editRoute:function(e){t(e)},renameRoute:function(e,t){!function(e,t){d("../Data/DataSearchEngine")().getRoute(e).name=t,a.setRoutesList(),e===s.editedRouteObjId&&(s.travel.editedRoute.name=t),n()}(e,t)},swapRoute:function(e,t){!function(e,t){s.travel.routes.swap(e,t),a.setRoutesList(),d("../core/RouteEditor")().chainRoutes(),n()}(e,t)},routeDropped:function(e,t,o){!function(e,t,o){s.travel.routes.moveTo(e,t,o),a.setRoutesList(),d("../core/RouteEditor")().chainRoutes(),n()}(e,t,o)},saveTravel:function(){!function(){for(var e=s.travel.routes.iterator;!e.done;)e.value.hidden=!1;var t=s.travel.object;t.routes.forEach(o),o(t.editedRoute),d("../util/Utilities")().saveFile(t.name+".trv",JSON.stringify(t))}()},confirmClose:function(){return e()},clear:function(){e()&&(d("../core/MapEditor")().removeAllObjects(),s.travel.editedRoute=d("../Data/Route")(),s.editedRouteObjId=-1,s.travel=d("../Data/Travel")(),s.travel.routes.add(d("../Data/Route")()),d("../UI/TravelEditorUI")().setRoutesList(),d("../UI/RouteEditorUI")().setWayPointsList(),d("../UI/DataPanesUI")().setItinerary(),n(!0))}})})}()},{"../Data/DataSearchEngine":3,"../Data/Route":5,"../Data/Travel":6,"../L.TravelNotes":8,"../UI/DataPanesUI":14,"../UI/HTMLViewsFactory":17,"../UI/ProvidersToolbarUI":21,"../UI/RouteEditorUI":22,"../UI/Translator":26,"../UI/TravelEditorUI":27,"../core/ErrorEditor":31,"../core/MapEditor":34,"../core/RouteEditor":37,"../data/DataSearchEngine":45,"../data/Route":52,"../util/Utilities":58,"./ErrorEditor":31,"./MapEditor":34,"./RouteEditor":37,"@mapbox/polyline":1}],41:[function(d,e,t){!function(){"use strict";var l=d("../L.TravelNotes");void 0!==e&&e.exports&&(e.exports=function(){function n(e,t){l.travel.editedRoute.edited=2;var o=d("../data/Waypoint.js")();if(e&&(o.latLng=e,l.config.wayPoint.reverseGeocoding&&d("../core/GeoCoder")().getPromiseAddress(e[0],e[1],o.objId).then(s)),l.travel.editedRoute.wayPoints.add(o),a.addWayPoint(l.travel.editedRoute.wayPoints.last,l.travel.editedRoute.wayPoints.length-2),t)for(var n=l.travel.editedRoute.wayPoints.iterator;!n.done;){if(t<r.getClosestLatLngDistance(l.travel.editedRoute,n.value.latLng).distance){l.travel.editedRoute.wayPoints.moveTo(o.objId,n.value.objId,!0);break}}else l.travel.editedRoute.wayPoints.swap(o.objId,!0);i.setWayPointsList(),r.startRouting()}function o(e,t){l.travel.editedRoute.edited=2,l.travel.editedRoute.wayPoints.getAt(t).name=e,i.setWayPointsList()}var a=d("../core/MapEditor")(),r=d("../core/RouteEditor")(),i=d("../UI/RouteEditorUI")(),s=function(e){var t="";e.address.house_number&&(t+=e.address.house_number+" "),e.address.road?t+=e.address.road+" ":e.address.pedestrian&&(t+=e.address.pedestrian+" "),e.address.village?t+=e.address.village:e.address.town?t+=e.address.town:e.address.city&&(t+=e.address.city),0===t.length&&(t+=e.address.country),o(t,e.objId)};return Object.seal({addWayPoint:function(e){n(e)},addWayPointOnRoute:function(e,t){!function(e,t){var o=r.getClosestLatLngDistance(d("../Data/DataSearchEngine")().getRoute(e),[t.latlng.lat,t.latlng.lng]);n(o.latLng,o.distance)}(e,t)},reverseWayPoints:function(){!function(){l.travel.editedRoute.edited=2;for(var e=l.travel.editedRoute.wayPoints.iterator;!e.done;)a.removeObject(e.value.objId);for(l.travel.editedRoute.wayPoints.reverse(),e=l.travel.editedRoute.wayPoints.iterator;!e.done;)a.addWayPoint(e.value,e.first?"A":e.last?"B":e.index);i.setWayPointsList(),r.startRouting()}()},removeAllWayPoints:function(){!function(){l.travel.editedRoute.edited=2;for(var e=l.travel.editedRoute.wayPoints.iterator;!e.done;)a.removeObject(e.value.objId);l.travel.editedRoute.wayPoints.removeAll(!0),i.setWayPointsList(),r.startRouting()}()},removeWayPoint:function(e){!function(e){l.travel.editedRoute.edited=2,a.removeObject(e),l.travel.editedRoute.wayPoints.remove(e),i.setWayPointsList(),r.startRouting()}(e)},renameWayPoint:function(e,t){o(e,t)},swapWayPoints:function(e,t){!function(e,t){l.travel.editedRoute.edited=2,l.travel.editedRoute.wayPoints.swap(e,t),i.setWayPointsList(),r.startRouting()}(e,t)},setStartPoint:function(e){!function(e){l.travel.editedRoute.edited=2,0!==l.travel.editedRoute.wayPoints.first.lat&&a.removeObject(l.travel.editedRoute.wayPoints.first.objId),l.travel.editedRoute.wayPoints.first.latLng=e,l.config.wayPoint.reverseGeocoding&&d("../core/GeoCoder")().getPromiseAddress(e[0],e[1],l.travel.editedRoute.wayPoints.first.objId).then(s),a.addWayPoint(l.travel.editedRoute.wayPoints.first,"A"),i.setWayPointsList(),r.startRouting()}(e)},setEndPoint:function(e){!function(e){l.travel.editedRoute.edited=2,0!==l.travel.editedRoute.wayPoints.last.lat&&a.removeObject(l.travel.editedRoute.wayPoints.last.objId),l.travel.editedRoute.wayPoints.last.latLng=e,l.config.wayPoint.reverseGeocoding&&d("../core/GeoCoder")().getPromiseAddress(e[0],e[1],l.travel.editedRoute.wayPoints.last.objId).then(s),a.addWayPoint(l.travel.editedRoute.wayPoints.last,"B"),i.setWayPointsList(),r.startRouting()}(e)},wayPointDragEnd:function(e){!function(e){if(l.travel.editedRoute.edited=2,l.config.wayPoint.reverseGeocoding){var t=l.travel.editedRoute.wayPoints.getAt(e).latLng;d("../core/GeoCoder")().getPromiseAddress(t[0],t[1],e).then(s)}i.setWayPointsList(),r.startRouting()}(e)},wayPointDropped:function(e,t,o){!function(e,t,o){if(l.travel.editedRoute.edited=2,(t!==l.travel.editedRoute.wayPoints.first.objId||!o)&&(t!==l.travel.editedRoute.wayPoints.last.objId||o)){l.travel.editedRoute.wayPoints.moveTo(e,t,o),i.setWayPointsList();for(var n=l.travel.editedRoute.wayPoints.iterator;!n.done;)a.removeObject(n.value.objId),a.addWayPoint(n.value,n.first?"A":n.last?"B":n.index);r.startRouting()}}(e,t,o)}})})}()},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/RouteEditorUI":22,"../core/GeoCoder":33,"../core/MapEditor":34,"../core/RouteEditor":37,"../data/Waypoint.js":57}],42:[function(e,t,o){arguments[4][41][0].apply(o,arguments)},{"../Data/DataSearchEngine":3,"../L.TravelNotes":8,"../UI/RouteEditorUI":22,"../core/GeoCoder":33,"../core/MapEditor":34,"../core/RouteEditor":37,"../data/Waypoint.js":57,dup:41}],43:[function(l,e,t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(e){function o(e){if(!e.objType||!e.objType.name||e.objType.name!==a)throw"invalid object name for add function";r.push(e)}function n(e,t,o){var n=i(e);if(-1===n)throw"invalid objId for next or previous function";for(t=t||function(){return!0},n+=o;-1<n&&n<r.length&&!t(r[n]);)n+=o;return-1===n||r.length===n?null:r[n]}var r=[],a=e,i=function(t){return r.findIndex(function(e){return e.objId===t})},s=function(){var e=-1;return{get value(){return e<r.length?r[e]:null},get done(){return++e>=r.length},get first(){return 0===e},get last(){return e>=r.length-1},get index(){return e}}};return Object.seal({add:function(e){o(e)},forEach:function(e){return function(e){for(var t=null,o=s();!o.done;)t=e(o.value,t);return t}(e)},getAt:function(e){return function(e){var t=i(e);return-1===t?null:r[t]}(e)},moveTo:function(e,t,o){!function(e,t,o){var n=i(e),a=i(t);o||a++,r.splice(a,0,r[n]),a<n&&n++,r.splice(n,1)}(e,t,o)},next:function(e,t){return n(e,t,1)},previous:function(e,t){return n(e,t,-1)},remove:function(e){!function(e){if(-1===i(e))throw"invalid objId for remove function";r.splice(i(e),1)}(e)},removeAll:function(e){!function(e){e?r.splice(1,r.length-2):r.length=0}(e)},replace:function(e,t){!function(e,t){var o=i(e);if(-1===o)throw"invalid objId for replace function";r[o]=t}(e,t)},reverse:function(){r.reverse()},sort:function(e){!function(e){r.sort(e)}(e)},swap:function(e,t){!function(e,t){var o=i(e);if(-1===o||0===o&&t||r.length-1===o&&!t)throw"invalid objId for swap function";var n=r[o];r[o]=r[o+(t?-1:1)],r[o+(t?-1:1)]=n}(e,t)},get first(){return r[0]},get iterator(){return s()},get last(){return r[r.length-1]},get length(){return r.length},get object(){return function(){for(var e=[],t=s();!t.done;)e.push(t.value.object);return e}()},set object(e){!function(e){var t;r.length=0,e.forEach(function(e){switch(a){case"Route":t=l("../data/Route")();break;case"Note":t=l("../data/Note")();break;case"WayPoint":t=l("../data/WayPoint")();break;case"Maneuver":t=l("../data/Maneuver")();break;case"ItineraryPoint":t=l("../data/ItineraryPoint")();break;default:throw"invalid ObjName ( "+a+" ) in Collection.m_SetObject"}t.object=e,o(t)})}(e)}})})}()},{"../data/ItineraryPoint":47,"../data/Maneuver":48,"../data/Note":49,"../data/Route":52,"../data/WayPoint":56}],44:[function(e,a,t){!function(){"use strict";var t,n,o;void 0!==a&&a.exports&&(a.exports=(t={contextMenu:{timeout:1500},errorMessages:{timeout:2e4},routing:{auto:!0},language:"fr",itineraryPointMarker:{color:"red",weight:2,radius:7,fill:!1},searchPointMarker:{color:"green",weight:4,radius:20,fill:!1},searchPointPolyline:{color:"green",weight:4,radius:20,fill:!1},previousSearchLimit:{color:"green",fill:!1,weight:1},nextSearchLimit:{color:"red",fill:!1,weight:1},wayPoint:{reverseGeocoding:!1},route:{color:"#ff0000",width:3,dashArray:0,dashChoices:[{text:"",iDashArray:null},{text:"    ",iDashArray:[4,2]},{text:"",iDashArray:[4,2,0,2]},{text:"",iDashArray:[0,2]}]},note:{reverseGeocoding:!1,grip:{size:10,opacity:0},polyline:{color:"gray",weight:1},style:"TravelNotes-NotesStyle",svgIconWidth:200,svgAnleMaxDirection:{right:35,slightRight:80,continue:100,slightLeft:145,left:200,sharpLeft:270,sharpRight:340},svgZoom:17,svgAngleDistance:10,svgHamletDistance:200,svgVillageDistance:400,svgCityDistance:1200,svgTownDistance:1500,svgTimeOut:15e3,cityPrefix:"<span class='TravelNotes-NoteHtml-Address-City'>",cityPostfix:"</span>"},itineraryPointZoom:17,routeEditor:{displayEditionInHTMLPage:!0},travelEditor:{clearAfterSave:!0,startMinimized:!0,timeout:1e3,startupRouteEdition:!0},haveBeforeUnloadWarning:!0,overpassApiUrl:"https://lz4.overpass-api.de/api/interpreter",nominatim:{url:"https://nominatim.openstreetmap.org/",language:"*"}},n=function(e,t){if("object"==typeof e&&"object"==typeof t)try{var o;for(o in t)"object"==typeof t[o]?n(e[o],t[o]):t[o]=e[o]||t[o];for(o in e)"object"==typeof e[o]?("[object Array]"==Object.prototype.toString.call(e[o])?t[o]=t[o]||[]:t[o]=t[o]||{},n(e[o],t[o])):t[o]=e[o]}catch(e){console.log(e),console.log("Not possible to overload Config")}},o=function(e){var t;for(t in e)"object"==typeof e[t]&&(e[t]=o(e[t]));return Object.freeze(e)},{get contextMenu(){return t.contextMenu},get errorMessages(){return t.errorMessages},get routing(){return t.routing},get language(){return t.language},get itineraryPointMarker(){return t.itineraryPointMarker},get searchPointMarker(){return t.searchPointMarker},get searchPointPolyline(){return t.searchPointPolyline},get previousSearchLimit(){return t.previousSearchLimit},get nextSearchLimit(){return t.nextSearchLimit},get wayPoint(){return t.wayPoint},get route(){return t.route},get note(){return t.note},get itineraryPointZoom(){return t.itineraryPointZoom},get routeEditor(){return t.routeEditor},get travelEditor(){return t.travelEditor},get haveBeforeUnloadWarning(){return t.haveBeforeUnloadWarning},get overpassApiUrl(){return t.overpassApiUrl},get nominatim(){return t.nominatim},overload:function(e){!function(e){n(e,t),t=o(t)}(e)}}))}()},{}],45:[function(e,t,o){arguments[4][3][0].apply(o,arguments)},{"../L.TravelNotes":8,dup:3}],46:[function(e,t,o){arguments[4][4][0].apply(o,arguments)},{"../data/Collection":43,"../data/ObjId":50,"../data/ObjType":51,"./Version":55,dup:4}],47:[function(i,e,t){!function(){"use strict";var r=i("../data/ObjType")("ItineraryPoint",i("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var t=0,o=0,n=0,a=i("../data/ObjId")();return Object.seal({get lat(){return t},set lat(e){t=e},get lng(){return o},set lng(e){o=e},get latLng(){return[t,o]},set latLng(e){t=e[0],o=e[1]},get distance(){return n},set distance(e){n=e},get objId(){return a},get objType(){return r},get object(){return{lat:parseFloat(t.toFixed(6)),lng:parseFloat(o.toFixed(6)),distance:parseFloat(n.toFixed(2)),objId:a,objType:r.object}},set object(e){!function(e){e=r.validate(e),t=e.lat||0,o=e.lng||0,n=e.distance||0,a=i("../data/ObjId")()}(e)}})})}()},{"../data/ObjId":50,"../data/ObjType":51,"./Version":55}],48:[function(l,e,t){!function(){"use strict";var s=l("../data/ObjType")("Maneuver",l("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var t=l("../data/ObjId")(),o="",n="",a=-1,r=0,i=0;return Object.seal({get iconName(){return o},set iconName(e){o=e},get instruction(){return n},set instruction(e){n=e},get itineraryPointObjId(){return a},set itineraryPointObjId(e){a=e},get distance(){return r},set distance(e){r=e},get duration(){return i},set duration(e){i=e},get objId(){return t},get objType(){return s},get object(){return{iconName:o,instruction:n,distance:parseFloat(r.toFixed(2)),duration:i,itineraryPointObjId:a,objId:t,objType:s.object}},set object(e){!function(e){e=s.validate(e),o=e.iconName||"",n=e.instruction||"",r=e.distance||0,i=e.duration||0,a=e.itineraryPointObjId||-1,t=l("../data/ObjId")()}(e)}})})}()},{"../data/ObjId":50,"../data/ObjType":51,"./Version":55}],49:[function(T,e,t){!function(){"use strict";var f=T("../data/ObjType")("Note",T("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var t=T("../data/ObjId")(),o=40,n=40,a="",r="",i="",s="",l="",d="",c=0,u=0,v=0,g=0,p=-1,m=0;return Object.seal({get isRouteNote(){return-1!==p},get iconHeight(){return o},set iconHeight(e){o=e},get iconWidth(){return n},set iconWidth(e){n=e},get iconContent(){return a},set iconContent(e){a=e},get popupContent(){return r},set popupContent(e){r=e},get tooltipContent(){return i},set tooltipContent(e){i=e},get phone(){return s},set phone(e){s=e},get url(){return l},set url(e){l=e},get address(){return d},set address(e){d=e},get iconLat(){return c},set iconLat(e){c=e},get iconLng(){return u},set iconLng(e){u=e},get iconLatLng(){return[c,u]},set iconLatLng(e){c=e[0],u=e[1]},get lat(){return v},set lat(e){v=e},get lng(){return g},set lng(e){g=e},get latLng(){return[v,g]},set latLng(e){v=e[0],g=e[1]},get distance(){return p},set distance(e){p=e},get chainedDistance(){return m},set chainedDistance(e){m=e},get objId(){return t},get objType(){return f},get object(){return{iconHeight:o,iconWidth:n,iconContent:a,popupContent:r,tooltipContent:i,phone:s,url:l,address:d,iconLat:parseFloat(c.toFixed(6)),iconLng:parseFloat(u.toFixed(6)),lat:parseFloat(v.toFixed(6)),lng:parseFloat(g.toFixed(6)),distance:parseFloat(p.toFixed(2)),chainedDistance:parseFloat(m.toFixed(2)),objId:t,objType:f.object}},set object(e){!function(e){e=f.validate(e),o=e.iconHeight||40,n=e.iconWidth||40,a=e.iconContent||"",r=e.popupContent||"",i=e.tooltipContent||"",s=e.phone||"",l=e.url||"",d=e.address||"",c=e.iconLat||0,u=e.iconLng||0,v=e.lat||0,g=e.lng||0,p=e.distance||-1,m=e.chainedDistance,t=T("../data/ObjId")()}(e)}})})}()},{"../data/ObjId":50,"../data/ObjType":51,"./Version":55}],50:[function(e,t,o){(function(e){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){return e.TravelNotesObjId||(e.TravelNotesObjId=0),++e.TravelNotesObjId})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],51:[function(a,e,t){!function(){"use strict";void 0!==e&&e.exports&&(e.exports=function(e,t){var o=e,n=t;return Object.seal({get name(){return o},get version(){return n},get object(){return{name:o,version:n}},validate:function(e){return function(e){if(!e.objType)throw"No objType for "+o;if(!e.objType.name)throw"No name for "+o;if(o!==e.objType.name)throw"Invalid name for "+o;if(!e.objType.version)throw"No version for "+o;if(n!==e.objType.version&&("1.0.0"===e.objType.version&&("Route"===e.objType.name&&(e.dashArray=0,e.hidden=!1),e.objType.version="1.1.0"),"1.1.0"===e.objType.version&&(e.objType.version="1.2.0"),"1.2.0"===e.objType.version&&(e.objType.version="1.3.0"),"1.3.0"===e.objType.version&&(e.objType.version="1.4.0"),"1.4.0"===e.objType.version&&("Route"===e.objType.name&&(e.edited=0),"Travel"===e.objType.name&&(e.editedRoute=a("../data/Route")()),e.objType.version="1.5.0"),n!==e.objType.version))throw"invalid version for "+o;if(!e.objId)throw"No objId for "+o;return e}(e)}})})}()},{"../data/Route":52}],52:[function(e,t,o){arguments[4][5][0].apply(o,arguments)},{"../L.TravelNotes":8,"../data/Collection":43,"../data/Itinerary":46,"../data/ObjId":50,"../data/ObjType":51,"../data/Waypoint":57,"./Itinerary":46,"./Version":55,dup:5}],53:[function(e,t,o){arguments[4][6][0].apply(o,arguments)},{"../data/Collection":43,"../data/ObjId":50,"../data/ObjType":51,"../data/Route":52,"./Version":55,dup:6}],54:[function(e,t,o){!function(){"use strict";void 0!==t&&t.exports&&(t.exports=function(){var t={config:e("../data/Config"),map:null,providers:new Map,mapObjects:new Map,travel:e("../data/Travel")(),editedRouteObjId:-1,routing:Object.seal({provider:"",transitMode:""}),searchData:[],UUID:e("../util/Utilities")().UUID};return Object.seal({get config(){return t.config},set config(e){t.config.overload(e)},get map(){return t.map},set map(e){t.map=e},get providers(){return t.providers},get mapObjects(){return t.mapObjects},get travel(){return t.travel},set travel(e){t.travel=e},get editedRouteObjId(){return t.editedRouteObjId},set editedRouteObjId(e){t.editedRouteObjId=e},get routeEdition(){return t.routeEdition},get routing(){return t.routing},get searchData(){return t.searchData},set searchData(e){t.searchData=e},get UUID(){return t.UUID}})})}()},{"../data/Config":44,"../data/Travel":53,"../util/Utilities":58}],55:[function(e,t,o){arguments[4][7][0].apply(o,arguments)},{dup:7}],56:[function(i,e,t){!function(){"use strict";var r=i("../data/ObjType")("WayPoint",i("./Version"));void 0!==e&&e.exports&&(e.exports=function(){var t="",o=0,n=0,a=i("../data/ObjId")();return Object.seal({get name(){return t},set name(e){t=e},get UIName(){return""!==t?t:0!==o&&0!==n?o.toFixed(6)+(0<o?" N - ":" S - ")+n.toFixed(6)+(0<n?" E":" W"):""},get lat(){return o},set lat(e){o=e},get lng(){return n},set lng(e){n=e},get latLng(){return[o,n]},set latLng(e){o=e[0],n=e[1]},get objId(){return a},get objType(){return r},get object(){return{name:t,lat:parseFloat(o.toFixed(6)),lng:parseFloat(n.toFixed(6)),objId:a,objType:r.object}},set object(e){!function(e){e=r.validate(e),t=e.name||"",o=e.lat||0,n=e.lng||0,a=i("../data/ObjId")()}(e)}})})}()},{"../data/ObjId":50,"../data/ObjType":51,"./Version":55}],57:[function(e,t,o){arguments[4][56][0].apply(o,arguments)},{"../data/ObjId":50,"../data/ObjType":51,"./Version":55,dup:56}],58:[function(e,t,o){!function(){"use strict";var r=e("../UI/Translator")();void 0!==t&&t.exports&&(t.exports=function(){return{get UUID(){return function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}()},storageAvailable:function(e){try{var t=window[e],o="__storage_test__";return t.setItem(o,o),t.removeItem(o),!0}catch(e){return!1}},fileAPIAvailable:function(){try{new File(["testdata"],{type:"text/plain"});return!0}catch(e){return!!window.navigator.msSaveOrOpenBlob}},saveFile:function(e,t,o){if(o=o||"text/plain",window.navigator.msSaveOrOpenBlob)try{window.navigator.msSaveOrOpenBlob(new Blob([t]),e)}catch(e){}else try{var n=window.URL.createObjectURL(new File([t],{type:o})),a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",e),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(n)}catch(e){}},formatTime:function(e){if(0===(e=Math.floor(e)))return"";var t=Math.floor(e/86400),o=Math.floor(e%86400/3600),n=Math.floor(e%3600/60),a=Math.floor(e%60);return 0<t?t+"&nbsp;"+r.getText("Utilities - Day")+"&nbsp;"+o+"&nbsp;"+r.getText("Utilities - Hour"):0<o?o+"&nbsp;"+r.getText("Utilities - Hour")+"&nbsp;"+n+"&nbsp;"+r.getText("Utilities - Minute"):0<n?n+"&nbsp;"+r.getText("Utilities - Minute"):a+"&nbsp;"+r.getText("Utilities - Second")},formatDistance:function(e){return 0===(e=Math.floor(e))?"":Math.floor(e/1e3)+","+Math.floor(e%1e3/10).toFixed(0).padStart(2,"0").padEnd(3,"0")+"&nbsp;km"},formatLat:function(e){return 0<e?e.toFixed(6)+"&nbsp;N":(-e).toFixed(6)+"&nbsp;S"},formatLng:function(e){return 0<e?e.toFixed(6)+"&nbsp;E":(-e).toFixed(6)+"&nbsp;W"},formatLatLng:function(e){return this.formatLat(e[0])+"&nbsp;-&nbsp;"+this.formatLng(e[1])}}})}()},{"../UI/Translator":26}]},{},[8]);