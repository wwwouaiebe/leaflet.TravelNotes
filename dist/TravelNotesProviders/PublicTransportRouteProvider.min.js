/**
 * 
 * @source: https://github.com/wwwouaiebe/leaflet.TravelNotes
 * 
 * @licstart  The following is the entire license notice for the
 * JavaScript code in this page.
 * 
 * leaflet.travelnotes - version 2.1.0
 * Build 00427 - 2021-01-22T11:39:48+0100 
 * Copyright 2017 2021 wwwouaiebe 
 * Contact: https://www.ouaie.be/
 * License: GPL-3.0
 * 
 * The JavaScript code in this page is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 * 
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 * 
 * @licend  The above is the entire license notice
 * for the JavaScript code in this page.
 * 
 */


!function(){"use strict";
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Constants.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/Object.freeze({fixed:2,invalid:-1,defaultValue:0}),Object.freeze({refusedByUser:-1,disabled:0,inactive:1,active:2}),Object.freeze({invalidPane:"43a6a53e-008a-4910-80a6-7a87d301ea15",itineraryPane:"8fbf0da7-4e6f-4bc7-8e20-1388461ccde7",travelNotesPane:"dffe782b-07df-4b81-a318-f287c0cf5ec6",searchPane:"228f00d7-43a8-4c13-897d-70400cb6dd58"}),Object.freeze({fixed:2,defaultValue:0});const e=Object.freeze({defaultValue:0,fixed:6}),t=(Object.freeze({notEdited:0,editedNoChange:1,editedChanged:2}),Object.freeze({margin:100,height:500,width:1e3,yDeltaText:30,xDeltaText:10,vScales:[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3],hScales:[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5]}),Object.freeze({width:40,height:40,svgViewboxDim:200}),Math.PI/180);function n(e){return(e+540)%360-180}const s=Object.freeze(new class{arcFromSummitArcArc(e,t,n){return Math.acos(Math.cos(t)*Math.cos(n)+Math.sin(t)*Math.sin(n)*Math.cos(e))}summitFromArcArcArc(e,t,n){return Math.acos((Math.cos(n)-Math.cos(e)*Math.cos(t))/(Math.sin(e)*Math.sin(t)))}pointsDistance(e,s){if(e[0]===s[0]&&e[1]===s[1])return 0;let a=e[0]*t,i=s[0]*t,d=(n(s[1])-n(e[1]))*t;return 6371e3*Math.acos(Math.sin(a)*Math.sin(i)+Math.cos(a)*Math.cos(i)*Math.cos(d))}});window.TaN.addProvider(function(){let t="fr",n=null,a=-1,i=new Map,d=new Map,r=new Map,o=-1,l=0,c=[];function u(e){return e[0]}function g(e){return e[e.length-1]}function h(e,t){e.splice(e.indexOf(t),1)}function f(e){let t=d.get(u(e.nodesIds)),n=d.get(g(e.nodesIds));h(t.startingWaysIds,e.id),t.endingWaysIds.push(e.id),h(n.endingWaysIds,e.id),n.startingWaysIds.push(e.id),e.nodesIds.reverse()}function y(e,t){let n=i.get(e),s=i.get(t);g(n.nodesIds)===g(s.nodesIds)?f(s):u(n.nodesIds)===u(s.nodesIds)?f(n):u(n.nodesIds)===g(s.nodesIds)&&(f(n),f(s));let a=d.get(n.nodesIds.pop());a.startingWaysIds=[],a.endingWaysIds=[],n.nodesIds=n.nodesIds.concat(s.nodesIds),n.distance+=s.distance;let r=d.get(g(n.nodesIds));return h(r.endingWaysIds,s.id),r.endingWaysIds.push(n.id),i.delete(s.id),n.id}function p(e){let t=i.get(e),n={id:o--,type:"way",nodesIds:[],distance:t.distance};return t.nodesIds.forEach(e=>n.nodesIds.push(function(e){let t=d.get(e),n={id:o--,lat:t.lat,lon:t.lon,type:"node",startingWaysIds:[],endingWaysIds:[],isNode3Ways:t.isNode3Ways};return d.set(n.id,n),n.id}(e))),d.get(u(n.nodesIds)).startingWaysIds.push(n.id),d.get(g(n.nodesIds)).endingWaysIds.push(n.id),i.set(n.id,n),n.id}function I(e,t,f){var I;o=-1,c=[],l=0,I=e.elements,i.clear(),d.clear(),r.clear(),I.forEach(e=>{switch(e.type){case"way":e.nodesIds=e.nodes,delete e.nodes,2<=e.nodesIds.length&&(e.distance=0,i.set(e.id,e));break;case"node":e.startingWaysIds=[],e.endingWaysIds=[],e.isNode3Ways=!1,d.set(e.id,e);break;case"relation":e.members.forEach(e=>{"node"===e.type&&e.role&&"stop"===e.role&&r.set(e.ref,e.ref)})}}),r.forEach(e=>{let t=d.get(e);t?r.set(e,t):(window.TaN.showInfo("the relation "+a+" have nodes not positionned on the railway ( node "+e+")."),r.delete(e))}),i.forEach(e=>{d.get(u(e.nodesIds)).startingWaysIds.push(e.id),d.get(g(e.nodesIds)).endingWaysIds.push(e.id);let t=null;e.nodesIds.forEach(n=>{let a=d.get(n);t&&(e.distance+=s.pointsDistance([a.lat,a.lon],[t.lat,t.lon])),t=a})});let A=!1;d.forEach(e=>{let t=e.startingWaysIds.concat(e.endingWaysIds);switch(t.length){case 0:case 1:break;case 2:y(t[0],t[1]);break;case 3:e.isNode3Ways=!0,c.push(e),l++;break;default:A=!0,window.TaN.showInfo("A node with more than 3 ways is found : "+e.id+" - the relation "+a+" - ways "+e.startingWaysIds.concat(e.endingWaysIds))}}),A&&f(new Error("A node with more than 3 ways was found in the relation.See the console for more infos")),i.size>2*l+1&&(!function e(){let t=[];function n(e,n){e.isNode3Ways||n.isNode3Ways||t.push({distance:s.pointsDistance([e.lat,e.lon],[n.lat,n.lon]),nodesId:[e.id,n.id]})}let a=Array.from(i.values()),r=1;a.forEach(e=>{for(let t=r;t<a.length;t++){let s=[];s.push(d.get(u(e.nodesIds))),s.push(d.get(g(e.nodesIds))),s.push(d.get(u(a[t].nodesIds))),s.push(d.get(g(a[t].nodesIds))),n(s[0],s[2]),n(s[0],s[3]),n(s[1],s[2]),n(s[1],s[3])}r++});let c=t[0];t.forEach(e=>{e.distance<c.distance&&(c=e)});let h={id:o--,type:"way",nodesIds:c.nodesId,distance:c.distance};i.set(h.id,h);let f=d.get(c.nodesId[0]),p=f.startingWaysIds.concat(f.endingWaysIds)[0];f.startingWaysIds.push(h.id);let I=d.get(c.nodesId[1]),A=I.startingWaysIds.concat(I.endingWaysIds)[0];I.endingWaysIds.push(h.id),y(y(h.id,p),A),i.size>2*l+1&&e()}(),window.TaN.showInfo("Holes found in the OSM relation number "+a+". Try to correct OSM data.")),0<l&&c.forEach(e=>{let t=Number.MAX_VALUE,n=null,s=e.startingWaysIds.concat(e.endingWaysIds);s.forEach(e=>{let s=i.get(e);s.distance<t&&(t=s.distance,n=s)}),h(s,n.id);let a=i.get(p(n.id)),d=null;u(n.nodesIds)===e.id?(a.nodesIds.pop(),a.nodesIds.push(g(n.nodesIds)),d=u(a.nodesIds)):(a.nodesIds.shift(),a.nodesIds.unshift(u(n.nodesIds)),d=g(a.nodesIds));let r=i.get(s[1]);r.nodesIds[r.nodesIds.indexOf(e.id)]=d,y(y(y(n.id,a.id),s[0]),r.id)}),function(e){let t=null,a=null,o=Number.MAX_VALUE,l=Number.MAX_VALUE;r.forEach(e=>{let i=s.pointsDistance([e.lat,e.lon],n.wayPoints.first.latLng);i<o&&(o=i,t=e),i=s.pointsDistance([e.lat,e.lon],n.wayPoints.last.latLng),i<l&&(l=i,a=e)}),e.itinerary.itineraryPoints.removeAll(),e.itinerary.maneuvers.removeAll(),e.itinerary.hasProfile=!1,e.itinerary.ascent=0,e.itinerary.descent=0;let c=0,u=!1;Array.from(i.values())[0].nodesIds.forEach(n=>{if(0!==c||n!==t.id&&n!==a.id?2!==c||n!==t.id&&n!==a.id||(c=3):(c=1,u=n===a.id),0<c&&4>c){let s=window.TaN.itineraryPoint,i=d.get(n);s.latLng=[i.lat,i.lon],e.itinerary.itineraryPoints.add(s);let o=r.get(n);if(o){let n=window.TaN.maneuver,i=null;o.tags&&o.tags.name&&(i=o.tags.name,n.instruction=i+"&nbsp;:&nbsp;"),o.id===t.id?(i&&(e.wayPoints.first.name=i),n.iconName="kTrainStart",n.instruction+="Monter dans le train"):o.id===a.id?(i&&(e.wayPoints.last.name=i),n.iconName="kTrainEnd",n.instruction+="Descendre du train"):(n.iconName="kTrainContinue",n.instruction+="Rester dans le train"),n.distance=0,n.duration=0,n.itineraryPointObjId=s.objId,e.itinerary.maneuvers.add(n)}}1===c&&(c=2),3===c&&(c=4)}),u&&(e.itinerary.itineraryPoints.reverse(),e.itinerary.maneuvers.reverse()),e.distance=0;let g=e.itinerary.maneuvers.iterator;g.done;let h=g.value;g.done;let f=e.itinerary.itineraryPoints.iterator;f.done;let y=f.value;for(;!f.done;)f.value.distance=0,y.distance=s.pointsDistance(y.latLng,f.value.latLng),e.distance+=y.distance,h.distance+=y.distance,g.value.itineraryPointObjId===f.value.objId&&(h=g.value,h.distance=0,g.done),y=f.value}(n),t(n)}function A(e,t){return new Promise((function(n,s){let a=new XMLHttpRequest;a.timeout=15e3,a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status){let e=null;try{e=JSON.parse(a.responseText),n(e)}catch(e){s(new Error("JSON parsing error. File : "+a.responseURL))}}else 400<=a.status?s(new Error("Error HTTP "+a.status+" "+a.statusText)):s(new Error("Error XMLHttpRequest - File : "+a.responseURL))},a.open("GET",e,!0),t&&t.forEach(e=>a.setRequestHeader(e.headerName,e.headerValue)),a.overrideMimeType("application/json"),a.send(null)}))}function m(t,s){A('https://lz4.overpass-api.de/api/interpreter?data=[out:json];node["public_transport"="stop_position"]["train"="yes"](around:400.0,'+n.wayPoints.first.lat.toFixed(e.fixed)+","+n.wayPoints.first.lng.toFixed(e.fixed)+')->.s;rel(bn.s)->.s;node["public_transport"="stop_position"]["train"="yes"](around:400.0,'+n.wayPoints.last.lat.toFixed(e.fixed)+","+n.wayPoints.last.lng.toFixed(e.fixed)+")->.e;rel(bn.e)->.e;rel.e.s;out tags;").then(e=>function(e){if(0===e.elements.length)return Promise.reject(new Error("No relations found"));let t=window.TaN.baseDialog,n=document.createElement("div");n.id="TravelNotes-SelectDialog-SelectDiv",t.content.appendChild(n);let s=document.createElement("select");return s.id="TravelNotes-SelectDialog-SelectElement",n.appendChild(s),t.okButtonListener=function(){return a=e.elements[s.selectedIndex].id},e.elements.forEach(e=>{let t=document.createElement("option");t.text=e.tags.name,s.appendChild(t)}),s.selectedIndex=0,t.show()}(e)).then(()=>A("https://lz4.overpass-api.de/api/interpreter?data=[out:json];rel("+a.toFixed(0)+');way(r)->.e;way.e["railway"="rail"];(._;>;rel('+a.toFixed(0)+"););out;")).then(e=>I(e,t,s)).catch(e=>s(e))}return{getPromiseRoute:e=>function(e){return n=e,new Promise(m)}(e),get icon(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWX\t\t\t\t\tMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH4goTCi4V9AmY6AAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAA\t\t\t\t\tAEc0lEQVRIx8VXTUhbWxD+zr0ag77Gqo1/RazRYjcBaxAVoxXFhQtRXLgt2iJUaAl9FBFcPBdtceeuBXGr4uaCq67rz0IaaUtFBc\t\t\t\t\tXAq1WjVkhiTm6u3u8tXs1TG6NVyxuYzZy5fHNm5s58R5Ak/gdJOs+htbUVNpsNLpcLZWVlcDqdyMrKujoyE8j4+DhVVaXH42FdXR\t\t\t\t\t2tVisBxNTlcnF2dpaXEfyKcyAQIAD29vZydHSUdrudT58+/b3AUkru7OywoaGBdrudpmnyKiLOa67d3V3U19fjy5cvJ+ylpaVwOp\t\t\t\t\t3IyMhAWloa7HY7Kioq4HK5kJmZebUaR6NRKooSq6mqqlRVlUKIE7U+ra9fv75aqvPy8giARUVF9Pv91HWduq5TSkmv18v+/n5WVV\t\t\t\t\tXFBX/48OHlgFtaWgiA6enpF6pZNBplMBjk3t4e9/b2uL+/T5/P92vA79+/j0Xu9Xov3UBSSn79+jXu2U8DxOfzoa6uDgDw9u1blJ\t\t\t\t\teXAwAGBgYwMzODcDgMALBarbh58yZyc3NRXFyMe/fuIT8/H6qqIhKJ4ODgALdu3UJycvL5zfXp06fYTYeGhmL2tra2hM10nj569O\t\t\t\t\tjsVGuaRgAUQnBycpIkubi4yOzs7CuBHunu7u7PwD09PQTA27dvMxQKUUrJZ8+eXQvgkTocjpPAhYWFBMCBgQGS5PLy8rUCHtdAIB\t\t\t\t\tADVhwOB46GV3V1NQKBwG9bhY2Njf+txa6uLrS3t0PTNFRWVib8sLS0FG63G2VlZSguLsaNGzcQiUTw/ft3bGxs4Nu3b/D7/QgGgw\t\t\t\t\tiHw5BSQkoJXdcRjUYRDAah6zpSUlKQpGkapZQCAEKhEFRVxf3791FbW8uGhgbcuXMH+fn5sNvtiWISp3+WODb8SDcsFgvE58+fab\t\t\t\t\tPZoKoqsrOzYbFYfivz2NraQk5ODpKcTmfc6C5KiYQQP92YJMWPg9P2w8NDmKYJVdO0v3w+Hw4ODqDrOhRFQWpqKsQFxePxiOnpaU\t\t\t\t\txNTUFRFBQWFuI06NbWFtbX17G9vS0cDoeQUgokJSXFbf2Ojg6+e/eOm5ubjEajZ87j42szIyMjrs/Q0NCJ2W8YBkHSnJubY0lJiX\t\t\t\t\tkqCPO4ulwuU9M0U0ppGoZhHsns7KwJgCkpKSwoKCBJmqfoid/vZ15eHm02m7mysmJGIhHzxKw2DIMLCwt0u91nDgFFUWixWHj37l\t\t\t\t\t0ODg5yfn6eh4eHCXma1+vl2NgYnzx5QgAMhULx1+LIyAhfvnzJpaUl1tTUXOv06uzsTEwE5ubmaLVa2dTUxImJCb558+ZagI+yk5\t\t\t\t\tD66LrO5uZmAmB5eTmXl5c5Pj7OBw8e/DJgZmYm19bWLs4yAWB4eBjd3d0AgL6+Prx69QoAMD8/j48fP2J1dRXb29sIh8MwDANCCI\t\t\t\t\tTDYZimiZycHHR2dsLtdl+cZR6XnZ0dOhyOWIN9+PDhTN/p6Wl6PB62trYSAGtrazk1NUXDMC73kiDJx4+7KMS/6Xv+3EPD0M/07e\t\t\t\t\tvrpc32x4mUv3jxJ9fX/+Y/YWHR4vXjhpgAAAAASUVORK5CYII="},get name(){return"leaflet.TravelNotesPublicTransport & OpenStreetMap"},get transitModes(){return{car:!1,bike:!1,pedestrian:!1,train:!0}},get providerKeyNeeded(){return!1},get providerKey(){return 1},set providerKey(e){},get userLanguage(){return t},set userLanguage(e){t=e}}}())}();