/**
 * 
 * @source: https://github.com/wwwouaiebe/leaflet.TravelNotes
 * 
 * @licstart  The following is the entire license notice for the
 * JavaScript code in this page.
 * 
 * leaflet.travelnotes - version 2.3.0
 * Build 02577 - 2021-09-01T12:31:37+0200 
 * Copyright 2017 2021 wwwouaiebe 
 * Contact: https://www.ouaie.be/
 * License: GPL-3.0
 * 
 * The JavaScript code in this page is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 * 
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 * 
 * @licend  The above is the entire license notice
 * for the JavaScript code in this page.
 * 
 */


!function(){"use strict";
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Constants.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/Object.freeze({minColorValue:0,maxColorValue:255,rowsNumber:6,cellsNumber:6,deltaColor:51,sliderMaxValue:100,sliderStep:20,initialRed:0}),Object.freeze({notSaved:"ðŸ”´",modified:"ðŸŸ¡",saved:"ðŸŸ¢"});const t=Object.freeze({fixed:2,invalid:-1,defaultValue:0,metersInKm:1e3});Object.freeze({refusedByUser:-1,disabled:0,inactive:1,active:2}),Object.freeze({invalidPane:"43a6a53e-008a-4910-80a6-7a87d301ea15",itineraryPane:"8fbf0da7-4e6f-4bc7-8e20-1388461ccde7",travelNotesPane:"dffe782b-07df-4b81-a318-f287c0cf5ec6",searchPane:"228f00d7-43a8-4c13-897d-70400cb6dd58"});const e=Object.freeze({fixed:2,defaultValue:0}),s=Object.freeze({defaultValue:0,fixed:6,maxLat:90,minLat:-90,maxLng:180,minLng:-180}),i=Object.freeze({notEdited:0,editedNoChange:1,editedChanged:2});Object.freeze({margin:100,height:500,width:1e3,yDeltaText:30,xDeltaText:10,vScales:[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3],hScales:[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5]});const a=Object.freeze({width:40,height:40,svgViewboxDim:200}),n=Object.freeze({d0:0,d90:90,d180:180,d270:270,d360:360,d540:540,toRadians:Math.PI/180,fromRadians:180/Math.PI});Object.freeze({atStart:-1,onRoute:0,atEnd:1});const r=-1,o=-1,l=6371e3,d=20;const h=new
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file HTMLElementsFactory.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/
class{#addProperties(t,e){for(let s in e)try{if("dataset"===s){let s=e.dataset;for(let e in s)t.dataset["tan"+e]=s[e]}else t[s]=e[s]}catch(t){t instanceof Error&&console.error(t)}t.target&&(t.rel="noopener noreferrer")}constructor(){Object.freeze(this)}create(t,e,s){let i=null;return"text"===t.toLowerCase()?i=document.createTextNode(e.value||""):(i="select"===t.toLowerCase()?document.createElement(t):Object.seal(document.createElement(t)),e&&this.#addProperties(i,e)),s&&s.appendChild(i),i}};const c=Object.freeze(new class{#validityMap=new Map;#parser=new DOMParser;#addHtmlEntities(t){return t.replaceAll(/</g,"&lt;").replaceAll(/>/g,"&gt;").replaceAll(/"/g,"&quot;").replaceAll(/\u0027/g,"&apos;").replaceAll(/\u0a00/g,"&nbsp;")}#stringify(t){let e="",s="",i=t.childNodes;for(let a=0;a<i.length;a++){let i=t.childNodes[a],n=i.nodeName.toLowerCase(),r=this.#validityMap.get(n);if(r){r=r.concat(["id","class","dir","title","tanwidth","tanheight"]);let t="svg"===n||"text"===n||"polyline"===n;e+="<"+n,i.hasAttribute("target")&&(e+=' rel="noopener noreferrer"'),r.forEach((a=>{if(t)i.hasAttributeNS(null,a)&&(e+=" "+a+'="'+this.#addHtmlEntities(i.getAttribute(a))+'"',i.removeAttribute(a));else if(i.hasAttribute(a))if("href"===a||"src"===a){let t=this.sanitizeToUrl(i.getAttribute(a),a).url;""===t?s+="\nAn invalid url ("+i.getAttribute(a)+") was removed from a "+a+" attribute":e+=" "+a+'="'+t+'"',i.removeAttribute(a)}else e+=" "+a+'="'+this.#addHtmlEntities(i.getAttribute(a))+'"',i.removeAttribute(a)})),e+=">";let a="",o="";[a,o]=this.#stringify(i),e+=a,s+=o,e+="</"+n+">"}else"#text"===n?e+=this.#addHtmlEntities(i.nodeValue):s+="\nAn invalid tag "+n+" was removed";if(i.hasAttributes)for(let t=0;t<i.attributes.length;t++)"rel"!==i.attributes[t].name&&(s+="\nAn unsecure attribute "+i.attributes[t].name+'="'+i.attributes[t].value+'" was removed.')}return[e,s]}#cloneNode(t,e){let s=t.childNodes;for(let i=0;i<s.length;i++){let s=t.childNodes[i],a=s.nodeName.toLowerCase(),n=this.#validityMap.get(a);if(n){n=n.concat(["id","class","dir","title","tanwidth","tanheight"]);let t="svg"===a||"text"===a||"polyline"===a,i=t?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a);if(n.forEach((e=>{if(t)s.hasAttributeNS(null,e)&&(i.setAttributeNS(null,e,s.getAttribute(e)),s.removeAttributeNS(null,e));else if(s.hasAttribute(e))if("href"===e||"src"===e){let t=this.sanitizeToUrl(s.getAttribute(e),e).url;""!==t&&i.setAttribute(e,t)}else i.setAttribute(e,s.getAttribute(e))})),s.hasAttribute("style")){s.getAttribute("style").split(";").forEach((t=>{let e=t.split(":");2!==e.length||"width"!==e[0].trim()&&"height"!==e[0].trim()||(i.style[e[0].trim()]=e[1].trim())}))}s.hasAttribute("target")&&i.setAttribute("rel","noopener noreferrer"),e.appendChild(i),this.#cloneNode(s,i)}else"#text"===a&&e.appendChild(document.createTextNode(s.nodeValue))}}constructor(){this.#validityMap.set("a",["href","target"]),this.#validityMap.set("div",[]),this.#validityMap.set("del",[]),this.#validityMap.set("em",[]),this.#validityMap.set("figcaption",[]),this.#validityMap.set("figure",[]),this.#validityMap.set("h1",[]),this.#validityMap.set("h2",[]),this.#validityMap.set("h3",[]),this.#validityMap.set("h4",[]),this.#validityMap.set("h5",[]),this.#validityMap.set("h6",[]),this.#validityMap.set("hr",[]),this.#validityMap.set("img",["src","alt","width","height"]),this.#validityMap.set("ins",[]),this.#validityMap.set("li",[]),this.#validityMap.set("mark",[]),this.#validityMap.set("ol",[]),this.#validityMap.set("p",[]),this.#validityMap.set("s",[]),this.#validityMap.set("small",[]),this.#validityMap.set("strong",[]),this.#validityMap.set("span",[]),this.#validityMap.set("sub",[]),this.#validityMap.set("sup",[]),this.#validityMap.set("ul",[]),this.#validityMap.set("svg",["xmlns","viewBox","class"]),this.#validityMap.set("text",["x","y","text-anchor"]),this.#validityMap.set("polyline",["points","class","transform"])}sanitizeToColor(t){let e=t.match(/^\u0023[0-9,A-F,a-f]{6}$/);return e?e[0]:null}sanitizeToUrl(t,e="href"){let s=this.#parser.parseFromString("<div>"+t+"</div>","text/html");if(!s||"#document"!==s.nodeName)return{url:"",errorsString:"Parsing error"};let i=s.body.firstChild,a="";for(let t=0;t<i.childNodes.length;t++){if("#text"!==i.childNodes[t].nodeName)return{url:"",errorsString:"Invalid characters found in the url"};a+=i.childNodes[t].nodeValue}if(a=a.replaceAll(/</g,"").replaceAll(/>/g,"").replaceAll(/"/g,"").replaceAll(/\u0027/g,"").replaceAll(/&lt;/g,"").replaceAll(/&gt;/g,"").replaceAll(/&quot;/g,"").replaceAll(/&apos;/g,"").replaceAll(/%3C/g,"").replaceAll(/%3c/g,"").replaceAll(/%3E/g,"").replaceAll(/%3e/g,"").replaceAll(/%22/g,"").replaceAll(/%27/g,""),a!==t)return{url:"",errorsString:"Invalid characters found in the url"};let n=["https:"];if("http:"!==window.location.protocol&&"href"!==e||n.push("http:"),"href"===e){n.push("mailto:"),n.push("sms:"),n.push("tel:");let t=a.match(/^\u0023\w*/);if(t&&a===t[0])return{url:a,errorsString:""}}"src"===e&&n.push("data:");let r=null;try{r=new URL(a)}catch(t){return{url:"",errorsString:"Invalid url string"}}if(o===n.indexOf(r.protocol))return{url:"",errorsString:"Invalid protocol "+r.protocol};if(o!==["sms:","tel:"].indexOf(r.protocol)&&r.pathname.match(/^\+[0-9,*,\u0023]*$/))return{url:a,errorsString:""};try{encodeURIComponent(r.href)}catch(t){return{url:"",errorsString:"Invalid character in url"}}return{url:a,errorsString:""}}sanitizeToJsString(t){let e=this.#parser.parseFromString("<div>"+t+"</div>","text/html");if(!e||"#document"!==e.nodeName)return"";let s=e.body.firstChild,i="";for(let t=0;t<s.childNodes.length;t++){if("#text"!==s.childNodes[t].nodeName)return"";i+=s.childNodes[t].nodeValue}return i=i.replaceAll(/</g,"â‰º").replaceAll(/>/g,"â‰»").replaceAll(/"/g,"â€³").replaceAll(/\u0027/g,"â€²"),i}sanitizeToHtmlElement(t,e){let s=this.#parser.parseFromString("<div>"+t+"</div>","text/html");s&&"#document"===s.nodeName?this.#cloneNode(s.body.firstChild,e):e.textContent=""}sanitizeToHtmlString(t){let e="",s="",i=this.#parser.parseFromString("<div>"+t.replace("&nbsp;","à¨€")+"</div>","text/html");return i&&"#document"===i.nodeName?([e,s]=this.#stringify(i.body.firstChild,s),{htmlString:e,errorsString:s}):{htmlString:"",errorsString:"Parsing error"}}});const u=new class{#translations=new Map;constructor(){Object.freeze(this)}setTranslations(t){t.forEach((t=>this.#translations.set(t.msgid,c.sanitizeToJsString(t.msgstr))))}getText(t,e){let s=this.#translations.get(t);return e&&s&&Object.getOwnPropertyNames(e).forEach((t=>s=s.replace("{"+t+"}",e[t]))),s||t}};class p{static#objId=0;static get nextObjId(){return++p.#objId}}
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Version.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/const g="2.3.0";class v{#objTypeName="";#validObjTypeNames=["Itinerary","ItineraryPoint","Maneuver","Note","Route","Travel","WayPoint"];constructor(t){if(o===this.#validObjTypeNames.indexOf(t))throw new Error("Invalid ObjType name : "+t);this.#objTypeName=t,Object.freeze(this)}get name(){return this.#objTypeName}get version(){return g}get jsonObject(){return{name:this.#objTypeName,version:g}}validate(t){if(!Object.getOwnPropertyNames(t).includes("name"))throw new Error("No name for "+this.#objTypeName);if(this.#objTypeName!==t.name)throw new Error("Invalid name for "+this.#objTypeName);if(!Object.getOwnPropertyNames(t).includes("version"))throw new Error("No version for "+this.#objTypeName)}}class b{#collection=null;#index=o;constructor(t){this.#collection=t,Object.freeze(this)}get value(){return this.#index<this.#collection.length?this.#collection.at(this.#index):null}get previous(){return 0>=this.#index?null:this.#collection.at(this.#index-1)}get next(){return this.#index<this.#collection.length-1?this.#collection.at(this.#index+1):null}get done(){return++this.#index>=this.#collection.length}get first(){return 0===this.#index}get last(){return this.#index>=this.#collection.length-1}get index(){return this.#index}}class m{#array=[];#objName="";#classCollection=null;#indexOfObjId(t){return this.#array.findIndex((e=>e.objId===t))}#nextOrPrevious(t,e,s){let i=this.#indexOfObjId(t);if(o===i)throw new Error("invalid objId for next or previous function");if(1!==s&&-1!==s)throw new Error("invalid direction");let a=e;for(a||(a=()=>!0),i+=s;o<i&&i<this.#array.length&&!a(this.#array[i]);)i+=s;return o===i||this.#array.length===i?null:this.#array[i]}constructor(t){this.#classCollection=t;let e=new t;if(!e.objType||!e.objType.name)throw new Error("invalid object name for collection");this.#objName=e.objType.name,Object.freeze(this)}add(t){if(!t.objType||!t.objType.name||t.objType.name!==this.#objName)throw new Error("invalid object name for add function");this.#array.push(t)}at(t){return t<this.#array.length&&t>o?this.#array[t]:null}forEach(t){let e=null,s=this.iterator;for(;!s.done;)e=t(s.value,e);return e}getAt(t){let e=this.#indexOfObjId(t);return o===e?null:this.#array[e]}moveTo(t,e,s){let i=this.#indexOfObjId(t),a=this.#indexOfObjId(e);if(o===i||o===a)throw new Error("invalid objId for function  myMoveTo");s||a++,this.#array.splice(a,0,this.#array[i]),a<i&&i++,this.#array.splice(i,1)}next(t,e){return this.#nextOrPrevious(t,e,1)}previous(t,e){return this.#nextOrPrevious(t,e,-1)}remove(t){let e=this.#indexOfObjId(t);if(o===e)throw new Error("invalid objId for remove function");this.#array.splice(this.#indexOfObjId(t),1)}removeAll(t){t?this.#array.splice(1,this.#array.length-2):this.#array.length=0}replace(t,e){let s=this.#indexOfObjId(t);if(o===s)throw new Error("invalid objId for replace function");if(!e.objType||!e.objType.name||e.objType.name!==this.#objName)throw new Error("invalid object name for replace function");this.#array[s]=e}reverse(){this.#array.reverse()}sort(t){this.#array.sort(t)}swap(t,e){let s=this.#indexOfObjId(t);if(o===s||0===s&&e||this.#array.length-1===s&&!e)throw new Error("invalid objId for swap function");let i=this.#array[s];this.#array[s]=this.#array[s+(e?-1:1)],this.#array[s+(e?-1:1)]=i}get first(){return this.#array[0]}get iterator(){return new b(this)}get last(){return this.#array[this.#array.length-1]}get length(){return this.#array.length}get jsonObject(){let t=[],e=this.iterator;for(;!e.done;)t.push(e.value.jsonObject);return t}set jsonObject(t){this.#array.length=0;let e=null;t.forEach((t=>{e=new this.#classCollection,e.jsonObject=t,this.add(e)}))}}
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Config.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/let y={color:"#ff0000",dashArray:0,dashChoices:[{text:"â€”â€”â€”â€”â€”â€”",iDashArray:[0]},{text:"â€” â€” â€” â€” â€”",iDashArray:[4,2]},{text:"â€”â€§â€”â€§â€”â€§â€”â€§â€”",iDashArray:[4,2,0,2]},{text:"Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·",iDashArray:[0,2]}],elev:{smooth:!0,smoothCoefficient:.25,smoothPoints:3},showDragTooltip:3,width:3};const f=new class{constructor(){Object.freeze(this)}get UUID(){let t=new Uint8Array(16);const e=["","","","-","","-","","-","","-","","","","","",""];window.crypto.getRandomValues(t),t[6]=15&t[6]|64,t[8]=63&t[8]|128;let s="";for(let i=0;i<16;i++)s+=t[i].toString(16).padStart(2,"0")+e[i];return s}storageAvailable(t){try{let e=window[t],s="__storage_test__";return e.setItem(s,s),e.removeItem(s),!0}catch(t){return!1}}openFile(t,e){let s=document.createElement("input");s.type="file",e&&(s.accept=e),s.addEventListener("change",t,!1),s.click()}saveFile(t,e,s){try{let i=null;i=s?window.URL.createObjectURL(new File([e],t,{type:s})):URL.createObjectURL(e);let a=document.createElement("a");a.setAttribute("href",i),a.setAttribute("download",t),a.click(),window.URL.revokeObjectURL(i)}catch(t){t instanceof Error&&console.error(t)}}formatTime(t){let e=Math.floor(t);if(0===e)return"";let s=Math.floor(e/86400),i=Math.floor(e%86400/3600),a=Math.floor(e%3600/60),n=Math.floor(e%60);return 0<s?s+"Â "+u.getText("Utilities - Day")+"Â "+i+"Â "+u.getText("Utilities - Hour"):0<i?i+"Â "+u.getText("Utilities - Hour")+"Â "+a+"Â "+u.getText("Utilities - Minute"):0<a?a+"Â "+u.getText("Utilities - Minute"):n+"Â "+u.getText("Utilities - Second")}formatDistance(e){let s=Math.floor(e);return 0>=s?"0Â km":Math.floor(s/t.metersInKm)+","+Math.floor(s%t.metersInKm/10).toFixed(0).padStart(2,"0").padEnd(3,"0")+"Â km"}formatLat(t){return t>0?t.toFixed(s.fixed)+"Â N":(-t).toFixed(s.fixed)+"Â S"}formatLng(t){return t>0?t.toFixed(s.fixed)+"Â E":(-t).toFixed(s.fixed)+"Â W"}formatLatLng(t){return 0===t[0]&&0===t[1]?"":this.formatLat(t[0])+"Â -Â "+this.formatLng(t[1])}},j=new v("WayPoint");class w{#objId=r;#upgradeObject(t){switch(t.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":t.address=t.name,t.name="";case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+j.name)}}#validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+j.name);j.validate(t.objType),j.version!==t.objType.version&&this.#upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["address","name","lat","lng","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+j.name)})),t}constructor(){this.name="",this.address="",this.lat=s.defaultValue,this.lng=s.defaultValue,this.#objId=p.nextObjId,Object.seal(this)}get fullName(){let t=""===this.name?this.address:this.name+", "+this.address;return""===t&&(t=f.formatLatLng([this.lat,this.lng])),t}get latLng(){return[this.lat,this.lng]}set latLng(t){this.lat=t[0],this.lng=t[1]}get objId(){return this.#objId}get objType(){return j}get jsonObject(){return{name:this.name,address:this.address,lat:parseFloat(this.lat.toFixed(s.fixed)),lng:parseFloat(this.lng.toFixed(s.fixed)),objId:this.#objId,objType:j.jsonObject}}set jsonObject(t){let e=this.#validateObject(t);this.address=e.address||"",this.name=e.name||"",this.lat=e.lat||s.defaultValue,this.lng=e.lng||s.defaultValue,this.#objId=p.nextObjId,this.validateData()}validateData(){"string"==typeof this.address?this.address=c.sanitizeToJsString(this.address):this.address="","string"==typeof this.name?this.name=c.sanitizeToJsString(this.name):this.name="","number"!=typeof this.lat&&(this.lat=s.defaultValue),"number"!=typeof this.lng&&(this.lng=s.defaultValue)}}const O=new v("ItineraryPoint");class D{#objId=r;#upgradeObject(t){switch(t.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":t.elev=e.defaultValue;case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+O.name)}}#validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+O.name);O.validate(t.objType),O.version!==t.objType.version&&this.#upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["lat","lng","distance","elev","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+O.name)})),t}constructor(){this.lat=s.defaultValue,this.lng=s.defaultValue,this.distance=t.defaultValue,this.elev=e.defaultValue,this.#objId=p.nextObjId,Object.seal(this)}get latLng(){return[this.lat,this.lng]}set latLng(t){this.lat=t[0],this.lng=t[1]}get objType(){return O}get objId(){return this.#objId}get jsonObject(){return{lat:parseFloat(this.lat.toFixed(s.fixed)),lng:parseFloat(this.lng.toFixed(s.fixed)),distance:parseFloat(this.distance.toFixed(t.fixed)),elev:parseFloat(this.elev.toFixed(e.fixed)),objId:this.#objId,objType:O.jsonObject}}set jsonObject(i){let a=this.#validateObject(i);this.lat=a.lat||s.defaultValue,this.lng=a.lng||s.defaultValue,this.distance=a.distance||t.defaultValue,this.elev=a.elev||e.defaultValue,this.#objId=p.nextObjId,this.validateData()}validateData(){"number"!=typeof this.lat&&(this.lat=s.defaultValue),"number"!=typeof this.lng&&(this.lng=s.defaultValue),"number"!=typeof this.distance&&(this.distance=t.defaultValue),"number"!=typeof this.elev&&(this.elev=e.defaultValue)}}const T=new v("Maneuver");class I{#objId=r;#upgradeObject(e){switch(e.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":"kArriveDefault"===e.iconName&&(e.distance=t.defaultValue);case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":e.objType.version="2.3.0";break;default:throw new Error("invalid version for "+T.name)}}#validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+T.name);T.validate(t.objType),T.version!==t.objType.version&&this.#upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["iconName","instruction","distance","duration","itineraryPointObjId","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+T.name)})),t}constructor(){this.iconName="",this.instruction="",this.itineraryPointObjId=r,this.distance=t.defaultValue,this.duration=t.defaultValue,this.#objId=p.nextObjId,Object.seal(this)}get objType(){return T}get objId(){return this.#objId}get jsonObject(){return{iconName:this.iconName,instruction:this.instruction,distance:parseFloat(this.distance.toFixed(t.fixed)),duration:this.duration,itineraryPointObjId:this.itineraryPointObjId,objId:this.#objId,objType:T.jsonObject}}set jsonObject(e){let s=this.#validateObject(e);this.iconName=s.iconName||"",this.instruction=s.instruction||"",this.distance=s.distance||t.defaultValue,this.duration=s.duration||t.defaultValue,this.itineraryPointObjId=s.itineraryPointObjId||r,this.#objId=p.nextObjId,this.validateData()}validateData(){"string"==typeof this.iconName?this.iconName=c.sanitizeToJsString(this.iconName):this.iconName="","string"==typeof this.instruction?this.instruction=c.sanitizeToJsString(this.instruction):this.instruction="","number"!=typeof this.distance&&(this.distance=t.defaultValue),"number"!=typeof this.duration&&(this.duration=t.defaultValue),"number"!=typeof this.itineraryPointObjId&&(this.itineraryPointObjId=r)}}const L=new v("Itinerary");class N{#objId=r;#upgradeObject(t){switch(t.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":t.hasProfile=!1,t.ascent=0,t.descent=0;case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+L.name)}}#validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+L.name);L.validate(t.objType),L.version!==t.objType.version&&this.#upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["hasProfile","ascent","descent","itineraryPoints","maneuvers","provider","transitMode","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+L.name)})),t}constructor(){this.hasProfile=!1,this.ascent=0,this.descent=0,this.provider="",this.transitMode="",this.itineraryPoints=new m(D),this.maneuvers=new m(I),this.#objId=p.nextObjId,Object.seal(this)}get objType(){return L}get objId(){return this.#objId}get jsonObject(){return{hasProfile:this.hasProfile,ascent:this.ascent,descent:this.descent,itineraryPoints:this.itineraryPoints.jsonObject,maneuvers:this.maneuvers.jsonObject,provider:this.provider,transitMode:this.transitMode,objId:this.#objId,objType:L.jsonObject}}set jsonObject(t){let e=this.#validateObject(t);this.hasProfile=e.hasProfile||!1,this.ascent=e.ascent||0,this.descent=e.descent||0,this.itineraryPoints.jsonObject=e.itineraryPoints||[],this.maneuvers.jsonObject=e.maneuvers||[],this.provider=e.provider||"",this.transitMode=e.transitMode||"",this.#objId=p.nextObjId;let s=new Map,i=0,a=this.itineraryPoints.iterator;for(;!a.done;)s.set(e.itineraryPoints[i].objId,a.value.objId),i++;let n=this.maneuvers.iterator;for(;!n.done;)n.value.itineraryPointObjId=s.get(n.value.itineraryPointObjId);this.validateData()}validateData(){"boolean"!=typeof this.hasProfile&&(this.hasProfile=!1),"number"!=typeof this.ascent&&(this.ascent=0),"number"!=typeof this.descent&&(this.descent=0),"string"==typeof this.provider?this.provider=c.sanitizeToJsString(this.provider):this.provider="","string"==typeof this.transitMode?this.transitMode=c.sanitizeToJsString(this.transitMode):this.transitMode=""}}const M=new v("Note");class x{#objId=r;#UpdateStyles(t){return t.replaceAll(/style='color:white;background-color:red'/g,"class='TravelNotes-Note-WhiteRed'").replaceAll(/style='color:white;background-color:green'/g,"class='TravelNotes-Note-WhiteGreen'").replaceAll(/style='color:white;background-color:blue'/g,"class='TravelNotes-Note-WhiteBlue'").replaceAll(/style='color:white;background-color:brown'/g,"class='TravelNotes-Note-WhiteBrown'").replaceAll(/style='color:white;background-color:black'/g,"class='TravelNotes-Note-WhiteBlack'").replaceAll(/style='border:solid 0.1em'/g,"class='TravelNotes-Note-BlackWhite'").replaceAll(/style='background-color:white;'/g,"class='TravelNotes-Note-Knooppunt'").replaceAll(/style='fill:green;font:bold 120px sans-serif;'/g,"").replaceAll(/style='fill:none;stroke:green;stroke-width:10;'/g,"")}#upgradeObject(t){switch(t.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":"string"==typeof t.iconHeight&&(t.iconHeight=Number.parseInt(t.iconHeight)),"string"==typeof t.iconWidth&&(t.iconWidth=Number.parseInt(t.iconWidth)),t.iconContent=this.#UpdateStyles(t.iconContent),t.popupContent=this.#UpdateStyles(t.popupContent),t.tooltipContent=this.#UpdateStyles(t.tooltipContent),t.phone=this.#UpdateStyles(t.phone),t.address=this.#UpdateStyles(t.address);case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+M.name)}}#validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+M.name);M.validate(t.objType),M.version!==t.objType.version&&this.#upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["iconHeight","iconWidth","iconContent","popupContent","tooltipContent","phone","url","address","iconLat","iconLng","lat","lng","distance","chainedDistance","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+M.name)})),t}constructor(){this.iconHeight=a.height,this.iconWidth=a.width,this.iconContent="",this.popupContent="",this.tooltipContent="",this.phone="",this.url="",this.address="",this.iconLat=s.defaultValue,this.iconLng=s.defaultValue,this.lat=s.defaultValue,this.lng=s.defaultValue,this.distance=t.invalid,this.chainedDistance=t.defaultValue,this.#objId=p.nextObjId,Object.seal(this)}get isRouteNote(){return this.distance!==t.invalid}get iconLatLng(){return[this.iconLat,this.iconLng]}set iconLatLng(t){this.iconLat=t[0],this.iconLng=t[1]}get latLng(){return[this.lat,this.lng]}set latLng(t){this.lat=t[0],this.lng=t[1]}get objType(){return M}get objId(){return this.#objId}get jsonObject(){return{iconHeight:this.iconHeight,iconWidth:this.iconWidth,iconContent:this.iconContent,popupContent:this.popupContent,tooltipContent:this.tooltipContent,phone:this.phone,url:this.url,address:this.address,iconLat:parseFloat(this.iconLat.toFixed(s.fixed)),iconLng:parseFloat(this.iconLng.toFixed(s.fixed)),lat:parseFloat(this.lat.toFixed(s.fixed)),lng:parseFloat(this.lng.toFixed(s.fixed)),distance:parseFloat(this.distance.toFixed(t.fixed)),chainedDistance:parseFloat(this.chainedDistance.toFixed(t.fixed)),objId:this.#objId,objType:M.jsonObject}}set jsonObject(e){let i=this.#validateObject(e);this.iconHeight=i.iconHeight||a.height,this.iconWidth=i.iconWidth||a.width,this.iconContent=i.iconContent||"",this.popupContent=i.popupContent||"",this.tooltipContent=i.tooltipContent||"",this.phone=i.phone||"",this.url=i.url||"",this.address=i.address||"",this.iconLat=i.iconLat||s.defaultValue,this.iconLng=i.iconLng||s.defaultValue,this.lat=i.lat||s.defaultValue,this.lng=i.lng||s.defaultValue,this.distance=i.distance||t.invalid,this.chainedDistance=i.chainedDistance||t.defaultValue,this.#objId=p.nextObjId,this.validateData(!0)}validateData(e){if("number"!=typeof this.iconHeight&&(this.iconHeight=a.height),"number"!=typeof this.iconWidth&&(this.iconWidth=a.width),"string"==typeof this.iconContent){let t=c.sanitizeToHtmlString(this.iconContent);e&&""!==t.errorsString&&console.log(t.errorsString+" ("+this.iconContent+")"),this.iconContent=t.htmlString}else this.iconContent="";if("string"==typeof this.popupContent){let t=c.sanitizeToHtmlString(this.popupContent);e&&""!==t.errorsString&&console.log(t.errorsString+" ("+this.popupContent+")"),this.popupContent=t.htmlString}else this.popupContent="";if("string"==typeof this.tooltipContent){let t=c.sanitizeToHtmlString(this.tooltipContent);e&&""!==t.errorsString&&console.log(t.errorsString+" ("+this.tooltipContent+")"),this.tooltipContent=t.htmlString}else this.tooltipContent="";if("string"==typeof this.phone){let t=c.sanitizeToHtmlString(this.phone);e&&""!==t.errorsString&&console.log(t.errorsString+" ("+this.phone+")"),this.phone=t.htmlString}else this.phone="";if("string"==typeof this.url&&""!==this.url){let t=c.sanitizeToUrl(this.url);e&&""!==t.errorsString&&console.log(t.errorsString+" ("+this.url+")"),this.url=encodeURI(t.url)}else this.url="";"string"==typeof this.address?this.address=c.sanitizeToHtmlString(this.address).htmlString:this.address="","number"!=typeof this.iconLat&&(this.iconLat=s.defaultValue),"number"!=typeof this.iconLng&&(this.iconLng=s.defaultValue),"number"!=typeof this.lat&&(this.lat=s.defaultValue),"number"!=typeof this.lng&&(this.lng=s.defaultValue),"number"!=typeof this.distance&&(this.distance=t.invalid),"number"!=typeof this.chainedDistance&&(this.chainedDistance=t.defaultValue)}}const E=new v("Route");class A{#objId=r;#upgradeObject(t){switch(t.objType.version){case"1.0.0":t.dashArray=0,t.hidden=!1;case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":t.edited=i.notEdited;case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":t.editionStatus=t.edited;case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+E.name)}}#validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+E.name);E.validate(t.objType),E.version!==t.objType.version&&this.#upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["name","wayPoints","notes","itinerary","width","color","dashArray","chain","distance","duration","editionStatus","hidden","chainedDistance","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+E.name)})),t}constructor(){this.name="",this.wayPoints=new m(w),this.wayPoints.add(new w),this.wayPoints.add(new w),this.notes=new m(x),this.itinerary=new N,this.width=y.width,this.color=y.color,this.dashArray=y.dashArray,this.chain=!0,this.chainedDistance=t.defaultValue,this.distance=t.defaultValue,this.duration=t.defaultValue,this.editionStatus=i.notEdited,this.hidden=!1,this.#objId=p.nextObjId,Object.seal(this)}get computedName(){let t=this.name;return""===t&&(t=(""===this.wayPoints.first.fullName?"???":this.wayPoints.first.fullName)+" â®ž "+(""===this.wayPoints.last.fullName?"???":this.wayPoints.last.fullName)),t}get objId(){return this.#objId}get objType(){return E}haveValidWayPoints(){let t=!0;return this.wayPoints.forEach((e=>{t=t&&s.defaultValue!==e.lat&&s.defaultValue!==e.lng})),t}get jsonObject(){return{name:this.name,wayPoints:this.wayPoints.jsonObject,notes:this.notes.jsonObject,itinerary:this.itinerary.jsonObject,width:this.width,color:this.color,dashArray:this.dashArray,chain:this.chain,distance:parseFloat(this.distance.toFixed(t.fixed)),duration:this.duration,editionStatus:this.editionStatus,hidden:this.hidden,chainedDistance:parseFloat(this.chainedDistance.toFixed(t.fixed)),objId:this.#objId,objType:E.jsonObject}}set jsonObject(t){let e=this.#validateObject(t);this.name=e.name||"",this.wayPoints.jsonObject=e.wayPoints||[],this.notes.jsonObject=e.notes||[],this.itinerary.jsonObject=e.itinerary||(new N).jsonObject,this.width=e.width||y.width,this.color=e.color||"#000000",this.dashArray=e.dashArray||0,this.chain=e.chain||!1,this.distance=e.distance,this.duration=e.duration,this.editionStatus=e.editionStatus||i.notEdited,this.hidden=e.hidden||!1,this.chainedDistance=e.chainedDistance,this.#objId=p.nextObjId,this.validateData()}validateData(){"string"==typeof this.name?this.name=c.sanitizeToJsString(this.name):this.name="","number"!=typeof this.width&&(this.width=y.width),"string"==typeof this.color?this.color=c.sanitizeToColor(this.color)||y.color:this.color=y.color,"number"!=typeof this.dashArray&&(this.dashArray=0),this.dashArray>=y.dashChoices.length&&(this.dashArray=0),"boolean"!=typeof this.chain&&(this.chain=!1),"number"!=typeof this.distance&&(this.distance=t.defaultValue),"number"!=typeof this.duration&&(this.duration=t.defaultValue),"number"!=typeof this.editionStatus&&(this.editionStatus=i.notEdited),"boolean"!=typeof this.hidden&&(this.hidden=!1),"number"!=typeof this.chainedDistance&&(this.chainedDistance=t.defaultValue)}}const P=new v("Travel");class C{#objId=r;#upgradeObject(t){switch(t.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":t.editedRoute=new A;case"1.5.0":if(t.userData.layerId){let e=[{layerId:"0",layerName:"OSM - Color"},{layerId:"1",layerName:"OSM - Black and White"},{layerId:"2",layerName:"Thunderforest - Transport"},{layerId:"3",layerName:"Thunderforest - OpenCycleMap"},{layerId:"4",layerName:"Thunderforest - Outdoors"},{layerId:"5",layerName:"Esri - Aerial view"},{layerId:"6",layerName:"Kartverket - Norway"},{layerId:"7",layerName:"IGN-NGI - Belgium now"},{layerId:"12",layerName:"Thunderforest - Landscape"},{layerId:"24",layerName:"LantmÃ¤teriet - Sweden"},{layerId:"25",layerName:"Maanmittauslaitos - Finland"}].find((e=>e.layerId===t.userData.layerId));t.layerName=e?e.layerName:"OSM - Color"}else t.layerName="OSM - Color";case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+P.name)}}#validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+P.name);P.validate(t.objType),P.version!==t.objType.version&&this.#upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["name","editedRoute","routes","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+P.name)})),t}constructor(){this.editedRoute=new A,this.routes=new m(A),this.notes=new m(x),this.layerName="OSM - Color",this.name="",this.readOnly=!1,this.#objId=p.nextObjId,Object.seal(this)}get objId(){return this.#objId}get objType(){return P}get jsonObject(){return{editedRoute:this.editedRoute.jsonObject,layerName:this.layerName,name:this.name,routes:this.routes.jsonObject,notes:this.notes.jsonObject,readOnly:this.readOnly,objId:this.#objId,objType:P.jsonObject}}set jsonObject(t){let e=this.#validateObject(t);this.editedRoute.jsonObject=e.editedRoute,this.layerName=t.layerName||"OSM - Color",this.name=e.name||"",this.readOnly=e.readOnly||!1,this.routes.jsonObject=e.routes||[],this.notes.jsonObject=e.notes||[],this.#objId=p.nextObjId,this.validateData()}validateData(){"string"==typeof this.layerName?this.layerName=c.sanitizeToJsString(this.layerName):this.layerName="OSM - Color","string"==typeof this.name?this.name=c.sanitizeToJsString(this.name):this.name="TravelNotes","boolean"!=typeof this.readOnly&&(this.readOnly=!0)}}const S=new class{#providers=new Map;#mapObjects=new Map;#routing=Object.seal({provider:"",transitMode:""});#UUID=f.UUID;constructor(){this.map=null,this.travel=new C,this.editedRouteObjId=r,this.searchData=[],Object.seal(this)}get providers(){return this.#providers}get mapObjects(){return this.#mapObjects}get routing(){return this.#routing}get UUID(){return this.#UUID}};const k=new class{constructor(){Object.freeze(this)}getLatLngElevAtDist(t,e){if(t.distance<=e||0>=e)return null;let s=0,i=t.itinerary.itineraryPoints.iterator;for(;s<e&&!i.done;)s+=i.value.distance;let a=i.value;i.done;let n=(a.distance-s+e)/a.distance;return Object.freeze({latLng:[a.lat+(i.value.lat-a.lat)*n,a.lng+(i.value.lng-a.lng)*n],elev:a.elev+(i.value.elev-a.elev)*n,ascent:100*(i.value.elev-a.elev)/a.distance,routeDistance:e})}getClosestLatLngDistance(e,s){if(0===e.itinerary.itineraryPoints.length)return null;let i=e.itinerary.itineraryPoints.iterator;i.done;let a=Number.MAX_VALUE,n=window.L.Projection.SphericalMercator.project(window.L.latLng(s[0],s[1])),r=window.L.Projection.SphericalMercator.project(window.L.latLng(i.value.lat,i.value.lng)),o=null,l=t.defaultValue,d=i.value.distance;for(;!i.done;){let t=window.L.Projection.SphericalMercator.project(window.L.latLng(i.value.lat,i.value.lng)),e=window.L.LineUtil.pointToSegmentDistance(n,r,t);e<a&&(a=e,o=window.L.Projection.SphericalMercator.unproject(window.L.LineUtil.closestPointOnSegment(n,r,t)),l=d-o.distanceTo(window.L.latLng(i.value.lat,i.value.lng))),d+=i.value.distance,r=t}return Object.freeze({latLng:[o.lat,o.lng],distance:l})}getLatLngBounds(t){let e=window.L.latLng([s.maxLat,s.maxLng]),i=window.L.latLng([s.minLat,s.minLng]);return t.forEach((t=>{e.lat=Math.min(e.lat,t[0]),e.lng=Math.min(e.lng,t[1]),i.lat=Math.max(i.lat,t[0]),i.lng=Math.max(i.lng,t[1])})),window.L.latLngBounds(e,i)}getSquareBoundingBox(t,e){let s=e/l*n.fromRadians,i=t[0]*n.toRadians,a=Math.acos((Math.cos(e/l)-Math.sin(i)**2)/Math.cos(i)**2)*n.fromRadians;return window.L.latLngBounds(window.L.latLng([t[0]-s,t[1]-a]),window.L.latLng([t[0]+s,t[1]+a]))}project(t,e){let s=S.map.project(window.L.latLng(t),e);return[s.x,s.y]}screenCoordToLatLng(t,e){let s=S.map.containerPointToLatLng(window.L.point(t,e));return[s.lat,s.lng]}addPoints(t,e){return[t[0]+e[0],t[1]+e[1]]}subtrackPoints(t,e){return[t[0]-e[0],t[1]-e[1]]}};class W{#baseDialog=null;constructor(t){Object.seal(this),this.#baseDialog=t}destructor(){this.#baseDialog=null}handleEvent(){this.#baseDialog.onOk()}}class B{#baseDialog=null;constructor(t){Object.seal(this),this.#baseDialog=t}destructor(){this.#baseDialog=null}handleEvent(){this.#baseDialog.onCancel()}}class V{#dragData=null;constructor(t){Object.seal(this),this.#dragData=t}destructor(){this.#dragData=null}handleEvent(t){this.#dragData.dragStartX=t.screenX,this.#dragData.dragStartY=t.screenY,t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move"}}class F{#dragData=null;#containerDiv=null;#backgroundDiv=null;constructor(t,e,s){Object.seal(this),this.#dragData=t,this.#containerDiv=e,this.#backgroundDiv=s}destructor(){this.#dragData=null,this.#containerDiv=null,this.#backgroundDiv=null}handleEvent(t){this.#dragData.dialogX+=t.screenX-this.#dragData.dragStartX,this.#dragData.dialogX=Math.min(Math.max(this.#dragData.dialogX,d),this.#backgroundDiv.clientWidth-this.#containerDiv.clientWidth-d),this.#dragData.dialogY+=t.screenY-this.#dragData.dragStartY,this.#dragData.dialogY=Math.max(this.#dragData.dialogY,d);let e=this.#backgroundDiv.clientHeight-Math.max(this.#dragData.dialogY,0)-d;this.#containerDiv.style.left=String(this.#dragData.dialogX)+"px",this.#containerDiv.style.top=String(this.#dragData.dialogY)+"px",this.#containerDiv.style["max-height"]=String(e)+"px"}}class R{#baseDialog=null;constructor(t){Object.seal(this),this.#baseDialog=t}destructor(){this.#baseDialog=null}handleEvent(t){this.#baseDialog.keyboardEventListenerEnabled&&("Escape"===t.key||"Esc"===t.key?this.#baseDialog.onCancel():"Enter"===t.key&&this.#baseDialog.onOk())}}class U{#mapCenter=[s.defaultValue,s.defaultValue];handleEvent(t){if("start"===t.action)return void(this.#mapCenter=S.map.getCenter());let e=k.screenCoordToLatLng(t.startX,t.startY),s=k.screenCoordToLatLng(t.endX,t.endY);S.map.panTo([this.#mapCenter.lat+e[0]-s[0],this.#mapCenter.lng+e[1]-s[1]])}}class H{#initialZoom=0;#startPoint=null;handleEvent(t){if("start"===t.action)return this.#initialZoom=S.map.getZoom(),void(this.#startPoint=window.L.point(t.clientX,t.clientY));let e=Math.floor(this.#initialZoom+(t.startY-t.endY)/50);e=Math.min(S.map.getMaxZoom(),e),e=Math.max(S.map.getMinZoom(),e),S.map.setZoomAround(this.#startPoint,e)}}class z{handleEvent(t){if("TravelNotes-Background"!==t.target.id)return;let e=S.map.getZoom()+(0>t.deltaY?1:-1);e=Math.min(S.map.getMaxZoom(),e),e=Math.max(S.map.getMinZoom(),e),S.map.setZoomAround(window.L.point(t.clientX,t.clientY),e)}}class Y{handleEvent(t){t.preventDefault()}}class X{handleEvent(t){t.preventDefault()}}class K{#panOngoing=!1;#startPanX=0;#startPanY=0;#target=null;#button=0;#eventType="";#dispatchEvent(t,e){let s=new Event(this.#eventType);s.startX=this.#startPanX,s.startY=this.#startPanY,s.endX=t.screenX,s.endY=t.screenY,s.clientX=t.clientX,s.clientY=t.clientY,s.action=e,this.#target.dispatchEvent(s)}constructor(t,e){switch(this.#target=t,this.#button=e,e){case 0:this.#eventType="leftpan";break;case 1:this.#eventType="middlepan";break;case 2:this.#eventType="rightpan";break;default:this.#button=o}}handleEvent(t){switch(t.type){case"mousedown":t.button===this.#button&&(this.#startPanX=t.screenX,this.#startPanY=t.screenY,this.#panOngoing=!0,this.#dispatchEvent(t,"start"));break;case"mouseup":t.button!==this.#button||!this.#panOngoing||this.#startPanX===t.screenX&&this.#startPanY===t.screenY||this.#dispatchEvent(t,"end"),this.#panOngoing=!1;break;case"mousemove":this.#panOngoing&&(document.selection?document.selection.empty():window.getSelection().removeAllRanges(),this.#dispatchEvent(t,"move"))}}}class _{static get LEFT_BUTTON(){return 0}static get MIDDLE_BUTTON(){return 1}static get RIGHT_BUTTON(){return 2}#target=null;#eventListener=null;constructor(t,e=0){this.#target=t,this.#eventListener=new K(t,e),this.#target.addEventListener("mousedown",this.#eventListener),this.#target.addEventListener("mouseup",this.#eventListener),this.#target.addEventListener("mousemove",this.#eventListener)}detach(){this.#target.removeEventListener("mousedown",this.#eventListener),this.#target.removeEventListener("mouseup",this.#eventListener),this.#target.removeEventListener("mousemove",this.#eventListener),this.#eventListener=null,this.#target=null}}class Z extends class{#backgroundDiv={};#containerDiv={};#errorDiv={};#waitDiv={};#okButton={};#cancelButton={};#topBar={};#secondButton=null;#leftPanEventDispatcher=null;#rightPanEventDispatcher=null;keyboardEventListenerEnabled=!0;#dragData=Object.seal({dragStartX:0,dragStartY:0,dialogX:0,dialogY:0});#eventListeners={onKeydown:null,onTopBarDragStart:null,onTopBarDragEnd:null,onCancelButtonClick:null,onOkButtonClick:null,onLeftPan:null,onRightPan:null,onWheel:null,onContextMenu:null,onDragOver:null};#options=null;#onPromiseOkFct=null;#onPromiseErrorFct=null;#createBackgroundDiv(){this.#backgroundDiv=h.create("div",{id:"TravelNotes-Background",className:"TravelNotes-Background"}),this.#leftPanEventDispatcher=new _(this.#backgroundDiv,_.LEFT_BUTTON),this.#rightPanEventDispatcher=new _(this.#backgroundDiv,_.RIGHT_BUTTON),this.#eventListeners.onLeftPan=new U,this.#backgroundDiv.addEventListener("leftpan",this.#eventListeners.onLeftPan,!1),this.#eventListeners.onRightPan=new H,this.#backgroundDiv.addEventListener("rightpan",this.#eventListeners.onRightPan,!1),this.#eventListeners.onDragOver=new X,this.#backgroundDiv.addEventListener("dragover",this.#eventListeners.onDragOver,!1),this.#eventListeners.onWheel=new z,this.#backgroundDiv.addEventListener("wheel",this.#eventListeners.onWheel,!1),this.#eventListeners.onContextMenu=new Y,this.#backgroundDiv.addEventListener("contextmenu",this.#eventListeners.onContextMenu,!1)}#createContainerDiv(){this.#containerDiv=h.create("div",{className:"TravelNotes-BaseDialog-Container"},this.#backgroundDiv)}#createTopBar(){this.#topBar=h.create("div",{className:"TravelNotes-BaseDialog-TopBar",draggable:!0},this.#containerDiv),this.#eventListeners.onTopBarDragStart=new V(this.#dragData),this.#eventListeners.onTopBarDragEnd=new F(this.#dragData,this.#containerDiv,this.#backgroundDiv),this.#topBar.addEventListener("dragstart",this.#eventListeners.onTopBarDragStart,!1),this.#topBar.addEventListener("dragend",this.#eventListeners.onTopBarDragEnd,!1),this.#eventListeners.onCancelButtonClick=new B(this),this.#cancelButton=h.create("div",{textContent:"âŒ",className:"TravelNotes-BaseDialog-CancelButton",title:u.getText("BaseDialog - Cancel")},this.#topBar),this.#cancelButton.addEventListener("click",this.#eventListeners.onCancelButtonClick,!1)}#createHeaderDiv(){h.create("text",{value:this.title},h.create("div",{className:"TravelNotes-BaseDialog-HeaderDiv"},this.#containerDiv))}#createContentDiv(){let t=h.create("div",{className:"TravelNotes-BaseDialog-ContentDiv"},this.#containerDiv);this.contentHTMLElements.forEach((e=>t.appendChild(e)))}#createErrorDiv(){this.#errorDiv=h.create("div",{className:"TravelNotes-BaseDialog-ErrorDiv TravelNotes-Hidden"},this.#containerDiv)}#createWaitDiv(){h.create("div",{className:"TravelNotes-WaitAnimationBullet"},h.create("div",{className:"TravelNotes-WaitAnimation"},this.#waitDiv=h.create("div",{className:"TravelNotes-BaseDialog-WaitDiv  TravelNotes-Hidden"},this.#containerDiv)))}#createFooterDiv(){let t=h.create("div",{className:"TravelNotes-BaseDialog-FooterDiv"},this.#containerDiv);this.#okButton=h.create("div",{textContent:this.#options.firstButtonText||"ðŸ†—",className:"TravelNotes-BaseDialog-Button"},t),this.#eventListeners.onOkButtonClick=new W(this),this.#okButton.addEventListener("click",this.#eventListeners.onOkButtonClick,!1),this.#options.secondButtonText&&(this.#secondButton=h.create("div",{textContent:this.#options.secondButtonText,className:"TravelNotes-BaseDialog-Button"},t),this.#secondButton.addEventListener("click",this.#eventListeners.onCancelButtonClick,!1)),this.footerHTMLElements.forEach((e=>t.appendChild(e)))}#createHTML(){this.#createBackgroundDiv(),this.#createContainerDiv(),this.#createTopBar(),this.#createHeaderDiv(),this.#createContentDiv(),this.#createErrorDiv(),this.#createWaitDiv(),this.#createFooterDiv()}#centerDialog(){this.#dragData.dialogX=(this.#backgroundDiv.clientWidth-this.#containerDiv.clientWidth)/2,this.#dragData.dialogY=(this.#backgroundDiv.clientHeight-this.#containerDiv.clientHeight)/2,this.#dragData.dialogX=Math.min(Math.max(this.#dragData.dialogX,d),this.#backgroundDiv.clientWidth-this.#containerDiv.clientWidth-d),this.#dragData.dialogY=Math.max(this.#dragData.dialogY,d);let t=this.#backgroundDiv.clientHeight-Math.max(this.#dragData.dialogY,0)-d;this.#containerDiv.style.left=String(this.#dragData.dialogX)+"px",this.#containerDiv.style.top=String(this.#dragData.dialogY)+"px",this.#containerDiv.style["max-height"]=String(t)+"px"}#show(t,e){this.#onPromiseOkFct=t,this.#onPromiseErrorFct=e,this.#createHTML(),document.body.appendChild(this.#backgroundDiv),this.#centerDialog(),document.addEventListener("keydown",this.#eventListeners.onKeydown,{capture:!0}),this.onShow()}constructor(t={}){Object.seal(this),this.#options=t,this.#eventListeners.onKeydown=new R(this)}#destructor(){this.#backgroundDiv.removeEventListener("dragover",this.#eventListeners.onDragOver,!1),this.#backgroundDiv.removeEventListener("leftpan",this.#eventListeners.onLeftPan,!1),this.#backgroundDiv.removeEventListener("rightpan",this.#eventListeners.onRightPan,!1),this.#backgroundDiv.removeEventListener("wheel",this.#eventListeners.onWheel,!1),this.#backgroundDiv.removeEventListener("contextmenu",this.#eventListeners.onContextMenu,!1),document.removeEventListener("keydown",this.#eventListeners.onKeydown,{capture:!0}),this.#topBar.removeEventListener("dragstart",this.#eventListeners.onTopBarDragStart,!1),this.#topBar.removeEventListener("dragend",this.#eventListeners.onTopBarDragEnd,!1),this.#cancelButton.removeEventListener("click",this.#eventListeners.onCancelButtonClick,!1),this.#okButton.removeEventListener("click",this.#eventListeners.onOkButtonClick,!1),this.#options.secondButtonText&&this.#secondButton.removeEventListener("click",this.#eventListeners.onCancelButtonClick,!1),document.removeEventListener("keydown",this.#eventListeners.onKeydown,{capture:!0}),this.#eventListeners.onKeydown.destructor(),this.#eventListeners.onTopBarDragStart.destructor(),this.#eventListeners.onTopBarDragEnd.destructor(),this.#eventListeners.onCancelButtonClick.destructor(),this.#eventListeners.onOkButtonClick.destructor(),this.#leftPanEventDispatcher.detach(),this.#rightPanEventDispatcher.detach(),document.body.removeChild(this.#backgroundDiv)}onCancel(){this.#destructor(),this.#onPromiseErrorFct("Canceled by user")}canClose(){return!0}onOk(t){this.canClose()&&(this.#destructor(),this.#onPromiseOkFct(t))}onShow(){}get title(){return""}get contentHTMLElements(){return[]}get footerHTMLElements(){return[]}show(){return new Promise(((t,e)=>this.#show(t,e)))}showWait(){this.#waitDiv.classList.remove("TravelNotes-Hidden"),this.#okButton.classList.add("TravelNotes-Hidden")}hideWait(){this.#waitDiv.classList.add("TravelNotes-Hidden"),this.#okButton.classList.remove("TravelNotes-Hidden")}showError(t){c.sanitizeToHtmlElement(t,this.#errorDiv),this.#errorDiv.classList.remove("TravelNotes-Hidden")}hideError(){this.#errorDiv.textContent="",this.#errorDiv.classList.add("TravelNotes-Hidden")}}{#options=null;#selectHtmlElement=null;get#selectDiv(){let t=h.create("div");return this.#selectHtmlElement=h.create("select",null,t),this.#options.selectOptionsData.forEach((t=>h.create("option",{text:t.text},this.#selectHtmlElement))),this.#selectHtmlElement.selectedIndex=0,t}constructor(t={}){super(t),this.#options=t}get title(){return this.#options.title||""}get contentHTMLElements(){return[h.create("div",{textContent:this.#options.text||""}),this.#selectDiv]}onOk(){super.onOk(this.#options.selectOptionsData[this.#selectHtmlElement.selectedIndex].objId)}}const J=new class{#normalizeLng(t){return(t+n.d540)%n.d360-n.d180}constructor(){Object.freeze(this)}arcFromSummitArcArc(t,e,s){return Math.acos(Math.cos(e)*Math.cos(s)+Math.sin(e)*Math.sin(s)*Math.cos(t))}summitFromArcArcArc(t,e,s){return Math.acos((Math.cos(s)-Math.cos(t)*Math.cos(e))/(Math.sin(t)*Math.sin(e)))}pointsDistance(t,e){if(t[0]===e[0]&&t[1]===e[1])return 0;let s=t[0]*n.toRadians,i=e[0]*n.toRadians,a=(this.#normalizeLng(e[1])-this.#normalizeLng(t[1]))*n.toRadians;return Math.acos(Math.sin(s)*Math.sin(i)+Math.cos(s)*Math.cos(i)*Math.cos(a))*l}};class G{#newId=r;#selectedRelationId=r;#waysMap=new Map;#nodesMap=new Map;#stopsMap=new Map;constructor(t){this.#selectedRelationId=t,this.nodes3WaysCounter=0}get waysMap(){return this.#waysMap}get nodesMap(){return this.#nodesMap}get stopsMap(){return this.#stopsMap}get newId(){return this.#newId--}firstOf(t){return t[0]}lastOf(t){return t[t.length-1]}removeFrom(t,e){t.splice(t.indexOf(e),1)}#reverseWay(t){let e=this.#nodesMap.get(this.firstOf(t.nodesIds)),s=this.#nodesMap.get(this.lastOf(t.nodesIds));this.removeFrom(e.startingWaysIds,t.id),e.endingWaysIds.push(t.id),this.removeFrom(s.endingWaysIds,t.id),s.startingWaysIds.push(t.id),t.nodesIds.reverse()}mergeWays(t,e){let s=this.#waysMap.get(t),i=this.#waysMap.get(e);this.lastOf(s.nodesIds)===this.lastOf(i.nodesIds)?this.#reverseWay(i):this.firstOf(s.nodesIds)===this.firstOf(i.nodesIds)?this.#reverseWay(s):this.firstOf(s.nodesIds)===this.lastOf(i.nodesIds)&&(this.#reverseWay(s),this.#reverseWay(i));let a=this.#nodesMap.get(s.nodesIds.pop());a.startingWaysIds=[],a.endingWaysIds=[],s.nodesIds=s.nodesIds.concat(i.nodesIds),s.distance+=i.distance;let n=this.#nodesMap.get(this.lastOf(s.nodesIds));return this.removeFrom(n.endingWaysIds,i.id),n.endingWaysIds.push(s.id),this.#waysMap.delete(i.id),s.id}#cloneNode(t){let e=this.#nodesMap.get(t),s={id:this.newId,lat:e.lat,lon:e.lon,type:"node",startingWaysIds:[],endingWaysIds:[],isNode3Ways:e.isNode3Ways};return this.#nodesMap.set(s.id,s),s.id}cloneWay(t){let e=this.#waysMap.get(t),s={id:this.newId,type:"way",nodesIds:[],distance:e.distance};return e.nodesIds.forEach((t=>s.nodesIds.push(this.#cloneNode(t)))),this.#nodesMap.get(this.firstOf(s.nodesIds)).startingWaysIds.push(s.id),this.#nodesMap.get(this.lastOf(s.nodesIds)).endingWaysIds.push(s.id),this.#waysMap.set(s.id,s),s.id}createMaps(t){this.#waysMap.clear(),this.#nodesMap.clear(),this.#stopsMap.clear(),t.forEach((t=>{switch(t.type){case"way":t.nodesIds=t.nodes,delete t.nodes,2<=t.nodesIds.length&&(t.distance=0,this.#waysMap.set(t.id,t));break;case"node":t.startingWaysIds=[],t.endingWaysIds=[],t.isNode3Ways=!1,this.#nodesMap.set(t.id,t);break;case"relation":t.members.forEach((t=>{"node"===t.type&&t.role&&"stop"===t.role&&this.#stopsMap.set(t.ref,t.ref)}))}})),this.#stopsMap.forEach((t=>{let e=this.#nodesMap.get(t);e?this.#stopsMap.set(t,e):(window.TaN.showInfo("the relation "+this.#selectedRelationId+" have nodes not positionned on the railway ( node "+t+")."),this.#stopsMap.delete(t))})),this.#waysMap.forEach((t=>{this.#nodesMap.get(this.firstOf(t.nodesIds)).startingWaysIds.push(t.id),this.#nodesMap.get(this.lastOf(t.nodesIds)).endingWaysIds.push(t.id);let e=null;t.nodesIds.forEach((s=>{let i=this.#nodesMap.get(s);e&&(t.distance+=J.pointsDistance([i.lat,i.lon],[e.lat,e.lon])),e=i}))}))}}class Q{#publicTransportData=null;#computeDistances(t,e,s){t.isNode3Ways||e.isNode3Ways||s.push({distance:J.pointsDistance([t.lat,t.lon],[e.lat,e.lon]),nodesId:[t.id,e.id]})}#removeHoles(){let t=[],e=Array.from(this.#publicTransportData.waysMap.values()),s=1;e.forEach((i=>{for(let a=s;a<e.length;a++){let s=[];s.push(this.#publicTransportData.nodesMap.get(this.#publicTransportData.firstOf(i.nodesIds))),s.push(this.#publicTransportData.nodesMap.get(this.#publicTransportData.lastOf(i.nodesIds))),s.push(this.#publicTransportData.nodesMap.get(this.#publicTransportData.firstOf(e[a].nodesIds))),s.push(this.#publicTransportData.nodesMap.get(this.#publicTransportData.lastOf(e[a].nodesIds))),this.#computeDistances(s[0],s[2],t),this.#computeDistances(s[0],s[3],t),this.#computeDistances(s[1],s[2],t),this.#computeDistances(s[1],s[3],t)}s++}));let i=t[0];t.forEach((t=>{t.distance<i.distance&&(i=t)}));let a={id:this.#publicTransportData.newId,type:"way",nodesIds:i.nodesId,distance:i.distance};this.#publicTransportData.waysMap.set(a.id,a);let n=this.#publicTransportData.nodesMap.get(i.nodesId[0]),r=n.startingWaysIds.concat(n.endingWaysIds)[0];n.startingWaysIds.push(a.id);let o=this.#publicTransportData.nodesMap.get(i.nodesId[1]),l=o.startingWaysIds.concat(o.endingWaysIds)[0];o.endingWaysIds.push(a.id),this.#publicTransportData.mergeWays(this.#publicTransportData.mergeWays(a.id,r),l),this.#publicTransportData.waysMap.size>2*this.#publicTransportData.nodes3WaysCounter+1&&this.#removeHoles()}constructor(t){this.#publicTransportData=t}removeHoles(){this.#removeHoles()}}class q{#selectedRelationId=r;#nodes3Ways=[];#route=null;#publicTransportData=null;#merge3WaysNodes(){this.#nodes3Ways.forEach((t=>{let e=Number.MAX_VALUE,s=null,i=t.startingWaysIds.concat(t.endingWaysIds);i.forEach((t=>{let i=this.#publicTransportData.waysMap.get(t);i.distance<e&&(e=i.distance,s=i)})),this.#publicTransportData.removeFrom(i,s.id);let a=this.#publicTransportData.waysMap.get(this.#publicTransportData.cloneWay(s.id)),n=null;this.#publicTransportData.firstOf(s.nodesIds)===t.id?(a.nodesIds.pop(),a.nodesIds.push(this.#publicTransportData.lastOf(s.nodesIds)),n=this.#publicTransportData.firstOf(a.nodesIds)):(a.nodesIds.shift(),a.nodesIds.unshift(this.#publicTransportData.firstOf(s.nodesIds)),n=this.#publicTransportData.lastOf(a.nodesIds));let r=this.#publicTransportData.waysMap.get(i[1]);r.nodesIds[r.nodesIds.indexOf(t.id)]=n,this.#publicTransportData.mergeWays(this.#publicTransportData.mergeWays(this.#publicTransportData.mergeWays(s.id,a.id),i[0]),r.id)}))}#createRoute(t){let e=null,s=null,i=Number.MAX_VALUE,a=Number.MAX_VALUE;this.#publicTransportData.stopsMap.forEach((t=>{let n=J.pointsDistance([t.lat,t.lon],this.#route.wayPoints.first.latLng);n<i&&(i=n,e=t),n=J.pointsDistance([t.lat,t.lon],this.#route.wayPoints.last.latLng),n<a&&(a=n,s=t)})),t.itinerary.itineraryPoints.removeAll(),t.itinerary.maneuvers.removeAll(),t.itinerary.hasProfile=!1,t.itinerary.ascent=0,t.itinerary.descent=0;let n=0,r=!1;Array.from(this.#publicTransportData.waysMap.values())[0].nodesIds.forEach((i=>{if(0!==n||i!==e.id&&i!==s.id?2!==n||i!==e.id&&i!==s.id||(n=3):(n=1,r=i===s.id),0<n&&4>n){let a=new D,n=this.#publicTransportData.nodesMap.get(i);a.latLng=[n.lat,n.lon],t.itinerary.itineraryPoints.add(a);let r=this.#publicTransportData.stopsMap.get(i);if(r){let i=new I,n=null;r.tags&&r.tags.name&&(n=r.tags.name,i.instruction=n+"&nbsp;:&nbsp;"),r.id===e.id?(n&&(t.wayPoints.first.name=n),i.iconName="kTrainStart",i.instruction+="Monter dans le train"):r.id===s.id?(n&&(t.wayPoints.last.name=n),i.iconName="kTrainEnd",i.instruction+="Descendre du train"):(i.iconName="kTrainContinue",i.instruction+="Rester dans le train"),i.distance=0,i.duration=0,i.itineraryPointObjId=a.objId,t.itinerary.maneuvers.add(i)}}1===n&&(n=2),3===n&&(n=4)})),r&&(t.itinerary.itineraryPoints.reverse(),t.itinerary.maneuvers.reverse()),t.distance=0;let o=t.itinerary.maneuvers.iterator;o.done;let l=o.value;o.done;let d=t.itinerary.itineraryPoints.iterator;d.done;let h=d.value;for(;!d.done;)d.value.distance=0,h.distance=J.pointsDistance(h.latLng,d.value.latLng),t.distance+=h.distance,l.distance+=h.distance,o.value.itineraryPointObjId===d.value.objId&&(l=o.value,l.distance=0,o.done),h=d.value}constructor(t,e){this.#route=t,this.#selectedRelationId=e,this.#publicTransportData=new G(e)}buildRoute(t,e,s){this.#nodes3Ways=[],this.#publicTransportData.nodes3WaysCounter=0,this.#publicTransportData.createMaps(t.elements);let i=!1;this.#publicTransportData.nodesMap.forEach((t=>{let e=t.startingWaysIds.concat(t.endingWaysIds);switch(e.length){case 0:case 1:break;case 2:this.#publicTransportData.mergeWays(e[0],e[1]);break;case 3:t.isNode3Ways=!0,this.#nodes3Ways.push(t),this.#publicTransportData.nodes3WaysCounter++;break;default:i=!0,window.TaN.showInfo("A node with more than 3 ways is found : "+t.id+" - the relation "+this.#selectedRelationId+" - ways "+t.startingWaysIds.concat(t.endingWaysIds))}})),i?s(new Error("A node with more than 3 ways was found in the relation.See the console for more infos")):(this.#publicTransportData.waysMap.size>2*this.#publicTransportData.nodes3WaysCounter+1&&(new Q(this.#publicTransportData).removeHoles(),window.TaN.showInfo("Holes found in the OSM relation number "+this.#selectedRelationId+". Try to correct OSM data.")),0<this.#publicTransportData.nodes3WaysCounter&&this.#merge3WaysNodes(),this.#createRoute(this.#route),e(this.#route))}}
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file BaseRouteProvider.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/window.TaN.addProvider(class extends class{#userLanguage="fr";#providerKey="";#route=null;#getRoute(t,e){}constructor(){Object.seal(this)}get icon(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAIAAAC0Ujn1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAArSURBVEhL7cyxDQAgAAQh91/67ektTI4BOHumGtWoRjWqUY1qVKMaP9bbBZKXggu6NeCUAAAAAElFTkSuQmCC"}getPromiseRoute(t){return this.#route=t,new Promise(((t,e)=>this.#getRoute(t,e)))}get name(){return""}get title(){return""}get transitModes(){return[]}get providerKeyNeeded(){return!0}get providerKey(){return this.#providerKey.length}set providerKey(t){this.#providerKey=t}get userLanguage(){return this.#userLanguage}set userLanguage(t){this.#userLanguage=t}}{#userLanguage="fr";#providerKey="";#route=null;#parseResponse(t,e,s){new q(this.#route).buildRoute(t,e,s)}#getWaysNodesUrl(t){return window.TaN.overpassApiUrl+"?data=[out:json];rel("+t.toFixed(0)+');way(r)->.e;way.e["railway"="rail"];(._;>;rel('+t.toFixed(0)+"););out;"}#getDialogPromise(t){if(0===t.elements.length)return Promise.reject(new Error("No relations found"));let e=[];return t.elements.forEach((t=>{e.push({text:t.tags.name,objId:t.id})})),new Z({title:"Relations",text:"select a relation : ",selectOptionsData:e}).show()}#getRelationsUrl(){return window.TaN.overpassApiUrl+'?data=[out:json];node["public_transport"="stop_position"]["train"="yes"](around:400.0,'+this.#route.wayPoints.first.lat.toFixed(s.fixed)+","+this.#route.wayPoints.first.lng.toFixed(s.fixed)+')->.s;rel(bn.s)->.s;node["public_transport"="stop_position"]["train"="yes"](around:400.0,'+this.#route.wayPoints.last.lat.toFixed(s.fixed)+","+this.#route.wayPoints.last.lng.toFixed(s.fixed)+")->.e;rel(bn.e)->.e;rel.e.s;out tags;"}#getRoute(t,e){fetch(this.#getRelationsUrl()).then((s=>{200===s.status&&s.ok?s.json().then((t=>this.#getDialogPromise(t))).then((t=>fetch(this.#getWaysNodesUrl(t)))).then((s=>{200===s.status&&s.ok?s.json().then((s=>this.#parseResponse(s,t,e))):e(new Error("An error occurs..."))})).catch((()=>e(new Error("An error occurs...")))):e(new Error("An error occurs..."))}))}constructor(){super()}get icon(){return'data:image/svg+xml;utf8,<svg viewBox="-3 -3 20 20" xmlns="http://www.w3.org/2000/svg"> <g fill="rgb(128,0,0)"><path d="M 5,0 C 3.025911,-0.0084 1,3 1,7 l 0,2 c 0,1 1,2 2,2 l 8,0 c 1,0 2,-1 2,-2 L 13,7 C 13,3 11,0 9,0 z m -1,3 6,0 c 0,0 1,1 1,3 L 3.03125,6 C 2.994661,3.9916 4,3 4,3 z M 3,8 6,8 6,9 3,9 z m 5,0 3,0 0,1 -3,0 z m -6,4 -1,2 3,0 1,-2 z m 7,0 1,2 3,0 -1,-2 z"/></g></svg>'}getPromiseRoute(t){return this.#route=t,new Promise(((t,e)=>this.#getRoute(t,e)))}get name(){return"PublicTransport"}get title(){return"Public Transport on OpenStreetMap"}get transitModes(){return["train"]}get providerKeyNeeded(){return!1}get providerKey(){return 1}set providerKey(t){}get userLanguage(){return this.#userLanguage}set userLanguage(t){this.#userLanguage=t}})}();