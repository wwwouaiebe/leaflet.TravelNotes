/**
 * 
 * @source: https://github.com/wwwouaiebe/leaflet.TravelNotes
 * 
 * @licstart  The following is the entire license notice for the
 * JavaScript code in this page.
 * 
 * leaflet.travelnotes - version 3.0.0
 * Build 02774 - 2021-09-08T11:44:38+0200 
 * Copyright 2017 2021 wwwouaiebe 
 * Contact: https://www.ouaie.be/
 * License: GPL-3.0
 * 
 * The JavaScript code in this page is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 * 
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 * 
 * @licend  The above is the entire license notice
 * for the JavaScript code in this page.
 * 
 */


!function(){"use strict";
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Constants.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/Object.freeze({minColorValue:0,maxColorValue:255,rowsNumber:6,cellsNumber:6,deltaColor:51,sliderMaxValue:100,sliderStep:20,initialRed:0}),Object.freeze({notSaved:"🔴",modified:"🟡",saved:"🟢"});const t=Object.freeze({fixed:2,invalid:-1,defaultValue:0,metersInKm:1e3});Object.freeze({refusedByUser:-1,disabled:0,inactive:1,active:2}),Object.freeze({invalidPane:"43a6a53e-008a-4910-80a6-7a87d301ea15",itineraryPane:"8fbf0da7-4e6f-4bc7-8e20-1388461ccde7",travelNotesPane:"dffe782b-07df-4b81-a318-f287c0cf5ec6",searchPane:"228f00d7-43a8-4c13-897d-70400cb6dd58"});const e=Object.freeze({fixed:2,defaultValue:0}),s=Object.freeze({defaultValue:0,fixed:6,maxLat:90,minLat:-90,maxLng:180,minLng:-180}),i=Object.freeze({notEdited:0,editedNoChange:1,editedChanged:2});Object.freeze({margin:100,height:500,width:1e3,yDeltaText:30,xDeltaText:10,vScales:[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3],hScales:[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5]});const a=Object.freeze({width:40,height:40,svgViewboxDim:200}),n=Object.freeze({d0:0,d90:90,d180:180,d270:270,d360:360,d540:540,toRadians:Math.PI/180,fromRadians:180/Math.PI});Object.freeze({atStart:-1,onRoute:0,atEnd:1});const r=-1,o=-1,l=6371e3,d=20;const h=new
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file HTMLElementsFactory.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/
class{_addProperties(t,e){for(let s in e)try{if("dataset"===s){let s=e.dataset;for(let e in s)t.dataset["tan"+e]=s[e]}else t[s]=e[s]}catch(t){t instanceof Error&&console.error(t)}t.target&&(t.rel="noopener noreferrer")}constructor(){}create(t,e,s){let i=null;return"text"===t.toLowerCase()?i=document.createTextNode(e.value||""):(i="select"===t.toLowerCase()?document.createElement(t):Object.seal(document.createElement(t)),e&&this._addProperties(i,e)),s&&s.appendChild(i),i}};const c=Object.freeze(new class{_validityMap=new Map;_parser=new DOMParser;_addHtmlEntities(t){return t.replaceAll(/</g,"&lt;").replaceAll(/>/g,"&gt;").replaceAll(/"/g,"&quot;").replaceAll(/\u0027/g,"&apos;").replaceAll(/\u0a00/g,"&nbsp;")}_stringify(t){let e="",s="",i=t.childNodes;for(let a=0;a<i.length;a++){let i=t.childNodes[a],n=i.nodeName.toLowerCase(),r=this._validityMap.get(n);if(r){r=r.concat(["id","class","dir","title","tanwidth","tanheight"]);let t="svg"===n||"text"===n||"polyline"===n;e+="<"+n,i.hasAttribute("target")&&(e+=' rel="noopener noreferrer"'),r.forEach((a=>{if(t)i.hasAttributeNS(null,a)&&(e+=" "+a+'="'+this._addHtmlEntities(i.getAttribute(a))+'"',i.removeAttribute(a));else if(i.hasAttribute(a))if("href"===a||"src"===a){let t=this.sanitizeToUrl(i.getAttribute(a),a).url;""===t?s+="\nAn invalid url ("+i.getAttribute(a)+") was removed from a "+a+" attribute":e+=" "+a+'="'+t+'"',i.removeAttribute(a)}else e+=" "+a+'="'+this._addHtmlEntities(i.getAttribute(a))+'"',i.removeAttribute(a)})),e+=">";let a="",o="";[a,o]=this._stringify(i),e+=a,s+=o,e+="</"+n+">"}else"#text"===n?e+=this._addHtmlEntities(i.nodeValue):s+="\nAn invalid tag "+n+" was removed";if(i.hasAttributes)for(let t=0;t<i.attributes.length;t++)"rel"!==i.attributes[t].name&&(s+="\nAn unsecure attribute "+i.attributes[t].name+'="'+i.attributes[t].value+'" was removed.')}return[e,s]}_cloneNode(t,e){let s=t.childNodes;for(let i=0;i<s.length;i++){let s=t.childNodes[i],a=s.nodeName.toLowerCase(),n=this._validityMap.get(a);if(n){n=n.concat(["id","class","dir","title","tanwidth","tanheight"]);let t="svg"===a||"text"===a||"polyline"===a,i=t?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a);if(n.forEach((e=>{if(t)s.hasAttributeNS(null,e)&&(i.setAttributeNS(null,e,s.getAttribute(e)),s.removeAttributeNS(null,e));else if(s.hasAttribute(e))if("href"===e||"src"===e){let t=this.sanitizeToUrl(s.getAttribute(e),e).url;""!==t&&i.setAttribute(e,t)}else i.setAttribute(e,s.getAttribute(e))})),s.hasAttribute("style")){s.getAttribute("style").split(";").forEach((t=>{let e=t.split(":");2!==e.length||"width"!==e[0].trim()&&"height"!==e[0].trim()||(i.style[e[0].trim()]=e[1].trim())}))}s.hasAttribute("target")&&i.setAttribute("rel","noopener noreferrer"),e.appendChild(i),this._cloneNode(s,i)}else"#text"===a&&e.appendChild(document.createTextNode(s.nodeValue))}}constructor(){this._validityMap.set("a",["href","target"]),this._validityMap.set("div",[]),this._validityMap.set("del",[]),this._validityMap.set("em",[]),this._validityMap.set("figcaption",[]),this._validityMap.set("figure",[]),this._validityMap.set("h1",[]),this._validityMap.set("h2",[]),this._validityMap.set("h3",[]),this._validityMap.set("h4",[]),this._validityMap.set("h5",[]),this._validityMap.set("h6",[]),this._validityMap.set("hr",[]),this._validityMap.set("img",["src","alt","width","height"]),this._validityMap.set("ins",[]),this._validityMap.set("li",[]),this._validityMap.set("mark",[]),this._validityMap.set("ol",[]),this._validityMap.set("p",[]),this._validityMap.set("s",[]),this._validityMap.set("small",[]),this._validityMap.set("strong",[]),this._validityMap.set("span",[]),this._validityMap.set("sub",[]),this._validityMap.set("sup",[]),this._validityMap.set("ul",[]),this._validityMap.set("svg",["xmlns","viewBox","class"]),this._validityMap.set("text",["x","y","text-anchor"]),this._validityMap.set("polyline",["points","class","transform"])}sanitizeToColor(t){let e=t.match(/^\u0023[0-9,A-F,a-f]{6}$/);return e?e[0]:null}sanitizeToUrl(t,e="href"){let s=this._parser.parseFromString("<div>"+t+"</div>","text/html");if(!s||"#document"!==s.nodeName)return{url:"",errorsString:"Parsing error"};let i=s.body.firstChild,a="";for(let t=0;t<i.childNodes.length;t++){if("#text"!==i.childNodes[t].nodeName)return{url:"",errorsString:"Invalid characters found in the url"};a+=i.childNodes[t].nodeValue}if(a=a.replaceAll(/</g,"").replaceAll(/>/g,"").replaceAll(/"/g,"").replaceAll(/\u0027/g,"").replaceAll(/&lt;/g,"").replaceAll(/&gt;/g,"").replaceAll(/&quot;/g,"").replaceAll(/&apos;/g,"").replaceAll(/%3C/g,"").replaceAll(/%3c/g,"").replaceAll(/%3E/g,"").replaceAll(/%3e/g,"").replaceAll(/%22/g,"").replaceAll(/%27/g,""),a!==t)return{url:"",errorsString:"Invalid characters found in the url"};let n=["https:"];if("http:"!==window.location.protocol&&"href"!==e||n.push("http:"),"href"===e){n.push("mailto:"),n.push("sms:"),n.push("tel:");let t=a.match(/^\u0023\w*/);if(t&&a===t[0])return{url:a,errorsString:""}}"src"===e&&n.push("data:");let r=null;try{r=new URL(a)}catch(t){return{url:"",errorsString:"Invalid url string"}}if(o===n.indexOf(r.protocol))return{url:"",errorsString:"Invalid protocol "+r.protocol};if(o!==["sms:","tel:"].indexOf(r.protocol)&&r.pathname.match(/^\+[0-9,*,\u0023]*$/))return{url:a,errorsString:""};try{encodeURIComponent(r.href)}catch(t){return{url:"",errorsString:"Invalid character in url"}}return{url:a,errorsString:""}}sanitizeToJsString(t){let e=this._parser.parseFromString("<div>"+t+"</div>","text/html");if(!e||"#document"!==e.nodeName)return"";let s=e.body.firstChild,i="";for(let t=0;t<s.childNodes.length;t++){if("#text"!==s.childNodes[t].nodeName)return"";i+=s.childNodes[t].nodeValue}return i=i.replaceAll(/</g,"≺").replaceAll(/>/g,"≻").replaceAll(/"/g,"″").replaceAll(/\u0027/g,"′"),i}sanitizeToHtmlElement(t,e){let s=this._parser.parseFromString("<div>"+t+"</div>","text/html");s&&"#document"===s.nodeName?this._cloneNode(s.body.firstChild,e):e.textContent=""}clone(t){let e=document.createElement(t.tagName);return this._cloneNode(t,e),e}sanitizeToHtmlString(t){let e="",s="",i=this._parser.parseFromString("<div>"+t.replace("&nbsp;","਀")+"</div>","text/html");return i&&"#document"===i.nodeName?([e,s]=this._stringify(i.body.firstChild,s),{htmlString:e,errorsString:s}):{htmlString:"",errorsString:"Parsing error"}}});const u=new class{_translations=new Map;constructor(){}setTranslations(t){t.forEach((t=>this._translations.set(t.msgid,c.sanitizeToJsString(t.msgstr))))}getText(t,e){let s=this._translations.get(t);return e&&s&&Object.getOwnPropertyNames(e).forEach((t=>s=s.replace("{"+t+"}",e[t]))),s||t}};class p{static _objId=0;static get nextObjId(){return++p._objId}}
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Version.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/const g="2.3.0";class _{_objTypeName="";_validObjTypeNames=["Itinerary","ItineraryPoint","Maneuver","Note","Route","Travel","WayPoint"];constructor(t){if(o===this._validObjTypeNames.indexOf(t))throw new Error("Invalid ObjType name : "+t);this._objTypeName=t}get name(){return this._objTypeName}get version(){return g}get jsonObject(){return{name:this._objTypeName,version:g}}validate(t){if(!Object.getOwnPropertyNames(t).includes("name"))throw new Error("No name for "+this._objTypeName);if(this._objTypeName!==t.name)throw new Error("Invalid name for "+this._objTypeName);if(!Object.getOwnPropertyNames(t).includes("version"))throw new Error("No version for "+this._objTypeName)}}class v{_collection=null;_index=o;constructor(t){this._collection=t}get value(){return this._index<this._collection.length?this._collection.at(this._index):null}get previous(){return 0>=this._index?null:this._collection.at(this._index-1)}get next(){return this._index<this._collection.length-1?this._collection.at(this._index+1):null}get done(){return++this._index>=this._collection.length}get first(){return 0===this._index}get last(){return this._index>=this._collection.length-1}get index(){return this._index}}class b{_array=[];_objName="";_classCollection=null;_indexOfObjId(t){return this._array.findIndex((e=>e.objId===t))}_nextOrPrevious(t,e,s){let i=this._indexOfObjId(t);if(o===i)throw new Error("invalid objId for next or previous function");if(1!==s&&-1!==s)throw new Error("invalid direction");let a=e;for(a||(a=()=>!0),i+=s;o<i&&i<this._array.length&&!a(this._array[i]);)i+=s;return o===i||this._array.length===i?null:this._array[i]}constructor(t){this._classCollection=t;let e=new t;if(!e.objType||!e.objType.name)throw new Error("invalid object name for collection");this._objName=e.objType.name}add(t){if(!t.objType||!t.objType.name||t.objType.name!==this._objName)throw new Error("invalid object name for add function");this._array.push(t)}at(t){return t<this._array.length&&t>o?this._array[t]:null}forEach(t){let e=null,s=this.iterator;for(;!s.done;)e=t(s.value,e);return e}getAt(t){let e=this._indexOfObjId(t);return o===e?null:this._array[e]}moveTo(t,e,s){let i=this._indexOfObjId(t),a=this._indexOfObjId(e);if(o===i||o===a)throw new Error("invalid objId for function  myMoveTo");s||a++,this._array.splice(a,0,this._array[i]),a<i&&i++,this._array.splice(i,1)}next(t,e){return this._nextOrPrevious(t,e,1)}previous(t,e){return this._nextOrPrevious(t,e,-1)}remove(t){let e=this._indexOfObjId(t);if(o===e)throw new Error("invalid objId for remove function");this._array.splice(this._indexOfObjId(t),1)}removeAll(t){t?this._array.splice(1,this._array.length-2):this._array.length=0}replace(t,e){let s=this._indexOfObjId(t);if(o===s)throw new Error("invalid objId for replace function");if(!e.objType||!e.objType.name||e.objType.name!==this._objName)throw new Error("invalid object name for replace function");this._array[s]=e}reverse(){this._array.reverse()}sort(t){this._array.sort(t)}swap(t,e){let s=this._indexOfObjId(t);if(o===s||0===s&&e||this._array.length-1===s&&!e)throw new Error("invalid objId for swap function");let i=this._array[s];this._array[s]=this._array[s+(e?-1:1)],this._array[s+(e?-1:1)]=i}get first(){return this._array[0]}get iterator(){return new v(this)}get last(){return this._array[this._array.length-1]}get length(){return this._array.length}get jsonObject(){let t=[],e=this.iterator;for(;!e.done;)t.push(e.value.jsonObject);return t}set jsonObject(t){this._array.length=0;let e=null;t.forEach((t=>{e=new this._classCollection,e.jsonObject=t,this.add(e)}))}}
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Config.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/let m={color:"#ff0000",dashArray:0,dashChoices:[{text:"——————",iDashArray:[0]},{text:"— — — — —",iDashArray:[4,2]},{text:"—‧—‧—‧—‧—",iDashArray:[4,2,0,2]},{text:"················",iDashArray:[0,2]}],elev:{smooth:!0,smoothCoefficient:.25,smoothPoints:3},showDragTooltip:3,width:3};const y=new class{constructor(){}get UUID(){let t=new Uint8Array(16);const e=["","","","-","","-","","-","","-","","","","","",""];window.crypto.getRandomValues(t),t[6]=15&t[6]|64,t[8]=63&t[8]|128;let s="";for(let i=0;i<16;i++)s+=t[i].toString(16).padStart(2,"0")+e[i];return s}storageAvailable(t){try{let e=window[t],s="__storage_test__";return e.setItem(s,s),e.removeItem(s),!0}catch(t){return!1}}openFile(t,e){let s=document.createElement("input");s.type="file",e&&(s.accept=e),s.addEventListener("change",t,!1),s.click()}saveFile(t,e,s){try{let i=null;i=s?window.URL.createObjectURL(new File([e],t,{type:s})):URL.createObjectURL(e);let a=document.createElement("a");a.setAttribute("href",i),a.setAttribute("download",t),a.click(),window.URL.revokeObjectURL(i)}catch(t){t instanceof Error&&console.error(t)}}formatTime(t){let e=Math.floor(t);if(0===e)return"";let s=Math.floor(e/86400),i=Math.floor(e%86400/3600),a=Math.floor(e%3600/60),n=Math.floor(e%60);return 0<s?s+" "+u.getText("Utilities - Day")+" "+i+" "+u.getText("Utilities - Hour"):0<i?i+" "+u.getText("Utilities - Hour")+" "+a+" "+u.getText("Utilities - Minute"):0<a?a+" "+u.getText("Utilities - Minute"):n+" "+u.getText("Utilities - Second")}formatDistance(e){let s=Math.floor(e);return 0>=s?"0 km":Math.floor(s/t.metersInKm)+","+Math.floor(s%t.metersInKm/10).toFixed(0).padStart(2,"0").padEnd(3,"0")+" km"}formatLat(t){return t>0?t.toFixed(s.fixed)+" N":(-t).toFixed(s.fixed)+" S"}formatLng(t){return t>0?t.toFixed(s.fixed)+" E":(-t).toFixed(s.fixed)+" W"}formatLatLng(t){return 0===t[0]&&0===t[1]?"":this.formatLat(t[0])+" - "+this.formatLng(t[1])}},f=new _("WayPoint");class w{_objId=r;_upgradeObject(t){switch(t.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":t.address=t.name,t.name="";case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+f.name)}}_validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+f.name);f.validate(t.objType),f.version!==t.objType.version&&this._upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["address","name","lat","lng","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+f.name)})),t}constructor(){this.name="",this.address="",this.lat=s.defaultValue,this.lng=s.defaultValue,this._objId=p.nextObjId}get fullName(){let t=""===this.name?this.address:this.name+", "+this.address;return""===t&&(t=y.formatLatLng([this.lat,this.lng])),t}get latLng(){return[this.lat,this.lng]}set latLng(t){this.lat=t[0],this.lng=t[1]}get objId(){return this._objId}get objType(){return f}get jsonObject(){return{name:this.name,address:this.address,lat:parseFloat(this.lat.toFixed(s.fixed)),lng:parseFloat(this.lng.toFixed(s.fixed)),objId:this._objId,objType:f.jsonObject}}set jsonObject(t){let e=this._validateObject(t);this.address=e.address||"",this.name=e.name||"",this.lat=e.lat||s.defaultValue,this.lng=e.lng||s.defaultValue,this._objId=p.nextObjId,this.validateData()}validateData(){"string"==typeof this.address?this.address=c.sanitizeToJsString(this.address):this.address="","string"==typeof this.name?this.name=c.sanitizeToJsString(this.name):this.name="","number"!=typeof this.lat&&(this.lat=s.defaultValue),"number"!=typeof this.lng&&(this.lng=s.defaultValue)}}const j=new _("ItineraryPoint");class D{_objId=r;_upgradeObject(t){switch(t.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":t.elev=e.defaultValue;case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+j.name)}}_validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+j.name);j.validate(t.objType),j.version!==t.objType.version&&this._upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["lat","lng","distance","elev","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+j.name)})),t}constructor(){this.lat=s.defaultValue,this.lng=s.defaultValue,this.distance=t.defaultValue,this.elev=e.defaultValue,this._objId=p.nextObjId}get latLng(){return[this.lat,this.lng]}set latLng(t){this.lat=t[0],this.lng=t[1]}get objType(){return j}get objId(){return this._objId}get jsonObject(){return{lat:parseFloat(this.lat.toFixed(s.fixed)),lng:parseFloat(this.lng.toFixed(s.fixed)),distance:parseFloat(this.distance.toFixed(t.fixed)),elev:parseFloat(this.elev.toFixed(e.fixed)),objId:this._objId,objType:j.jsonObject}}set jsonObject(i){let a=this._validateObject(i);this.lat=a.lat||s.defaultValue,this.lng=a.lng||s.defaultValue,this.distance=a.distance||t.defaultValue,this.elev=a.elev||e.defaultValue,this._objId=p.nextObjId,this.validateData()}validateData(){"number"!=typeof this.lat&&(this.lat=s.defaultValue),"number"!=typeof this.lng&&(this.lng=s.defaultValue),"number"!=typeof this.distance&&(this.distance=t.defaultValue),"number"!=typeof this.elev&&(this.elev=e.defaultValue)}}const T=new _("Maneuver");class O{_objId=r;_upgradeObject(e){switch(e.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":"kArriveDefault"===e.iconName&&(e.distance=t.defaultValue);case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":e.objType.version="2.3.0";break;default:throw new Error("invalid version for "+T.name)}}_validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+T.name);T.validate(t.objType),T.version!==t.objType.version&&this._upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["iconName","instruction","distance","duration","itineraryPointObjId","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+T.name)})),t}constructor(){this.iconName="",this.instruction="",this.itineraryPointObjId=r,this.distance=t.defaultValue,this.duration=t.defaultValue,this._objId=p.nextObjId}get objType(){return T}get objId(){return this._objId}get jsonObject(){return{iconName:this.iconName,instruction:this.instruction,distance:parseFloat(this.distance.toFixed(t.fixed)),duration:this.duration,itineraryPointObjId:this.itineraryPointObjId,objId:this._objId,objType:T.jsonObject}}set jsonObject(e){let s=this._validateObject(e);this.iconName=s.iconName||"",this.instruction=s.instruction||"",this.distance=s.distance||t.defaultValue,this.duration=s.duration||t.defaultValue,this.itineraryPointObjId=s.itineraryPointObjId||r,this._objId=p.nextObjId,this.validateData()}validateData(){"string"==typeof this.iconName?this.iconName=c.sanitizeToJsString(this.iconName):this.iconName="","string"==typeof this.instruction?this.instruction=c.sanitizeToJsString(this.instruction):this.instruction="","number"!=typeof this.distance&&(this.distance=t.defaultValue),"number"!=typeof this.duration&&(this.duration=t.defaultValue),"number"!=typeof this.itineraryPointObjId&&(this.itineraryPointObjId=r)}}const I=new _("Itinerary");class L{_objId=r;_upgradeObject(t){switch(t.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":t.hasProfile=!1,t.ascent=0,t.descent=0;case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+I.name)}}_validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+I.name);I.validate(t.objType),I.version!==t.objType.version&&this._upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["hasProfile","ascent","descent","itineraryPoints","maneuvers","provider","transitMode","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+I.name)})),t}constructor(){this.hasProfile=!1,this.ascent=0,this.descent=0,this.provider="",this.transitMode="",this.itineraryPoints=new b(D),this.maneuvers=new b(O),this._objId=p.nextObjId}get objType(){return I}get objId(){return this._objId}get jsonObject(){return{hasProfile:this.hasProfile,ascent:this.ascent,descent:this.descent,itineraryPoints:this.itineraryPoints.jsonObject,maneuvers:this.maneuvers.jsonObject,provider:this.provider,transitMode:this.transitMode,objId:this._objId,objType:I.jsonObject}}set jsonObject(t){let e=this._validateObject(t);this.hasProfile=e.hasProfile||!1,this.ascent=e.ascent||0,this.descent=e.descent||0,this.itineraryPoints.jsonObject=e.itineraryPoints||[],this.maneuvers.jsonObject=e.maneuvers||[],this.provider=e.provider||"",this.transitMode=e.transitMode||"",this._objId=p.nextObjId;let s=new Map,i=0,a=this.itineraryPoints.iterator;for(;!a.done;)s.set(e.itineraryPoints[i].objId,a.value.objId),i++;let n=this.maneuvers.iterator;for(;!n.done;)n.value.itineraryPointObjId=s.get(n.value.itineraryPointObjId);this.validateData()}validateData(){"boolean"!=typeof this.hasProfile&&(this.hasProfile=!1),"number"!=typeof this.ascent&&(this.ascent=0),"number"!=typeof this.descent&&(this.descent=0),"string"==typeof this.provider?this.provider=c.sanitizeToJsString(this.provider):this.provider="","string"==typeof this.transitMode?this.transitMode=c.sanitizeToJsString(this.transitMode):this.transitMode=""}}const N=new _("Note");class M{_objId=r;_UpdateStyles(t){return t.replaceAll(/style='color:white;background-color:red'/g,"class='TravelNotes-Note-WhiteRed'").replaceAll(/style='color:white;background-color:green'/g,"class='TravelNotes-Note-WhiteGreen'").replaceAll(/style='color:white;background-color:blue'/g,"class='TravelNotes-Note-WhiteBlue'").replaceAll(/style='color:white;background-color:brown'/g,"class='TravelNotes-Note-WhiteBrown'").replaceAll(/style='color:white;background-color:black'/g,"class='TravelNotes-Note-WhiteBlack'").replaceAll(/style='border:solid 0.1em'/g,"class='TravelNotes-Note-BlackWhite'").replaceAll(/style='background-color:white;'/g,"class='TravelNotes-Note-Knooppunt'").replaceAll(/style='fill:green;font:bold 120px sans-serif;'/g,"").replaceAll(/style='fill:none;stroke:green;stroke-width:10;'/g,"")}_upgradeObject(t){switch(t.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":"string"==typeof t.iconHeight&&(t.iconHeight=Number.parseInt(t.iconHeight)),"string"==typeof t.iconWidth&&(t.iconWidth=Number.parseInt(t.iconWidth)),t.iconContent=this._UpdateStyles(t.iconContent),t.popupContent=this._UpdateStyles(t.popupContent),t.tooltipContent=this._UpdateStyles(t.tooltipContent),t.phone=this._UpdateStyles(t.phone),t.address=this._UpdateStyles(t.address);case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+N.name)}}_validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+N.name);N.validate(t.objType),N.version!==t.objType.version&&this._upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["iconHeight","iconWidth","iconContent","popupContent","tooltipContent","phone","url","address","iconLat","iconLng","lat","lng","distance","chainedDistance","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+N.name)})),t}constructor(){this.iconHeight=a.height,this.iconWidth=a.width,this.iconContent="",this.popupContent="",this.tooltipContent="",this.phone="",this.url="",this.address="",this.iconLat=s.defaultValue,this.iconLng=s.defaultValue,this.lat=s.defaultValue,this.lng=s.defaultValue,this.distance=t.invalid,this.chainedDistance=t.defaultValue,this._objId=p.nextObjId}get isRouteNote(){return this.distance!==t.invalid}get iconLatLng(){return[this.iconLat,this.iconLng]}set iconLatLng(t){this.iconLat=t[0],this.iconLng=t[1]}get latLng(){return[this.lat,this.lng]}set latLng(t){this.lat=t[0],this.lng=t[1]}get objType(){return N}get objId(){return this._objId}get jsonObject(){return{iconHeight:this.iconHeight,iconWidth:this.iconWidth,iconContent:this.iconContent,popupContent:this.popupContent,tooltipContent:this.tooltipContent,phone:this.phone,url:this.url,address:this.address,iconLat:parseFloat(this.iconLat.toFixed(s.fixed)),iconLng:parseFloat(this.iconLng.toFixed(s.fixed)),lat:parseFloat(this.lat.toFixed(s.fixed)),lng:parseFloat(this.lng.toFixed(s.fixed)),distance:parseFloat(this.distance.toFixed(t.fixed)),chainedDistance:parseFloat(this.chainedDistance.toFixed(t.fixed)),objId:this._objId,objType:N.jsonObject}}set jsonObject(e){let i=this._validateObject(e);this.iconHeight=i.iconHeight||a.height,this.iconWidth=i.iconWidth||a.width,this.iconContent=i.iconContent||"",this.popupContent=i.popupContent||"",this.tooltipContent=i.tooltipContent||"",this.phone=i.phone||"",this.url=i.url||"",this.address=i.address||"",this.iconLat=i.iconLat||s.defaultValue,this.iconLng=i.iconLng||s.defaultValue,this.lat=i.lat||s.defaultValue,this.lng=i.lng||s.defaultValue,this.distance=i.distance||t.invalid,this.chainedDistance=i.chainedDistance||t.defaultValue,this._objId=p.nextObjId,this.validateData(!0)}validateData(e){if("number"!=typeof this.iconHeight&&(this.iconHeight=a.height),"number"!=typeof this.iconWidth&&(this.iconWidth=a.width),"string"==typeof this.iconContent){let t=c.sanitizeToHtmlString(this.iconContent);e&&""!==t.errorsString&&console.log(t.errorsString+" ("+this.iconContent+")"),this.iconContent=t.htmlString}else this.iconContent="";if("string"==typeof this.popupContent){let t=c.sanitizeToHtmlString(this.popupContent);e&&""!==t.errorsString&&console.log(t.errorsString+" ("+this.popupContent+")"),this.popupContent=t.htmlString}else this.popupContent="";if("string"==typeof this.tooltipContent){let t=c.sanitizeToHtmlString(this.tooltipContent);e&&""!==t.errorsString&&console.log(t.errorsString+" ("+this.tooltipContent+")"),this.tooltipContent=t.htmlString}else this.tooltipContent="";if("string"==typeof this.phone){let t=c.sanitizeToHtmlString(this.phone);e&&""!==t.errorsString&&console.log(t.errorsString+" ("+this.phone+")"),this.phone=t.htmlString}else this.phone="";if("string"==typeof this.url&&""!==this.url){let t=c.sanitizeToUrl(this.url);e&&""!==t.errorsString&&console.log(t.errorsString+" ("+this.url+")"),this.url=encodeURI(t.url)}else this.url="";"string"==typeof this.address?this.address=c.sanitizeToHtmlString(this.address).htmlString:this.address="","number"!=typeof this.iconLat&&(this.iconLat=s.defaultValue),"number"!=typeof this.iconLng&&(this.iconLng=s.defaultValue),"number"!=typeof this.lat&&(this.lat=s.defaultValue),"number"!=typeof this.lng&&(this.lng=s.defaultValue),"number"!=typeof this.distance&&(this.distance=t.invalid),"number"!=typeof this.chainedDistance&&(this.chainedDistance=t.defaultValue)}}const E=new _("Route");class x{_objId=r;_upgradeObject(t){switch(t.objType.version){case"1.0.0":t.dashArray=0,t.hidden=!1;case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":t.edited=i.notEdited;case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":t.editionStatus=t.edited;case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+E.name)}}_validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+E.name);E.validate(t.objType),E.version!==t.objType.version&&this._upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["name","wayPoints","notes","itinerary","width","color","dashArray","chain","distance","duration","editionStatus","hidden","chainedDistance","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+E.name)})),t}constructor(){this.name="",this.wayPoints=new b(w),this.wayPoints.add(new w),this.wayPoints.add(new w),this.notes=new b(M),this.itinerary=new L,this.width=m.width,this.color=m.color,this.dashArray=m.dashArray,this.chain=!0,this.chainedDistance=t.defaultValue,this.distance=t.defaultValue,this.duration=t.defaultValue,this.editionStatus=i.notEdited,this.hidden=!1,this._objId=p.nextObjId}get computedName(){let t=this.name;return""===t&&(t=(""===this.wayPoints.first.fullName?"???":this.wayPoints.first.fullName)+" ⮞ "+(""===this.wayPoints.last.fullName?"???":this.wayPoints.last.fullName)),t}get objId(){return this._objId}get objType(){return E}haveValidWayPoints(){let t=!0;return this.wayPoints.forEach((e=>{t=t&&s.defaultValue!==e.lat&&s.defaultValue!==e.lng})),t}get jsonObject(){return{name:this.name,wayPoints:this.wayPoints.jsonObject,notes:this.notes.jsonObject,itinerary:this.itinerary.jsonObject,width:this.width,color:this.color,dashArray:this.dashArray,chain:this.chain,distance:parseFloat(this.distance.toFixed(t.fixed)),duration:this.duration,editionStatus:this.editionStatus,hidden:this.hidden,chainedDistance:parseFloat(this.chainedDistance.toFixed(t.fixed)),objId:this._objId,objType:E.jsonObject}}set jsonObject(t){let e=this._validateObject(t);this.name=e.name||"",this.wayPoints.jsonObject=e.wayPoints||[],this.notes.jsonObject=e.notes||[],this.itinerary.jsonObject=e.itinerary||(new L).jsonObject,this.width=e.width||m.width,this.color=e.color||"#000000",this.dashArray=e.dashArray||0,this.chain=e.chain||!1,this.distance=e.distance,this.duration=e.duration,this.editionStatus=e.editionStatus||i.notEdited,this.hidden=e.hidden||!1,this.chainedDistance=e.chainedDistance,this._objId=p.nextObjId,this.validateData()}validateData(){"string"==typeof this.name?this.name=c.sanitizeToJsString(this.name):this.name="","number"!=typeof this.width&&(this.width=m.width),"string"==typeof this.color?this.color=c.sanitizeToColor(this.color)||m.color:this.color=m.color,"number"!=typeof this.dashArray&&(this.dashArray=0),this.dashArray>=m.dashChoices.length&&(this.dashArray=0),"boolean"!=typeof this.chain&&(this.chain=!1),"number"!=typeof this.distance&&(this.distance=t.defaultValue),"number"!=typeof this.duration&&(this.duration=t.defaultValue),"number"!=typeof this.editionStatus&&(this.editionStatus=i.notEdited),"boolean"!=typeof this.hidden&&(this.hidden=!1),"number"!=typeof this.chainedDistance&&(this.chainedDistance=t.defaultValue)}}const A=new _("Travel");class P{_objId=r;_upgradeObject(t){switch(t.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":t.editedRoute=new x;case"1.5.0":if(t.userData.layerId){let e=[{layerId:"0",layerName:"OSM - Color"},{layerId:"1",layerName:"OSM - Black and White"},{layerId:"2",layerName:"Thunderforest - Transport"},{layerId:"3",layerName:"Thunderforest - OpenCycleMap"},{layerId:"4",layerName:"Thunderforest - Outdoors"},{layerId:"5",layerName:"Esri - Aerial view"},{layerId:"6",layerName:"Kartverket - Norway"},{layerId:"7",layerName:"IGN-NGI - Belgium now"},{layerId:"12",layerName:"Thunderforest - Landscape"},{layerId:"24",layerName:"Lantmäteriet - Sweden"},{layerId:"25",layerName:"Maanmittauslaitos - Finland"}].find((e=>e.layerId===t.userData.layerId));t.layerName=e?e.layerName:"OSM - Color"}else t.layerName="OSM - Color";case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":case"2.0.0":case"2.1.0":case"2.2.0":t.objType.version="2.3.0";break;default:throw new Error("invalid version for "+A.name)}}_validateObject(t){if(!Object.getOwnPropertyNames(t).includes("objType"))throw new Error("No objType for "+A.name);A.validate(t.objType),A.version!==t.objType.version&&this._upgradeObject(t);let e=Object.getOwnPropertyNames(t);return["name","editedRoute","routes","objId"].forEach((t=>{if(!e.includes(t))throw new Error("No "+t+" for "+A.name)})),t}constructor(){this.editedRoute=new x,this.routes=new b(x),this.notes=new b(M),this.layerName="OSM - Color",this.name="",this.readOnly=!1,this._objId=p.nextObjId}get objId(){return this._objId}get objType(){return A}get jsonObject(){return{editedRoute:this.editedRoute.jsonObject,layerName:this.layerName,name:this.name,routes:this.routes.jsonObject,notes:this.notes.jsonObject,readOnly:this.readOnly,objId:this._objId,objType:A.jsonObject}}set jsonObject(t){let e=this._validateObject(t);this.editedRoute.jsonObject=e.editedRoute,this.layerName=t.layerName||"OSM - Color",this.name=e.name||"",this.readOnly=e.readOnly||!1,this.routes.jsonObject=e.routes||[],this.notes.jsonObject=e.notes||[],this._objId=p.nextObjId,this.validateData()}validateData(){"string"==typeof this.layerName?this.layerName=c.sanitizeToJsString(this.layerName):this.layerName="OSM - Color","string"==typeof this.name?this.name=c.sanitizeToJsString(this.name):this.name="TravelNotes","boolean"!=typeof this.readOnly&&(this.readOnly=!0)}}const C=new class{_providers=new Map;_mapObjects=new Map;_routing=Object.seal({provider:"",transitMode:""});_UUID=y.UUID;constructor(){this.map=null,this.travel=new P,this.editedRouteObjId=r,this.searchData=[]}get providers(){return this._providers}get mapObjects(){return this._mapObjects}get routing(){return this._routing}get UUID(){return this._UUID}};const k=new class{constructor(){}getLatLngElevAtDist(t,e){if(t.distance<=e||0>=e)return null;let s=0,i=t.itinerary.itineraryPoints.iterator;for(;s<e&&!i.done;)s+=i.value.distance;let a=i.value;i.done;let n=(a.distance-s+e)/a.distance;return Object.freeze({latLng:[a.lat+(i.value.lat-a.lat)*n,a.lng+(i.value.lng-a.lng)*n],elev:a.elev+(i.value.elev-a.elev)*n,ascent:100*(i.value.elev-a.elev)/a.distance,routeDistance:e})}getClosestLatLngDistance(e,s){if(0===e.itinerary.itineraryPoints.length)return null;let i=e.itinerary.itineraryPoints.iterator;i.done;let a=Number.MAX_VALUE,n=window.L.Projection.SphericalMercator.project(window.L.latLng(s[0],s[1])),r=window.L.Projection.SphericalMercator.project(window.L.latLng(i.value.lat,i.value.lng)),o=null,l=t.defaultValue,d=i.value.distance;for(;!i.done;){let t=window.L.Projection.SphericalMercator.project(window.L.latLng(i.value.lat,i.value.lng)),e=window.L.LineUtil.pointToSegmentDistance(n,r,t);e<a&&(a=e,o=window.L.Projection.SphericalMercator.unproject(window.L.LineUtil.closestPointOnSegment(n,r,t)),l=d-o.distanceTo(window.L.latLng(i.value.lat,i.value.lng))),d+=i.value.distance,r=t}return Object.freeze({latLng:[o.lat,o.lng],distance:l})}getLatLngBounds(t){let e=window.L.latLng([s.maxLat,s.maxLng]),i=window.L.latLng([s.minLat,s.minLng]);return t.forEach((t=>{e.lat=Math.min(e.lat,t[0]),e.lng=Math.min(e.lng,t[1]),i.lat=Math.max(i.lat,t[0]),i.lng=Math.max(i.lng,t[1])})),window.L.latLngBounds(e,i)}getSquareBoundingBox(t,e){let s=e/l*n.fromRadians,i=t[0]*n.toRadians,a=Math.acos((Math.cos(e/l)-Math.sin(i)**2)/Math.cos(i)**2)*n.fromRadians;return window.L.latLngBounds(window.L.latLng([t[0]-s,t[1]-a]),window.L.latLng([t[0]+s,t[1]+a]))}project(t,e){let s=C.map.project(window.L.latLng(t),e);return[s.x,s.y]}screenCoordToLatLng(t,e){let s=C.map.containerPointToLatLng(window.L.point(t,e));return[s.lat,s.lng]}addPoints(t,e){return[t[0]+e[0],t[1]+e[1]]}subtrackPoints(t,e){return[t[0]-e[0],t[1]-e[1]]}};class S{_baseDialog=null;constructor(t){this._baseDialog=t}destructor(){this._baseDialog=null}handleEvent(){this._baseDialog.onOk()}}class W{_baseDialog=null;constructor(t){this._baseDialog=t}destructor(){this._baseDialog=null}handleEvent(){this._baseDialog.onCancel()}}class B{_dragData=null;constructor(t){this._dragData=t}destructor(){this._dragData=null}handleEvent(t){this._dragData.dragStartX=t.screenX,this._dragData.dragStartY=t.screenY,t.dataTransfer.dropEffect="move",t.dataTransfer.effectAllowed="move"}}class V{_dragData=null;_containerDiv=null;_backgroundDiv=null;constructor(t,e,s){this._dragData=t,this._containerDiv=e,this._backgroundDiv=s}destructor(){this._dragData=null,this._containerDiv=null,this._backgroundDiv=null}handleEvent(t){this._dragData.dialogX+=t.screenX-this._dragData.dragStartX,this._dragData.dialogX=Math.min(Math.max(this._dragData.dialogX,d),this._backgroundDiv.clientWidth-this._containerDiv.clientWidth-d),this._dragData.dialogY+=t.screenY-this._dragData.dragStartY,this._dragData.dialogY=Math.max(this._dragData.dialogY,d);let e=this._backgroundDiv.clientHeight-Math.max(this._dragData.dialogY,0)-d;this._containerDiv.style.left=String(this._dragData.dialogX)+"px",this._containerDiv.style.top=String(this._dragData.dialogY)+"px",this._containerDiv.style["max-height"]=String(e)+"px"}}class F{_baseDialog=null;constructor(t){this._baseDialog=t}destructor(){this._baseDialog=null}handleEvent(t){this._baseDialog.keyboardELEnabled&&("Escape"===t.key||"Esc"===t.key?this._baseDialog.onCancel():"Enter"===t.key&&this._baseDialog.onOk())}}class R{_mapCenter=[s.defaultValue,s.defaultValue];constructor(){}handleEvent(t){if("start"===t.action)return void(this._mapCenter=C.map.getCenter());let e=k.screenCoordToLatLng(t.startX,t.startY),s=k.screenCoordToLatLng(t.endX,t.endY);C.map.panTo([this._mapCenter.lat+e[0]-s[0],this._mapCenter.lng+e[1]-s[1]])}}class U{_initialZoom=0;_startPoint=null;constructor(){}handleEvent(t){if("start"===t.action)return this._initialZoom=C.map.getZoom(),void(this._startPoint=window.L.point(t.clientX,t.clientY));let e=Math.floor(this._initialZoom+(t.startY-t.endY)/50);e=Math.min(C.map.getMaxZoom(),e),e=Math.max(C.map.getMinZoom(),e),C.map.setZoomAround(this._startPoint,e)}}class H{constructor(){}handleEvent(t){if("TravelNotes-Background"!==t.target.id)return;let e=C.map.getZoom()+(0>t.deltaY?1:-1);e=Math.min(C.map.getMaxZoom(),e),e=Math.max(C.map.getMinZoom(),e),C.map.setZoomAround(window.L.point(t.clientX,t.clientY),e)}}class z{constructor(){}handleEvent(t){t.preventDefault()}}class Y{constructor(){}handleEvent(t){t.preventDefault()}}class X{_panOngoing=!1;_startPanX=0;_startPanY=0;_target=null;_button=0;_eventType="";_dispatchEvent(t,e){let s=new Event(this._eventType);s.startX=this._startPanX,s.startY=this._startPanY,s.endX=t.screenX,s.endY=t.screenY,s.clientX=t.clientX,s.clientY=t.clientY,s.action=e,this._target.dispatchEvent(s)}constructor(t,e){switch(this._target=t,this._button=e,e){case 0:this._eventType="leftpan";break;case 1:this._eventType="middlepan";break;case 2:this._eventType="rightpan";break;default:this._button=o}}handleEvent(t){switch(t.type){case"mousedown":t.button===this._button&&t.target===this._target&&(this._startPanX=t.screenX,this._startPanY=t.screenY,this._panOngoing=!0,this._dispatchEvent(t,"start"));break;case"mouseup":t.button!==this._button||!this._panOngoing||this._startPanX===t.screenX&&this._startPanY===t.screenY||this._dispatchEvent(t,"end"),this._panOngoing=!1;break;case"mousemove":this._panOngoing&&(document.selection?document.selection.empty():window.getSelection().removeAllRanges(),this._dispatchEvent(t,"move"))}}}class K{static get LEFT_BUTTON(){return 0}static get MIDDLE_BUTTON(){return 1}static get RIGHT_BUTTON(){return 2}_target=null;_eventListener=null;constructor(t,e=0){this._target=t,this._eventListener=new X(t,e),this._target.addEventListener("mousedown",this._eventListener),this._target.addEventListener("mouseup",this._eventListener),this._target.addEventListener("mousemove",this._eventListener)}detach(){this._target.removeEventListener("mousedown",this._eventListener),this._target.removeEventListener("mouseup",this._eventListener),this._target.removeEventListener("mousemove",this._eventListener),this._eventListener=null,this._target=null}}class Z extends class{_backgroundDiv={};_containerDiv={};_errorDiv={};_waitDiv={};_okButton={};_cancelButton={};_topBar={};_secondButton=null;_leftPanEventDispatcher=null;_rightPanEventDispatcher=null;_keyboardELEnabled=!0;_dragData=Object.seal({dragStartX:0,dragStartY:0,dialogX:0,dialogY:0});_eventListeners={onKeydown:null,onTopBarDragStart:null,onTopBarDragEnd:null,onCancelButtonClick:null,onOkButtonClick:null,onLeftPan:null,onRightPan:null,onWheel:null,onContextMenu:null,onDragOver:null};_options=null;_onPromiseOkFct=null;_onPromiseErrorFct=null;_createBackgroundDiv(){this._backgroundDiv=h.create("div",{id:"TravelNotes-Background",className:"TravelNotes-Background"}),this._leftPanEventDispatcher=new K(this._backgroundDiv,K.LEFT_BUTTON),this._rightPanEventDispatcher=new K(this._backgroundDiv,K.RIGHT_BUTTON),this._eventListeners.onLeftPan=new R,this._backgroundDiv.addEventListener("leftpan",this._eventListeners.onLeftPan,!1),this._eventListeners.onRightPan=new U,this._backgroundDiv.addEventListener("rightpan",this._eventListeners.onRightPan,!1),this._eventListeners.onDragOver=new Y,this._backgroundDiv.addEventListener("dragover",this._eventListeners.onDragOver,!1),this._eventListeners.onWheel=new H,this._backgroundDiv.addEventListener("wheel",this._eventListeners.onWheel,!1),this._eventListeners.onContextMenu=new z,this._backgroundDiv.addEventListener("contextmenu",this._eventListeners.onContextMenu,!1)}_createContainerDiv(){this._containerDiv=h.create("div",{className:"TravelNotes-BaseDialog-Container"},this._backgroundDiv)}_createTopBar(){this._topBar=h.create("div",{className:"TravelNotes-BaseDialog-TopBar",draggable:!0},this._containerDiv),this._eventListeners.onTopBarDragStart=new B(this._dragData),this._eventListeners.onTopBarDragEnd=new V(this._dragData,this._containerDiv,this._backgroundDiv),this._topBar.addEventListener("dragstart",this._eventListeners.onTopBarDragStart,!1),this._topBar.addEventListener("dragend",this._eventListeners.onTopBarDragEnd,!1),this._eventListeners.onCancelButtonClick=new W(this),this._cancelButton=h.create("div",{textContent:"❌",className:"TravelNotes-BaseDialog-CancelButton",title:u.getText("BaseDialog - Cancel")},this._topBar),this._cancelButton.addEventListener("click",this._eventListeners.onCancelButtonClick,!1)}_createHeaderDiv(){h.create("text",{value:this.title},h.create("div",{className:"TravelNotes-BaseDialog-HeaderDiv"},this._containerDiv))}_createContentDiv(){let t=h.create("div",{className:"TravelNotes-BaseDialog-ContentDiv"},this._containerDiv);this.contentHTMLElements.forEach((e=>t.appendChild(e)))}_createErrorDiv(){this._errorDiv=h.create("div",{className:"TravelNotes-BaseDialog-ErrorDiv TravelNotes-Hidden"},this._containerDiv)}_createWaitDiv(){h.create("div",{className:"TravelNotes-WaitAnimationBullet"},h.create("div",{className:"TravelNotes-WaitAnimation"},this._waitDiv=h.create("div",{className:"TravelNotes-BaseDialog-WaitDiv  TravelNotes-Hidden"},this._containerDiv)))}_createFooterDiv(){let t=h.create("div",{className:"TravelNotes-BaseDialog-FooterDiv"},this._containerDiv);this._okButton=h.create("div",{textContent:this._options.firstButtonText||"🆗",className:"TravelNotes-BaseDialog-Button"},t),this._eventListeners.onOkButtonClick=new S(this),this._okButton.addEventListener("click",this._eventListeners.onOkButtonClick,!1),this._options.secondButtonText&&(this._secondButton=h.create("div",{textContent:this._options.secondButtonText,className:"TravelNotes-BaseDialog-Button"},t),this._secondButton.addEventListener("click",this._eventListeners.onCancelButtonClick,!1)),this.footerHTMLElements.forEach((e=>t.appendChild(e)))}_createHTML(){this._createBackgroundDiv(),this._createContainerDiv(),this._createTopBar(),this._createHeaderDiv(),this._createContentDiv(),this._createErrorDiv(),this._createWaitDiv(),this._createFooterDiv()}_centerDialog(){this._dragData.dialogX=(this._backgroundDiv.clientWidth-this._containerDiv.clientWidth)/2,this._dragData.dialogY=(this._backgroundDiv.clientHeight-this._containerDiv.clientHeight)/2,this._dragData.dialogX=Math.min(Math.max(this._dragData.dialogX,d),this._backgroundDiv.clientWidth-this._containerDiv.clientWidth-d),this._dragData.dialogY=Math.max(this._dragData.dialogY,d);let t=this._backgroundDiv.clientHeight-Math.max(this._dragData.dialogY,0)-d;this._containerDiv.style.left=String(this._dragData.dialogX)+"px",this._containerDiv.style.top=String(this._dragData.dialogY)+"px",this._containerDiv.style["max-height"]=String(t)+"px"}_show(t,e){this._onPromiseOkFct=t,this._onPromiseErrorFct=e,this._createHTML(),document.body.appendChild(this._backgroundDiv),this._centerDialog(),document.addEventListener("keydown",this._eventListeners.onKeydown,{capture:!0}),this.onShow()}constructor(t={}){this._options=t,this._eventListeners.onKeydown=new F(this),this._keyboardELEnabled=!0}_BaseDialogDestructor(){this._backgroundDiv.removeEventListener("dragover",this._eventListeners.onDragOver,!1),this._backgroundDiv.removeEventListener("leftpan",this._eventListeners.onLeftPan,!1),this._backgroundDiv.removeEventListener("rightpan",this._eventListeners.onRightPan,!1),this._backgroundDiv.removeEventListener("wheel",this._eventListeners.onWheel,!1),this._backgroundDiv.removeEventListener("contextmenu",this._eventListeners.onContextMenu,!1),document.removeEventListener("keydown",this._eventListeners.onKeydown,{capture:!0}),this._topBar.removeEventListener("dragstart",this._eventListeners.onTopBarDragStart,!1),this._topBar.removeEventListener("dragend",this._eventListeners.onTopBarDragEnd,!1),this._cancelButton.removeEventListener("click",this._eventListeners.onCancelButtonClick,!1),this._okButton.removeEventListener("click",this._eventListeners.onOkButtonClick,!1),this._options.secondButtonText&&this._secondButton.removeEventListener("click",this._eventListeners.onCancelButtonClick,!1),document.removeEventListener("keydown",this._eventListeners.onKeydown,{capture:!0}),this._eventListeners.onKeydown.destructor(),this._eventListeners.onTopBarDragStart.destructor(),this._eventListeners.onTopBarDragEnd.destructor(),this._eventListeners.onCancelButtonClick.destructor(),this._eventListeners.onOkButtonClick.destructor(),this._leftPanEventDispatcher.detach(),this._rightPanEventDispatcher.detach(),document.body.removeChild(this._backgroundDiv)}onCancel(){this._BaseDialogDestructor(),this._onPromiseErrorFct("Canceled by user")}canClose(){return!0}onOk(t){return!!this.canClose()&&(this._BaseDialogDestructor(),this._onPromiseOkFct(t),!0)}onShow(){}get title(){return""}get contentHTMLElements(){return[]}get footerHTMLElements(){return[]}show(){return new Promise(((t,e)=>this._show(t,e)))}showWait(){this._waitDiv.classList.remove("TravelNotes-Hidden"),this._okButton.classList.add("TravelNotes-Hidden")}hideWait(){this._waitDiv.classList.add("TravelNotes-Hidden"),this._okButton.classList.remove("TravelNotes-Hidden")}showError(t){this._errorDiv.textContent="",c.sanitizeToHtmlElement(t,this._errorDiv),this._errorDiv.classList.remove("TravelNotes-Hidden")}hideError(){this._errorDiv.textContent="",this._errorDiv.classList.add("TravelNotes-Hidden")}get keyboardELEnabled(){return this._keyboardELEnabled}set keyboardELEnabled(t){this._keyboardELEnabled=t}}{_options=null;_selectHtmlElement=null;get _selectDiv(){let t=h.create("div");return this._selectHtmlElement=h.create("select",null,t),this._options.selectOptionsData.forEach((t=>h.create("option",{text:t.text},this._selectHtmlElement))),this._selectHtmlElement.selectedIndex=0,t}constructor(t={}){super(t),this._options=t}get title(){return this._options.title||""}get contentHTMLElements(){return[h.create("div",{textContent:this._options.text||""}),this._selectDiv]}onOk(){super.onOk(this._options.selectOptionsData[this._selectHtmlElement.selectedIndex].objId)}}const J=new class{_normalizeLng(t){return(t+n.d540)%n.d360-n.d180}constructor(){}arcFromSummitArcArc(t,e,s){return Math.acos(Math.cos(e)*Math.cos(s)+Math.sin(e)*Math.sin(s)*Math.cos(t))}summitFromArcArcArc(t,e,s){return Math.acos((Math.cos(s)-Math.cos(t)*Math.cos(e))/(Math.sin(t)*Math.sin(e)))}pointsDistance(t,e){if(t[0]===e[0]&&t[1]===e[1])return 0;let s=t[0]*n.toRadians,i=e[0]*n.toRadians,a=(this._normalizeLng(e[1])-this._normalizeLng(t[1]))*n.toRadians;return Math.acos(Math.sin(s)*Math.sin(i)+Math.cos(s)*Math.cos(i)*Math.cos(a))*l}};class G{_newId=r;_selectedRelationId=r;_waysMap=new Map;_nodesMap=new Map;_stopsMap=new Map;constructor(t){this._selectedRelationId=t,this.nodes3WaysCounter=0}get waysMap(){return this._waysMap}get nodesMap(){return this._nodesMap}get stopsMap(){return this._stopsMap}get newId(){return this._newId--}firstOf(t){return t[0]}lastOf(t){return t[t.length-1]}removeFrom(t,e){t.splice(t.indexOf(e),1)}_reverseWay(t){let e=this._nodesMap.get(this.firstOf(t.nodesIds)),s=this._nodesMap.get(this.lastOf(t.nodesIds));this.removeFrom(e.startingWaysIds,t.id),e.endingWaysIds.push(t.id),this.removeFrom(s.endingWaysIds,t.id),s.startingWaysIds.push(t.id),t.nodesIds.reverse()}mergeWays(t,e){let s=this._waysMap.get(t),i=this._waysMap.get(e);this.lastOf(s.nodesIds)===this.lastOf(i.nodesIds)?this._reverseWay(i):this.firstOf(s.nodesIds)===this.firstOf(i.nodesIds)?this._reverseWay(s):this.firstOf(s.nodesIds)===this.lastOf(i.nodesIds)&&(this._reverseWay(s),this._reverseWay(i));let a=this._nodesMap.get(s.nodesIds.pop());a.startingWaysIds=[],a.endingWaysIds=[],s.nodesIds=s.nodesIds.concat(i.nodesIds),s.distance+=i.distance;let n=this._nodesMap.get(this.lastOf(s.nodesIds));return this.removeFrom(n.endingWaysIds,i.id),n.endingWaysIds.push(s.id),this._waysMap.delete(i.id),s.id}_cloneNode(t){let e=this._nodesMap.get(t),s={id:this.newId,lat:e.lat,lon:e.lon,type:"node",startingWaysIds:[],endingWaysIds:[],isNode3Ways:e.isNode3Ways};return this._nodesMap.set(s.id,s),s.id}cloneWay(t){let e=this._waysMap.get(t),s={id:this.newId,type:"way",nodesIds:[],distance:e.distance};return e.nodesIds.forEach((t=>s.nodesIds.push(this._cloneNode(t)))),this._nodesMap.get(this.firstOf(s.nodesIds)).startingWaysIds.push(s.id),this._nodesMap.get(this.lastOf(s.nodesIds)).endingWaysIds.push(s.id),this._waysMap.set(s.id,s),s.id}createMaps(t){this._waysMap.clear(),this._nodesMap.clear(),this._stopsMap.clear(),t.forEach((t=>{switch(t.type){case"way":t.nodesIds=t.nodes,delete t.nodes,2<=t.nodesIds.length&&(t.distance=0,this._waysMap.set(t.id,t));break;case"node":t.startingWaysIds=[],t.endingWaysIds=[],t.isNode3Ways=!1,this._nodesMap.set(t.id,t);break;case"relation":t.members.forEach((t=>{"node"===t.type&&t.role&&"stop"===t.role&&this._stopsMap.set(t.ref,t.ref)}))}})),this._stopsMap.forEach((t=>{let e=this._nodesMap.get(t);e?this._stopsMap.set(t,e):(window.TaN.showInfo("the relation "+this._selectedRelationId+" have nodes not positionned on the railway ( node "+t+")."),this._stopsMap.delete(t))})),this._waysMap.forEach((t=>{this._nodesMap.get(this.firstOf(t.nodesIds)).startingWaysIds.push(t.id),this._nodesMap.get(this.lastOf(t.nodesIds)).endingWaysIds.push(t.id);let e=null;t.nodesIds.forEach((s=>{let i=this._nodesMap.get(s);e&&(t.distance+=J.pointsDistance([i.lat,i.lon],[e.lat,e.lon])),e=i}))}))}}class Q{_publicTransportData=null;_computeDistances(t,e,s){t.isNode3Ways||e.isNode3Ways||s.push({distance:J.pointsDistance([t.lat,t.lon],[e.lat,e.lon]),nodesId:[t.id,e.id]})}_removeHoles(){let t=[],e=Array.from(this._publicTransportData.waysMap.values()),s=1;e.forEach((i=>{for(let a=s;a<e.length;a++){let s=[];s.push(this._publicTransportData.nodesMap.get(this._publicTransportData.firstOf(i.nodesIds))),s.push(this._publicTransportData.nodesMap.get(this._publicTransportData.lastOf(i.nodesIds))),s.push(this._publicTransportData.nodesMap.get(this._publicTransportData.firstOf(e[a].nodesIds))),s.push(this._publicTransportData.nodesMap.get(this._publicTransportData.lastOf(e[a].nodesIds))),this._computeDistances(s[0],s[2],t),this._computeDistances(s[0],s[3],t),this._computeDistances(s[1],s[2],t),this._computeDistances(s[1],s[3],t)}s++}));let i=t[0];t.forEach((t=>{t.distance<i.distance&&(i=t)}));let a={id:this._publicTransportData.newId,type:"way",nodesIds:i.nodesId,distance:i.distance};this._publicTransportData.waysMap.set(a.id,a);let n=this._publicTransportData.nodesMap.get(i.nodesId[0]),r=n.startingWaysIds.concat(n.endingWaysIds)[0];n.startingWaysIds.push(a.id);let o=this._publicTransportData.nodesMap.get(i.nodesId[1]),l=o.startingWaysIds.concat(o.endingWaysIds)[0];o.endingWaysIds.push(a.id),this._publicTransportData.mergeWays(this._publicTransportData.mergeWays(a.id,r),l),this._publicTransportData.waysMap.size>2*this._publicTransportData.nodes3WaysCounter+1&&this._removeHoles()}constructor(t){this._publicTransportData=t}removeHoles(){this._removeHoles()}}class q{_selectedRelationId=r;_nodes3Ways=[];_route=null;_publicTransportData=null;_merge3WaysNodes(){this._nodes3Ways.forEach((t=>{let e=Number.MAX_VALUE,s=null,i=t.startingWaysIds.concat(t.endingWaysIds);i.forEach((t=>{let i=this._publicTransportData.waysMap.get(t);i.distance<e&&(e=i.distance,s=i)})),this._publicTransportData.removeFrom(i,s.id);let a=this._publicTransportData.waysMap.get(this._publicTransportData.cloneWay(s.id)),n=null;this._publicTransportData.firstOf(s.nodesIds)===t.id?(a.nodesIds.pop(),a.nodesIds.push(this._publicTransportData.lastOf(s.nodesIds)),n=this._publicTransportData.firstOf(a.nodesIds)):(a.nodesIds.shift(),a.nodesIds.unshift(this._publicTransportData.firstOf(s.nodesIds)),n=this._publicTransportData.lastOf(a.nodesIds));let r=this._publicTransportData.waysMap.get(i[1]);r.nodesIds[r.nodesIds.indexOf(t.id)]=n,this._publicTransportData.mergeWays(this._publicTransportData.mergeWays(this._publicTransportData.mergeWays(s.id,a.id),i[0]),r.id)}))}_createRoute(t){let e=null,s=null,i=Number.MAX_VALUE,a=Number.MAX_VALUE;this._publicTransportData.stopsMap.forEach((t=>{let n=J.pointsDistance([t.lat,t.lon],this._route.wayPoints.first.latLng);n<i&&(i=n,e=t),n=J.pointsDistance([t.lat,t.lon],this._route.wayPoints.last.latLng),n<a&&(a=n,s=t)})),t.itinerary.itineraryPoints.removeAll(),t.itinerary.maneuvers.removeAll(),t.itinerary.hasProfile=!1,t.itinerary.ascent=0,t.itinerary.descent=0;let n=0,r=!1;Array.from(this._publicTransportData.waysMap.values())[0].nodesIds.forEach((i=>{if(0!==n||i!==e.id&&i!==s.id?2!==n||i!==e.id&&i!==s.id||(n=3):(n=1,r=i===s.id),0<n&&4>n){let a=new D,n=this._publicTransportData.nodesMap.get(i);a.latLng=[n.lat,n.lon],t.itinerary.itineraryPoints.add(a);let r=this._publicTransportData.stopsMap.get(i);if(r){let i=new O,n=null;r.tags&&r.tags.name&&(n=r.tags.name,i.instruction=n+"&nbsp;:&nbsp;"),r.id===e.id?(n&&(t.wayPoints.first.name=n),i.iconName="kTrainStart",i.instruction+="Monter dans le train"):r.id===s.id?(n&&(t.wayPoints.last.name=n),i.iconName="kTrainEnd",i.instruction+="Descendre du train"):(i.iconName="kTrainContinue",i.instruction+="Rester dans le train"),i.distance=0,i.duration=0,i.itineraryPointObjId=a.objId,t.itinerary.maneuvers.add(i)}}1===n&&(n=2),3===n&&(n=4)})),r&&(t.itinerary.itineraryPoints.reverse(),t.itinerary.maneuvers.reverse()),t.distance=0;let o=t.itinerary.maneuvers.iterator;o.done;let l=o.value;o.done;let d=t.itinerary.itineraryPoints.iterator;d.done;let h=d.value;for(;!d.done;)d.value.distance=0,h.distance=J.pointsDistance(h.latLng,d.value.latLng),t.distance+=h.distance,l.distance+=h.distance,o.value.itineraryPointObjId===d.value.objId&&(l=o.value,l.distance=0,o.done),h=d.value}constructor(t,e){this._route=t,this._selectedRelationId=e,this._publicTransportData=new G(e)}buildRoute(t,e,s){this._nodes3Ways=[],this._publicTransportData.nodes3WaysCounter=0,this._publicTransportData.createMaps(t.elements);let i=!1;this._publicTransportData.nodesMap.forEach((t=>{let e=t.startingWaysIds.concat(t.endingWaysIds);switch(e.length){case 0:case 1:break;case 2:this._publicTransportData.mergeWays(e[0],e[1]);break;case 3:t.isNode3Ways=!0,this._nodes3Ways.push(t),this._publicTransportData.nodes3WaysCounter++;break;default:i=!0,window.TaN.showInfo("A node with more than 3 ways is found : "+t.id+" - the relation "+this._selectedRelationId+" - ways "+t.startingWaysIds.concat(t.endingWaysIds))}})),i?s(new Error("A node with more than 3 ways was found in the relation.See the console for more infos")):(this._publicTransportData.waysMap.size>2*this._publicTransportData.nodes3WaysCounter+1&&(new Q(this._publicTransportData).removeHoles(),window.TaN.showInfo("Holes found in the OSM relation number "+this._selectedRelationId+". Try to correct OSM data.")),0<this._publicTransportData.nodes3WaysCounter&&this._merge3WaysNodes(),this._createRoute(this._route),e(this._route))}}
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file BaseRouteProvider.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/window.TaN.addProvider(class extends class{_userLanguage="fr";_providerKey="";_route=null;_getRoute(t,e){}constructor(){}get icon(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAIAAAC0Ujn1AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAArSURBVEhL7cyxDQAgAAQh91/67ektTI4BOHumGtWoRjWqUY1qVKMaP9bbBZKXggu6NeCUAAAAAElFTkSuQmCC"}getPromiseRoute(t){return this._route=t,new Promise(((t,e)=>this._getRoute(t,e)))}get name(){return""}get title(){return""}get transitModes(){return[]}get providerKeyNeeded(){return!0}get providerKey(){return this._providerKey.length}set providerKey(t){this._providerKey=t}get userLanguage(){return this._userLanguage}set userLanguage(t){this._userLanguage=t}}{_userLanguage="fr";_providerKey="";_route=null;_parseResponse(t,e,s){new q(this._route).buildRoute(t,e,s)}_getWaysNodesUrl(t){return window.TaN.overpassApiUrl+"?data=[out:json];rel("+t.toFixed(0)+');way(r)->.e;way.e["railway"="rail"];(._;>;rel('+t.toFixed(0)+"););out;"}_getDialogPromise(t){if(0===t.elements.length)return Promise.reject(new Error("No relations found"));let e=[];return t.elements.forEach((t=>{e.push({text:t.tags.name,objId:t.id})})),new Z({title:"Relations",text:"select a relation : ",selectOptionsData:e}).show()}_getRelationsUrl(){return window.TaN.overpassApiUrl+'?data=[out:json];node["public_transport"="stop_position"]["train"="yes"](around:400.0,'+this._route.wayPoints.first.lat.toFixed(s.fixed)+","+this._route.wayPoints.first.lng.toFixed(s.fixed)+')->.s;rel(bn.s)->.s;node["public_transport"="stop_position"]["train"="yes"](around:400.0,'+this._route.wayPoints.last.lat.toFixed(s.fixed)+","+this._route.wayPoints.last.lng.toFixed(s.fixed)+")->.e;rel(bn.e)->.e;rel.e.s;out tags;"}_getRoute(t,e){fetch(this._getRelationsUrl()).then((s=>{200===s.status&&s.ok?s.json().then((t=>this._getDialogPromise(t))).then((t=>fetch(this._getWaysNodesUrl(t)))).then((s=>{200===s.status&&s.ok?s.json().then((s=>this._parseResponse(s,t,e))):e(new Error("An error occurs..."))})).catch((()=>e(new Error("An error occurs...")))):e(new Error("An error occurs..."))}))}constructor(){super()}get icon(){return'data:image/svg+xml;utf8,<svg viewBox="-3 -3 20 20" xmlns="http://www.w3.org/2000/svg"> <g fill="rgb(128,0,0)"><path d="M 5,0 C 3.025911,-0.0084 1,3 1,7 l 0,2 c 0,1 1,2 2,2 l 8,0 c 1,0 2,-1 2,-2 L 13,7 C 13,3 11,0 9,0 z m -1,3 6,0 c 0,0 1,1 1,3 L 3.03125,6 C 2.994661,3.9916 4,3 4,3 z M 3,8 6,8 6,9 3,9 z m 5,0 3,0 0,1 -3,0 z m -6,4 -1,2 3,0 1,-2 z m 7,0 1,2 3,0 -1,-2 z"/></g></svg>'}getPromiseRoute(t){return this._route=t,new Promise(((t,e)=>this._getRoute(t,e)))}get name(){return"PublicTransport"}get title(){return"Public Transport on OpenStreetMap"}get transitModes(){return["train"]}get providerKeyNeeded(){return!1}get providerKey(){return 1}set providerKey(t){}get userLanguage(){return this._userLanguage}set userLanguage(t){this._userLanguage=t}})}();