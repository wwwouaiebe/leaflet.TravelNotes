/**
 * 
 * @source: https://github.com/wwwouaiebe/leaflet.TravelNotes
 * 
 * @licstart  The following is the entire license notice for the
 * JavaScript code in this page.
 * 
 * leaflet.travelnotes - version 2.0.0
 * Build 00313 - 2020-12-30T21:06:30+0100 
 * Copyright 2017 2020 wwwouaiebe 
 * Contact: https://www.ouaie.be/
 * License: GPL-3.0
 * 
 * The JavaScript code in this page is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 * 
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 * 
 * @licend  The above is the entire license notice
 * for the JavaScript code in this page.
 * 
 */


!function(){"use strict";
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Config.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/let e={autoLoad:!1,haveGlobals:!1,map:{center:{lat:50.50923,lng:5.49542},zoom:12},travelNotesToolbarUI:{contactMail:"https://github.com/wwwouaiebe/leaflet.TravelNotes/issues"},layersToolbarUI:{haveLayersToolbarUI:!0,toolbarTimeOut:1500,contactMail:"https://github.com/wwwouaiebe/leaflet.TravelNotes/issues",theDevil:{addButton:!1,title:"Reminder! The devil will know everything about you",text:"ðŸ‘¿"}},mouseUI:{haveMouseUI:!0},errorUI:{timeOut:1e4,helpTimeOut:3e4,showError:!0,showWarning:!0,showInfo:!0,showHelp:!0},geoLocation:{color:"red",radius:11,zoomToPosition:!0,zoomFactor:17,options:{enableHighAccuracy:!1,maximumAge:0,timeout:1/0}},APIKeys:{showDialogButton:!0,saveToSessionStorage:!0,showAPIKeysInDialog:!0,dialogHaveUnsecureButtons:!0},contextMenu:{timeout:1500},routing:{auto:!0},language:"fr",itineraryPointMarker:{color:"red",weight:2,radius:7,fill:!1},searchPointMarker:{color:"green",weight:4,radius:20,fill:!1},searchPointPolyline:{color:"green",weight:4,radius:20,fill:!1},previousSearchLimit:{color:"green",fill:!1,weight:1},nextSearchLimit:{color:"red",fill:!1,weight:1},wayPoint:{reverseGeocoding:!1},route:{color:"#ff0000",width:3,dashArray:0,dashChoices:[{text:"â€”â€”â€”â€”â€”â€”",iDashArray:null},{text:"â€” â€” â€” â€” â€”",iDashArray:[4,2]},{text:"â€”â€§â€”â€§â€”â€§â€”â€§â€”",iDashArray:[4,2,0,2]},{text:"Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·",iDashArray:[0,2]}],elev:{smooth:!0,smoothCoefficient:.25,smoothPoints:3},showDragTooltip:3},note:{osmSearchNoteDialog:!1,reverseGeocoding:!1,grip:{size:10,opacity:0,moveOpacity:1},polyline:{color:"gray",weight:1},haveBackground:!1,style:"",svgIconWidth:200,svgAnleMaxDirection:{right:35,slightRight:80,continue:100,slightLeft:145,left:200,sharpLeft:270,sharpRight:340},svgZoom:17,svgAngleDistance:10,svgHamletDistance:200,svgVillageDistance:400,svgCityDistance:1200,svgTownDistance:1500,svgTimeOut:15e3,cityPrefix:'<span class="TravelNotes-NoteHtml-Address-City">',cityPostfix:"</span>",maxManeuversNotes:100},itineraryPointZoom:17,routeEditor:{displayEditionInHTMLPage:!0},travelEditor:{clearAfterSave:!0,startMinimized:!0,timeout:1e3,startupRouteEdition:!0},haveBeforeUnloadWarning:!0,overpassApiUrl:"https://lz4.overpass-api.de/api/interpreter",nominatim:{url:"https://nominatim.openstreetmap.org/",language:"*"},printRouteMap:{isEnabled:!0,maxTiles:240,paperWidth:287,paperHeight:200,pageBreak:!1,printNotes:!0,borderWidth:30,zoomFactor:15,entryPointMarker:{color:"green",weight:4,radius:10,fill:!0,fillOpacity:1},exitPointMarker:{color:"red",weight:4,radius:10,fill:!0,fillOpacity:1}},haveCrypto:!1,itineraryPane:{showNotes:!0,showManeuvers:!1},colorDialog:{haveSlider:!0,initialRed:0}};let t=new class{get autoLoad(){return e.autoLoad}get haveGlobals(){return e.haveGlobals}get map(){return e.map}get travelNotesToolbarUI(){return e.travelNotesToolbarUI}get layersToolbarUI(){return e.layersToolbarUI}get mouseUI(){return e.mouseUI}get errorUI(){return e.errorUI}get APIKeys(){return e.APIKeys}get contextMenu(){return e.contextMenu}get routing(){return e.routing}get language(){return e.language}get itineraryPointMarker(){return e.itineraryPointMarker}get searchPointMarker(){return e.searchPointMarker}get searchPointPolyline(){return e.searchPointPolyline}get previousSearchLimit(){return e.previousSearchLimit}get nextSearchLimit(){return e.nextSearchLimit}get wayPoint(){return e.wayPoint}get route(){return e.route}get note(){return e.note}get itineraryPointZoom(){return e.itineraryPointZoom}get routeEditor(){return e.routeEditor}get travelEditor(){return e.travelEditor}get haveBeforeUnloadWarning(){return e.haveBeforeUnloadWarning}get overpassApiUrl(){return e.overpassApiUrl}get nominatim(){return e.nominatim}get geoLocation(){return e.geoLocation}get printRouteMap(){return e.printRouteMap}get haveCrypto(){return e.haveCrypto}get itineraryPane(){return e.itineraryPane}get colorDialog(){return e.colorDialog}overload(t){!function e(t,o){if("object"==typeof t&&"object"==typeof o)try{for(let a in o)"object"==typeof o[a]?e(t[a],o[a]):o[a]=t[a]||o[a];for(let a in t)"object"==typeof t[a]?("[object Array]"===Object.prototype.toString.call(t[a])?o[a]=o[a]||[]:o[a]=o[a]||{},e(t[a],o[a])):o[a]=t[a]}catch(e){console.log(e||"Not possible to overload Config")}}(t,e),e=function e(t){for(let o in t)"object"==typeof t[o]&&(t[o]=e(t[o]));return Object.freeze(t)}(e)}};
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file HTMLElementsFactory.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/const o=Object.freeze(new class{create(e,t,o){let a=null;return"text"===e.toLowerCase()?a=document.createTextNode(t.value||""):(a=document.createElement(e),t&&function(e,t){for(let o in t)try{e[o]=t[o]}catch(e){console.log("Invalid property : "+o)}}(a,t)),o&&o.appendChild(a),a}});const a=Object.freeze(new
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file HttpRequestBuilder.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/
class{getTextPromise(e,t){return new Promise((function(o,a){let r=new XMLHttpRequest;r.timeout=4e4,r.ontimeout=function(){a("XMLHttpRequest TimeOut. File : "+r.responseURL)},r.onreadystatechange=function(){4===r.readyState&&(200===r.status?o(r.responseText):a("Error XMLHttpRequest - File : "+r.responseURL))},r.open("GET",e,!0),t&&t.forEach(e=>r.setRequestHeader(e.headerName,e.headerValue)),r.overrideMimeType("text/plain"),r.send(null)}))}getJsonPromise(e,t){return new Promise((function(o,a){let r=new XMLHttpRequest;r.timeout=4e4,r.ontimeout=function(){a("XMLHttpRequest TimeOut. File : "+r.responseURL)},r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){let e=null;try{e=JSON.parse(r.responseText)}catch(e){a(e.message+" File: "+r.responseURL)}o(e)}else a("Error XMLHttpRequest - File : "+r.responseURL)},r.open("GET",e,!0),t&&t.forEach(e=>r.setRequestHeader(e.headerName,e.headerValue)),r.overrideMimeType("application/json"),r.send(null)}))}getBinaryPromise(e,t){return new Promise((function(o,a){let r=new XMLHttpRequest;r.timeout=4e4,r.ontimeout=function(){a("XMLHttpRequest TimeOut. File : "+r.responseURL)},r.onload=function(){if(200===r.status){let e=r.response;e?o(e):a("Error XMLHttpRequest - File : "+r.responseURL)}else a("Error XMLHttpRequest - File : "+r.responseURL)},r.open("GET",e,!0),t&&t.forEach(e=>r.setRequestHeader(e.headerName,e.headerValue)),r.responseType="arraybuffer",r.send(null)}))}}),r=Object.freeze({fixed:2,invalid:-1,defaultValue:0}),n=Object.freeze({refusedByUser:-1,disabled:0,inactive:1,active:2}),i=(Object.freeze({invalidPane:"43a6a53e-008a-4910-80a6-7a87d301ea15",itineraryPane:"8fbf0da7-4e6f-4bc7-8e20-1388461ccde7",travelNotesPane:"dffe782b-07df-4b81-a318-f287c0cf5ec6",searchPane:"228f00d7-43a8-4c13-897d-70400cb6dd58"}),Object.freeze({fixed:2,defaultValue:0})),s=Object.freeze({defaultValue:0,fixed:6}),l=Object.freeze({notEdited:0,editedNoChange:1,editedChanged:2}),c=Object.freeze({margin:100,height:500,width:1e3,yDeltaText:30,xDeltaText:10,vScales:[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3],hScales:[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5]}),d=(Object.freeze({width:40,height:40}),"http://www.w3.org/2000/svg");
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Constants.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/let u=0;function h(){return++u,u}
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Version.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/function p(e){const t=e;return Object.seal(new class{get name(){return t}get version(){return"2.0.0"}get jsonObject(){return{name:t,version:"2.0.0"}}validate(e){if(!Object.getOwnPropertyNames(e).includes("name"))throw new Error("No name for "+t);if(t!==e.name)throw new Error("Invalid name for "+t);if(!Object.getOwnPropertyNames(e).includes("version"))throw new Error("No version for "+t)}})}function g(e){const t=e;let o=[];const a=function(){let e=t();if(!e.objType||!e.objType.name)throw new Error("invalid object name for collection");return e.objType.name}();function r(e){if(!e.objType||!e.objType.name||e.objType.name!==a)throw new Error("invalid object name for add function");o.push(e)}function n(){let e=-1;return Object.seal({get value(){return e<o.length?o[e]:null},get previous(){return 0>=e?null:o[e-1]},get next(){return e<o.length-1?o[e+1]:null},get done(){return++e>=o.length},get first(){return 0===e},get last(){return e>=o.length-1},get index(){return e}})}function i(e){return o.findIndex(t=>t.objId===e)}function s(e,t,a){let r=i(e);if(-1===r)throw new Error("invalid objId for next or previous function");if(1!==a&&-1!==a)throw new Error("invalid direction");let n=t;for(n||(n=()=>!0),r+=a;-1<r&&r<o.length&&!n(o[r]);)r+=a;return-1===r||o.length===r?null:o[r]}return Object.seal(new class{add(e){r(e)}forEach(e){let t=null,o=n();for(;!o.done;)t=e(o.value,t);return t}getAt(e){let t=i(e);return-1===t?null:o[t]}moveTo(e,t,a){let r=i(e),n=i(t);if(-1===r||-1===n)throw new Error("invalid objId for function  myMoveTo");a||n++,o.splice(n,0,o[r]),n<r&&r++,o.splice(r,1)}next(e,t){return s(e,t,1)}previous(e,t){return s(e,t,-1)}remove(e){if(-1===i(e))throw new Error("invalid objId for remove function");o.splice(i(e),1)}removeAll(e){e?o.splice(1,o.length-2):o.length=0}replace(e,t){let r=i(e);if(-1===r)throw new Error("invalid objId for replace function");if(!t.objType||!t.objType.name||t.objType.name!==a)throw new Error("invalid object name for replace function");o[r]=t}reverse(){o.reverse()}sort(e){o.sort(e)}swap(e,t){let a=i(e);if(-1===a||0===a&&t||o.length-1===a&&!t)throw new Error("invalid objId for swap function");let r=o[a];o[a]=o[a+(t?-1:1)],o[a+(t?-1:1)]=r}get first(){return o[0]}get iterator(){return n()}get last(){return o[o.length-1]}get length(){return o.length}get jsonObject(){let e=[],t=n();for(;!t.done;)e.push(t.value.jsonObject);return e}set jsonObject(e){o.length=0;let a=null;e.forEach(e=>{a=t(),a.jsonObject=e,r(a)})}})}
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Translator.js
	@copyright Copyright - 2017 2021 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/let f=new Map;const m=Object.freeze(new class{setTranslations(e){e.forEach(e=>f.set(e.msgid,e.msgstr.replace(/>|&gt;/gi,"â‰»").replace(/<|&lt;/gi,"â‰º").replace(/'|&apos;/gi,"â€²").replace(/"|&quot;/gi,"â€³")))}getText(e,t){let o=f.get(e);return t&&o&&Object.getOwnPropertyNames(t).forEach(e=>o=o.replace("{"+e+"}",t[e])),o||e}});const v=Object.freeze(new class{get UUID(){let e=new Uint16Array(8);const t=["","-","-","-","-","","",""];window.crypto.getRandomValues(e);let o="";for(let a=0;a<8;a++)o+=e[a].toString(16).padStart(4,"0")+t[a];return o}storageAvailable(e){try{let t=window[e],o="__storage_test__";return t.setItem(o,o),t.removeItem(o),!0}catch(e){return!1}}saveFile(e,t,o){try{let a=window.URL.createObjectURL(new File([t],e,{type:o||"text/plain"})),r=document.createElement("a");r.setAttribute("href",a),r.setAttribute("download",e),r.click(),window.URL.revokeObjectURL(a)}catch(e){console.log(e||"An error occurs when saving file")}}formatTime(e){let t=Math.floor(e);if(0===t)return"";let o=Math.floor(t/86400),a=Math.floor(t%86400/3600),r=Math.floor(t%3600/60),n=Math.floor(t%60);return 0<o?o+"Â "+m.getText("Utilities - Day")+"Â "+a+"Â "+m.getText("Utilities - Hour"):0<a?a+"Â "+m.getText("Utilities - Hour")+"Â "+r+"Â "+m.getText("Utilities - Minute"):0<r?r+"Â "+m.getText("Utilities - Minute"):n+"Â "+m.getText("Utilities - Second")}formatDistance(e){let t=Math.floor(e);return 0>=t?"0Â km":Math.floor(t/1e3)+","+Math.floor(t%1e3/10).toFixed(0).padStart(2,"0").padEnd(3,"0")+"Â km"}formatLat(e){return e>0?e.toFixed(s.fixed)+"Â N":(-e).toFixed(s.fixed)+"Â S"}formatLng(e){return e>0?e.toFixed(s.fixed)+"Â E":(-e).toFixed(s.fixed)+"Â W"}formatLatLng(e){return 0===e[0]&&0===e[1]?"":this.formatLat(e[0])+"Â -Â "+this.formatLng(e[1])}}),b=p("WayPoint"),y=new WeakMap;class w{constructor(){this.name="",this.address="",this.lat=s.defaultValue,this.lng=s.defaultValue,y.set(this,h())}get fullName(){let e=""===this.name?this.address:this.name+", "+this.address;return""===e&&(e=v.formatLatLng([this.lat,this.lng])),e}get latLng(){return[this.lat,this.lng]}set latLng(e){this.lat=e[0],this.lng=e[1]}get objId(){return y.get(this)}get objType(){return b}get jsonObject(){return{name:this.name,address:this.address,lat:parseFloat(this.lat.toFixed(s.fixed)),lng:parseFloat(this.lng.toFixed(s.fixed)),objId:y.get(this),objType:b.jsonObject}}set jsonObject(e){let t=function(e){if(!Object.getOwnPropertyNames(e).includes("objType"))throw new Error("No objType for "+b.name);if(b.validate(e.objType),b.version!==e.objType.version)switch(e.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":e.address=e.name,e.name="";case"1.12.0":case"1.13.0":e.objType.version="2.0.0";break;default:throw new Error("invalid version for "+b.name)}let t=Object.getOwnPropertyNames(e);return["address","name","lat","lng","objId"].forEach(e=>{if(!t.includes(e))throw new Error("No "+e+" for "+b.name)}),e}(e);this.address=t.address||"",this.name=t.name||"",this.lat=t.lat||s.defaultValue,this.lng=t.lng||s.defaultValue,y.set(this,h())}}function j(){return Object.seal(new w)}const N=p("ItineraryPoint"),T=new WeakMap;class O{constructor(){this.lat=s.defaultValue,this.lng=s.defaultValue,this.distance=r.defaultValue,this.elev=i.defaultValue,T.set(this,h())}get latLng(){return[this.lat,this.lng]}set latLng(e){this.lat=e[0],this.lng=e[1]}get objType(){return N}get objId(){return T.get(this)}get jsonObject(){return{lat:parseFloat(this.lat.toFixed(s.fixed)),lng:parseFloat(this.lng.toFixed(s.fixed)),distance:parseFloat(this.distance.toFixed(r.fixed)),elev:parseFloat(this.elev.toFixed(i.fixed)),objId:T.get(this),objType:N.jsonObject}}set jsonObject(e){let t=function(e){if(!Object.getOwnPropertyNames(e).includes("objType"))throw new Error("No objType for "+N.name);if(N.validate(e.objType),N.version!==e.objType.version)switch(e.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":e.elev=i.defaultValue;case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":e.objType.version="2.0.0";break;default:throw new Error("invalid version for "+N.name)}let t=Object.getOwnPropertyNames(e);return["lat","lng","distance","elev","objId"].forEach(e=>{if(!t.includes(e))throw new Error("No "+e+" for "+N.name)}),e}(e);this.lat=t.lat||s.defaultValue,this.lng=t.lng||s.defaultValue,this.distance=t.distance||r.defaultValue,this.elev=t.elev||i.defaultValue,T.set(this,h())}}function M(){return Object.seal(new O)}const x=p("Maneuver"),I=new WeakMap;class P{constructor(){this.iconName="",this.instruction="",this.itineraryPointObjId=-1,this.distance=r.defaultValue,this.duration=r.defaultValue,I.set(this,h())}get objType(){return x}get objId(){return I.get(this)}get jsonObject(){return{iconName:this.iconName,instruction:this.instruction,distance:parseFloat(this.distance.toFixed(r.fixed)),duration:this.duration,itineraryPointObjId:this.itineraryPointObjId,objId:I.get(this),objType:x.jsonObject}}set jsonObject(e){let t=function(e){if(!Object.getOwnPropertyNames(e).includes("objType"))throw new Error("No objType for "+x.name);if(x.validate(e.objType),x.version!==e.objType.version)switch(e.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":"kArriveDefault"===e.iconName&&(e.distance=r.defaultValue);case"1.12.0":case"1.13.0":e.objType.version="2.0.0";break;default:throw new Error("invalid version for "+x.name)}let t=Object.getOwnPropertyNames(e);return["iconName","instruction","distance","duration","itineraryPointObjId","objId"].forEach(e=>{if(!t.includes(e))throw new Error("No "+e+" for "+x.name)}),e}(e);this.iconName=t.iconName||"",this.instruction=t.instruction||"",this.distance=t.distance||r.defaultValue,this.duration=t.duration||r.defaultValue,this.itineraryPointObjId=t.itineraryPointObjId||-1,I.set(this,h())}}function A(){return Object.seal(new P)}const C=p("Itinerary"),E=new WeakMap;class S{constructor(){this.hasProfile=!1,this.ascent=0,this.descent=0,this.provider="",this.transitMode="",this.itineraryPoints=g(M),this.maneuvers=g(A),E.set(this,h())}get objType(){return C}get objId(){return E.get(this)}get jsonObject(){return{hasProfile:this.hasProfile,ascent:this.ascent,descent:this.descent,itineraryPoints:this.itineraryPoints.jsonObject,maneuvers:this.maneuvers.jsonObject,provider:this.provider,transitMode:this.transitMode,objId:E.get(this),objType:C.jsonObject}}set jsonObject(e){let t=function(e){if(!Object.getOwnPropertyNames(e).includes("objType"))throw new Error("No objType for "+C.name);if(C.validate(e.objType),C.version!==e.objType.version)switch(e.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":e.hasProfile=!1,e.ascent=0,e.descent=0;case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":e.objType.version="2.0.0";break;default:throw new Error("invalid version for "+C.name)}let t=Object.getOwnPropertyNames(e);return["hasProfile","ascent","descent","itineraryPoints","maneuvers","provider","transitMode","objId"].forEach(e=>{if(!t.includes(e))throw new Error("No "+e+" for "+C.name)}),e}(e);this.hasProfile=t.hasProfile||!1,this.ascent=t.ascent||0,this.descent=t.descent||0,this.itineraryPoints.jsonObject=t.itineraryPoints||[],this.maneuvers.jsonObject=t.maneuvers||[],this.provider=t.provider||"",this.transitMode=t.transitMode||"",E.set(this,h());let o=new Map,a=0,r=this.itineraryPoints.iterator;for(;!r.done;)o.set(t.itineraryPoints[a].objId,r.value.objId),a++;let n=this.maneuvers.iterator;for(;!n.done;)n.value.itineraryPointObjId=o.get(n.value.itineraryPointObjId)}}function R(){return Object.seal(new S)}let D=new Map;D.set("a",["href","target"]),D.set("br",[]),D.set("div",[]),D.set("del",[]),D.set("em",[]),D.set("figcaption",[]),D.set("figure",[]),D.set("h1",[]),D.set("h2",[]),D.set("h3",[]),D.set("h4",[]),D.set("h5",[]),D.set("h6",[]),D.set("hr",[]),D.set("img",["src","alt"]),D.set("ins",[]),D.set("li",[]),D.set("mark",[]),D.set("ol",[]),D.set("p",[]),D.set("s",[]),D.set("small",[]),D.set("strong",[]),D.set("span",[]),D.set("sub",[]),D.set("sup",[]),D.set("ul",[]),D.set("svg",["xmlns","viewBox","class"]),D.set("text",["x","y","text-anchor"]),D.set("polyline",["points","class","transform"]);const F=window.location.protocol;function H(e,t){let o=null;try{o=new URL(e)}catch(e){return""}let a=["https:"];return"http:"===F&&a.push("http:"),"href"===t&&a.push("mailto:"),-1!==a.indexOf(o.protocol)?o.href:""}function V(e){return e.replaceAll(/</g,"&lt;").replaceAll(/>/g,"&gt;").replaceAll(/"/g,"&quot;").replaceAll(/\u0027/g,"&apos;").replaceAll(/\u0a00/g,"&nbsp;")}const k=Object.freeze(new class{validateUrl(e){return H(e)}parse(e,t){!function e(t,o){let a=t.childNodes;for(let r=0;r<a.length;r++){let a=t.childNodes[r],n=a.nodeName.toLowerCase(),i=D.get(n);if(i){i=i.concat(["id","class","dir","title"]);let t="svg"===n||"text"===n||"polyline"===n,r=t?document.createElementNS(d,n):document.createElement(n);i.forEach(e=>{if(t)a.hasAttributeNS(null,e)&&(r.setAttributeNS(null,e,a.getAttribute(e)),a.removeAttributeNS(null,e));else if(a.hasAttribute(e)){if("href"===e||"src"===e){let t=H(a.getAttribute(e),e);if(""===t){let t="An invalid url ("+a.getAttribute(e)+")was removed from a "+e+" attribute";console.log(t)}else r.setAttribute(e,t)}else r.setAttribute(e,a.getAttribute(e));a.removeAttribute(e)}}),o.appendChild(r),e(a,r)}else"#text"===n?o.appendChild(document.createTextNode(a.nodeValue)):console.log("An invalid tag <"+n+"> was removed");if(a.hasAttributes)for(let e=0;e<a.attributes.length;e++)console.log("An unsecure attribute "+a.attributes[e].name+" ðŸ¢‚ "+a.attributes[e].value+" was removed.")}}((new DOMParser).parseFromString("<div>"+e+"</div>","text/html").querySelector("body").firstChild,t)}verify(e){let t="",o="";return function e(a){let r=a.childNodes;for(let n=0;n<r.length;n++){let r=a.childNodes[n],i=r.nodeName.toLowerCase(),s=D.get(i);if(s){s=s.concat(["id","class","dir","title"]);let a="svg"===i||"text"===i||"polyline"===i;t+="<"+i,s.forEach(e=>{if(a)r.hasAttributeNS(null,e)&&(t+=" "+e+'="'+V(r.getAttribute(e))+'"',r.removeAttribute(e));else if(r.hasAttribute(e))if("href"===e||"src"===e){let a=H(r.getAttribute(e),e);if(""===a){let t="An invalid url ("+r.getAttribute(e)+")was removed from a "+e+" attribute";console.log(t),o+="<p>"+t+"</p>"}else t+=" "+e+'="'+a+'"';r.removeAttribute(e)}else t+=" "+e+'="'+V(r.getAttribute(e))+'"',r.removeAttribute(e)}),t+=">",e(r),t+="</"+i+">"}else if("#text"===i)t+=V(r.nodeValue);else{let e="An invalid tag "+i+" was removed";console.log(e),o+="<p>"+e+"</p>"}if(r.hasAttributes)for(let e=0;e<r.attributes.length;e++){let t="An unsecure attribute "+r.attributes[e].name+'="'+r.attributes[e].value+'" was removed.';console.log(t),o+="<p>"+t+"</p>"}}}((new DOMParser).parseFromString("<div>"+e.replace("&nbsp;","à¨€")+"</div>","text/html").querySelector("body").firstChild),{htmlString:t,errorsString:o}}}),U=p("Note"),z=new WeakMap;function B(e){return e.replaceAll(/style='color:white;background-color:red'/g,"class='TravelNotes-Note-WhiteRed'").replaceAll(/style='color:white;background-color:green'/g,"class='TravelNotes-Note-WhiteGreen'").replaceAll(/style='color:white;background-color:blue'/g,"class='TravelNotes-Note-WhiteBlue'").replaceAll(/style='color:white;background-color:brown'/g,"class='TravelNotes-Note-WhiteBrown'").replaceAll(/style='color:white;background-color:black'/g,"class='TravelNotes-Note-WhiteBlack'").replaceAll(/style='border:solid 0.1em'/g,"class='TravelNotes-Note-BlackWhite'")}class W{constructor(){this.iconHeight=0,this.iconWidth=0,this.iconContent="",this.popupContent="",this.tooltipContent="",this.phone="",this.url="",this.address="",this.iconLat=s.defaultValue,this.iconLng=s.defaultValue,this.lat=s.defaultValue,this.lng=s.defaultValue,this.distance=r.invalid,this.chainedDistance=r.defaultValue,z.set(this,h())}get isRouteNote(){return this.distance!==r.invalid}get iconLatLng(){return[this.iconLat,this.iconLng]}set iconLatLng(e){this.iconLat=e[0],this.iconLng=e[1]}get latLng(){return[this.lat,this.lng]}set latLng(e){this.lat=e[0],this.lng=e[1]}get objType(){return U}get objId(){return z.get(this)}get jsonObject(){return{iconHeight:this.iconHeight,iconWidth:this.iconWidth,iconContent:this.iconContent,popupContent:this.popupContent,tooltipContent:this.tooltipContent,phone:this.phone,url:this.url,address:this.address,iconLat:parseFloat(this.iconLat.toFixed(s.fixed)),iconLng:parseFloat(this.iconLng.toFixed(s.fixed)),lat:parseFloat(this.lat.toFixed(s.fixed)),lng:parseFloat(this.lng.toFixed(s.fixed)),distance:parseFloat(this.distance.toFixed(r.fixed)),chainedDistance:parseFloat(this.chainedDistance.toFixed(r.fixed)),objId:z.get(this),objType:U.jsonObject}}set jsonObject(e){let t=function(e){if(!Object.getOwnPropertyNames(e).includes("objType"))throw new Error("No objType for "+U.name);if(U.validate(e.objType),U.version!==e.objType.version)switch(e.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":"string"==typeof e.iconHeight&&(e.iconHeight=Number.parseInt(e.iconHeight)),"string"==typeof e.iconWidth&&(e.iconWidth=Number.parseInt(e.iconWidth)),e.iconContent=B(e.iconContent),e.popupContent=B(e.popupContent),e.tooltipContent=B(e.tooltipContent),e.phone=B(e.phone),e.address=B(e.address),e.objType.version="2.0.0";break;default:throw new Error("invalid version for "+U.name)}let t=Object.getOwnPropertyNames(e);return["iconHeight","iconWidth","iconContent","popupContent","tooltipContent","phone","url","address","iconLat","iconLng","lat","lng","distance","chainedDistance","objId"].forEach(e=>{if(!t.includes(e))throw new Error("No "+e+" for "+U.name)}),e}(e);this.iconHeight=t.iconHeight||0,this.iconWidth=t.iconWidth||0,this.iconContent=t.iconContent||"",this.popupContent=t.popupContent||"",this.tooltipContent=t.tooltipContent||"",this.phone=t.phone||"",this.url=t.url||"",this.address=t.address||"",this.iconLat=t.iconLat||s.defaultValue,this.iconLng=t.iconLng||s.defaultValue,this.lat=t.lat||s.defaultValue,this.lng=t.lng||s.defaultValue,this.distance=t.distance||r.invalid,this.chainedDistance=t.chainedDistance,z.set(this,h()),this.validateData()}validateData(){"number"!=typeof this.iconHeight&&(this.iconHeight=0),"number"!=typeof this.iconWidth&&(this.iconWidth=0),"string"==typeof this.iconContent?this.iconContent=k.verify(this.iconContent).htmlString:this.iconContent="","string"==typeof this.popupContent?this.popupContent=k.verify(this.popupContent).htmlString:this.popupContent="","string"==typeof this.tooltipContent?this.tooltipContent=k.verify(this.tooltipContent).htmlString:this.tooltipContent="","string"==typeof this.phone?this.phone=k.verify(this.phone).htmlString:this.phone="","string"==typeof this.url?this.url=encodeURI(k.validateUrl(this.url)):this.url="","string"==typeof this.address?this.address=k.verify(this.address).htmlString:this.address="","number"!=typeof this.iconLat&&(this.iconLat=s.defaultValue),"number"!=typeof this.iconLng&&(this.iconLng=s.defaultValue),"number"!=typeof this.lat&&(this.lat=0),"number"!=typeof this.lng&&(this.lng=0),"number"!=typeof this.distance&&(this.distance=0),"number"!=typeof this.chainedDistance&&(this.chainedDistance=0)}}function q(){return Object.seal(new W)}const Z=p("Route"),G=new WeakMap;class _{constructor(){this.name="",this.wayPoints=g(j),this.wayPoints.add(j()),this.wayPoints.add(j()),this.notes=g(q),this.itinerary=R(),this.width=t.route.width,this.color=t.route.color,this.dashArray=t.route.dashArray,this.chain=!1,this.chainedDistance=r.defaultValue,this.distance=r.defaultValue,this.duration=r.defaultValue,this.editionStatus=l.notEdited,this.hidden=!1,G.set(this,h())}get computedName(){let e=this.name;return""===e&&(e=(""===this.wayPoints.first.fullName?"???":this.wayPoints.first.fullName)+" â®ž "+(""===this.wayPoints.last.fullName?"???":this.wayPoints.last.fullName)),e}get objId(){return G.get(this)}get objType(){return Z}get jsonObject(){return{name:this.name,wayPoints:this.wayPoints.jsonObject,notes:this.notes.jsonObject,itinerary:this.itinerary.jsonObject,width:this.width,color:this.color,dashArray:this.dashArray,chain:this.chain,distance:parseFloat(this.distance.toFixed(r.fixed)),duration:this.duration,editionStatus:this.editionStatus,hidden:this.hidden,chainedDistance:parseFloat(this.chainedDistance.toFixed(r.fixed)),objId:G.get(this),objType:Z.jsonObject}}set jsonObject(e){let o=function(e){if(!Object.getOwnPropertyNames(e).includes("objType"))throw new Error("No objType for "+Z.name);if(Z.validate(e.objType),Z.version!==e.objType.version)switch(e.objType.version){case"1.0.0":e.dashArray=0,e.hidden=!1;case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":e.edited=l.notEdited;case"1.5.0":case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":e.editionStatus=e.edited;case"1.12.0":case"1.13.0":e.objType.version="2.0.0";break;default:throw new Error("invalid version for "+Z.name)}let t=Object.getOwnPropertyNames(e);return["name","wayPoints","notes","itinerary","width","color","dashArray","chain","distance","duration","editionStatus","hidden","chainedDistance","objId"].forEach(e=>{if(!t.includes(e))throw new Error("No "+e+" for "+Z.name)}),e}(e);this.name=o.name||"",this.wayPoints.jsonObject=o.wayPoints||[],this.notes.jsonObject=o.notes||[],this.itinerary.jsonObject=o.itinerary||R().jsonObject,this.width=o.width||t.route.width,this.color=o.color||"#000000",this.dashArray=o.dashArray||0,this.chain=o.chain||!1,this.distance=o.distance,this.duration=o.duration,this.editionStatus=o.editionStatus||l.notEdited,this.hidden=o.hidden||!1,this.chainedDistance=o.chainedDistance,G.set(this,h())}}function X(){return Object.seal(new _)}const J=p("Travel"),K=new WeakMap;class Q{constructor(){this.editedRoute=X(),this.routes=g(X),this.notes=g(q),this.layerName="OSM - Color",this.name="TravelNotes",this.readOnly=!1,this.userData={},K.set(this,h())}get objId(){return K.get(this)}get objType(){return J}get jsonObject(){return{editedRoute:this.editedRoute.jsonObject,layerName:this.layerName,name:this.name,routes:this.routes.jsonObject,notes:this.notes.jsonObject,userData:this.userData,readOnly:this.readOnly,objId:K.get(this),objType:J.jsonObject}}set jsonObject(e){let t=function(e){if(!Object.getOwnPropertyNames(e).includes("objType"))throw new Error("No objType for "+J.name);if(J.validate(e.objType),J.version!==e.objType.version)switch(e.objType.version){case"1.0.0":case"1.1.0":case"1.2.0":case"1.3.0":case"1.4.0":e.editedRoute=X();case"1.5.0":if(e.userData.layerId){let t=[{layerId:"0",layerName:"OSM - Color"},{layerId:"1",layerName:"OSM - Black and White"},{layerId:"2",layerName:"Thunderforest - Transport"},{layerId:"3",layerName:"Thunderforest - OpenCycleMap"},{layerId:"4",layerName:"Thunderforest - Outdoors"},{layerId:"5",layerName:"Esri - Aerial view"},{layerId:"6",layerName:"Kartverket - Norway"},{layerId:"7",layerName:"IGN-NGI - Belgium now"},{layerId:"12",layerName:"Thunderforest - Landscape"},{layerId:"24",layerName:"LantmÃ¤teriet - Sweden"},{layerId:"25",layerName:"Maanmittauslaitos - Finland"}].find(t=>t.layerId===e.userData.layerId);e.layerName=t?t.layerName:"OSM - Color"}else e.layerName="OSM - Color";case"1.6.0":case"1.7.0":case"1.7.1":case"1.8.0":case"1.9.0":case"1.10.0":case"1.11.0":case"1.12.0":case"1.13.0":e.objType.version="2.0.0";break;default:throw new Error("invalid version for "+J.name)}let t=Object.getOwnPropertyNames(e);return["name","editedRoute","routes","userData","objId"].forEach(e=>{if(!t.includes(e))throw new Error("No "+e+" for "+J.name)}),e}(e);this.editedRoute.jsonObject=t.editedRoute,this.layerName=e.layerName||"OSM - Color",this.name=t.name||"",this.userData=t.userData||{},this.readOnly=t.readOnly||!1,this.routes.jsonObject=t.routes||[],this.notes.jsonObject=t.notes||[],K.set(this,h())}}function Y(){return Object.seal(new Q)}let $=new Map,ee=new Map,te=Object.seal({provider:"",transitMode:""}),oe=v.UUID;const ae=Object.seal(new class{constructor(){this.map=null,this.travel=Y(),this.editedRouteObjId=-1,this.searchData=[]}get providers(){return $}get mapObjects(){return ee}get routing(){return te}get UUID(){return oe}});const re=Object.seal(new class{getRoute(e){let t=null;return t=ae.travel.routes.getAt(e),t||e===ae.travel.editedRoute.objId&&(t=ae.travel.editedRoute),t}getNoteAndRoute(e){let t=null,o=null;if(t=ae.travel.notes.getAt(e),!t){let a=ae.travel.routes.iterator;for(;!a.done&&!t;)t=a.value.notes.getAt(e),t&&(o=a.value);t||(t=ae.travel.editedRoute.notes.getAt(e),t&&(o=ae.travel.editedRoute))}return Object.freeze({note:t,route:o})}getWayPoint(e){let t=ae.travel.editedRoute.wayPoints.getAt(e);if(!t){let o=ae.travel.routes.iterator;for(;!o.done&&!t;)t=o.value.wayPoints.getAt(e)}return t}}),ne=Math.PI/180;function ie(e){return(e+540)%360-180}const se=Object.freeze(new class{getLatLngElevAtDist(e,t){if(e.distance<=t||0>=t)return null;let o=0,a=e.itinerary.itineraryPoints.iterator;for(;o<t&&!a.done;)o+=a.value.distance;let r=a.value;a.done;let n=(r.distance-o+t)/r.distance;return Object.freeze({latLng:[r.lat+(a.value.lat-r.lat)*n,r.lng+(a.value.lng-r.lng)*n],elev:r.elev+(a.value.elev-r.elev)*n,ascent:100*(a.value.elev-r.elev)/r.distance,routeDistance:t})}getClosestLatLngDistance(e,t){if(0===e.itinerary.itineraryPoints.length)return null;let o=e.itinerary.itineraryPoints.iterator;o.done;let a=Number.MAX_VALUE,n=L.Projection.SphericalMercator.project(L.latLng(t[0],t[1])),i=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),s=null,l=r.defaultValue,c=o.value.distance;for(;!o.done;){let e=L.Projection.SphericalMercator.project(L.latLng(o.value.lat,o.value.lng)),t=L.LineUtil.pointToSegmentDistance(n,i,e);t<a&&(a=t,s=L.Projection.SphericalMercator.unproject(L.LineUtil.closestPointOnSegment(n,i,e)),l=c-s.distanceTo(L.latLng(o.value.lat,o.value.lng))),c+=o.value.distance,i=e}return Object.freeze({latLng:[s.lat,s.lng],distance:l})}getLatLngBounds(e){let t=L.latLng([90,180]),o=L.latLng([-90,-180]);return e.forEach(e=>{t.lat=Math.min(t.lat,e[0]),t.lng=Math.min(t.lng,e[1]),o.lat=Math.max(o.lat,e[0]),o.lng=Math.max(o.lng,e[1])}),L.latLngBounds(t,o)}pointsDistance(e,t){if(e[0]===t[0]&&e[1]===t[1])return 0;let o=e[0]*ne,a=t[0]*ne,r=(ie(t[1])-ie(e[1]))*ne;return 6371e3*Math.acos(Math.sin(o)*Math.sin(a)+Math.cos(o)*Math.cos(a)*Math.cos(r))}getSquareBoundingBox(e,t){let o=t/6371e3/ne,a=e[0]*ne,r=Math.acos((Math.cos(t/6371e3)-Math.sin(a)**2)/Math.cos(a)**2)/ne;return L.latLngBounds(L.latLng([e[0]-o,e[1]-r]),L.latLng([e[0]+o,e[1]+r]))}project(e,t){let o=ae.map.project(L.latLng(e),t);return[o.x,o.y]}screenCoordToLatLng(e,t){let o=ae.map.containerPointToLatLng(L.point(e,t));return[o.lat,o.lng]}addPoints(e,t){return[e[0]+t[0],e[1]+t[1]]}subtrackPoints(e,t){return[e[0]-t[0],e[1]-t[1]]}});function le(){let e=null,o=1,a=1,r=Number.MAX_VALUE,n=0,i=0,s=null,l=0,u=t.route.elev.smoothCoefficient,h=t.route.elev.smoothPoints;function p(){let e=function(){let e=0,t=0,o=[],a=s.itinerary.itineraryPoints.iterator,r=0,n=a.done;for(o.push({distance:e,elev:a.value.elev}),r+=a.value.distance,n=a.done;!n;){for(e+=l;e>=r&&!n;)r+=a.value.distance,n=a.done;if(!n){let n=(a.value.elev-a.previous.elev)/a.previous.distance;t=a.value.elev-(r-e)*n,o.push({distance:e,elev:t})}}return o.push({distance:r,elev:s.itinerary.itineraryPoints.last.elev}),o}(),t=new Map,o=(e[h].elev-e[0].elev)/h,a=0;for(a=0;a<h;a++)t.set(a*l,{distance:a*l,elev:e[0].elev+o*a});for(a=h;a<e.length-h;a++){let o=0;for(let t=a-h;a+h>=t;t++)o+=e[t].elev;t.set(e[a].distance,{distance:e[a].distance,elev:o/(2*h+1)})}return a--,o=l*(e[e.length-1].elev-e[e.length-1-h].elev)/(e[e.length-1].distance-e[e.length-1-h].distance),t.set(e[a].distance+l,{distance:e[a].distance+l,elev:e[a].elev+o}),t.set(e[a].distance+2*l,{distance:e[a].distance+2*l,elev:e[a].elev+2*o}),t}function g(t){return s=t,r=Number.MAX_VALUE,n=0,s.itinerary.itineraryPoints.forEach(e=>{n=Math.max(n,e.elev),r=Math.min(r,e.elev)}),i=n-r,o=c.height/i,a=c.width/s.distance,e=document.createElementNS(d,"svg"),e.setAttributeNS(null,"viewBox","0 0 "+(c.width+2*c.margin)+" "+(c.height+2*c.margin)),e.setAttributeNS(null,"class","TravelNotes-SvgProfile"),function(){let t="",r=0,i=0,l=0;s.itinerary.itineraryPoints.forEach(e=>{i=(c.margin+a*r).toFixed(0),l=(c.margin+o*(n-e.elev)).toFixed(0),t+=i+","+l+" ",r+=e.distance});let u=document.createElementNS(d,"polyline");u.setAttributeNS(null,"points",t),u.setAttributeNS(null,"class","TravelNotes-SvgProfile-profilePolyline"),e.appendChild(u)}(),function(){const t=c.margin.toFixed(0),o=(c.margin+c.height).toFixed(0),a=(c.margin+c.width).toFixed(0),r=c.margin.toFixed(0);let n=t+","+r+" "+t+","+o+" "+a+","+o+" "+a+","+r,i=document.createElementNS(d,"polyline");i.setAttributeNS(null,"points",n),i.setAttributeNS(null,"class","TravelNotes-SvgProfile-framePolyline"),e.appendChild(i)}(),function(){let t=Number.MAX_VALUE,a=0;c.vScales.forEach(e=>{let o=Math.abs(i/4-e);o<t&&(t=o,a=e)});let s=Math.ceil(r/a)*a;const l=(c.margin+c.width+c.xDeltaText).toFixed(0),u=(c.margin-c.xDeltaText).toFixed(0);for(;s<n;){let t=c.margin+(n-s)*o,r=document.createElementNS(d,"text");r.appendChild(document.createTextNode(s.toFixed(0))),r.setAttributeNS(null,"class","TravelNotes-SvgProfile-elevLegend"),r.setAttributeNS(null,"x",l),r.setAttributeNS(null,"y",t),r.setAttributeNS(null,"text-anchor","start"),e.appendChild(r);let i=document.createElementNS(d,"text");i.appendChild(document.createTextNode(s.toFixed(0))),i.setAttributeNS(null,"class","TravelNotes-SvgProfile-elevLegend"),i.setAttributeNS(null,"x",u),i.setAttributeNS(null,"y",t),i.setAttributeNS(null,"text-anchor","end"),e.appendChild(i),s+=a}}(),function(){const t=c.margin+c.height+c.margin/2;let o=Number.MAX_VALUE,r=0;c.hScales.forEach(e=>{let t=Math.abs(s.distance/8-e);t<o&&(o=t,r=e)});let n=Math.ceil(s.chainedDistance/r)*r;for(;n<s.distance+s.chainedDistance;){let o=document.createElementNS(d,"text");o.appendChild(document.createTextNode(1e3<r||0<s.chainedDistance?n/1e3+" km":n+" m ")),o.setAttributeNS(null,"class","TravelNotes-SvgProfile-distLegend"),o.setAttributeNS(null,"x",c.margin+(n-s.chainedDistance)*a),o.setAttributeNS(null,"y",t),o.setAttributeNS(null,"text-anchor","start"),e.appendChild(o),n+=r}}(),e}return Object.seal(new class{smooth(e){!function(e){s=e;let t=s.itinerary.itineraryPoints.iterator,o=0,a=0;for(;!t.done;)o+=t.value.distance,a+=t.next?Math.abs(t.value.elev-t.next.elev):0;if(l=10*Math.floor(u/(a/o)),o<=2*h*l)return;let r=p();t=s.itinerary.itineraryPoints.iterator,t.done;let n=t.value.distance;for(;!t.done;){let e=r.get(Math.floor(n/l)*l),o=r.get(Math.ceil(n/l)*l);if(e&&o){let a=n-e.distance,r=(o.elev-e.elev)/(o.distance-e.distance);t.value.elev=e.elev+a*r}n+=t.value.distance}}(e)}createSvg(e){return g(e)}})}function ce(e,t){let a=t.note,r=o.create("div");if(0!==a.tooltipContent.length&&k.parse(a.tooltipContent,o.create("div",{className:e+"NoteHtml-TooltipContent"},r)),0!==a.popupContent.length&&k.parse(a.popupContent,o.create("div",{className:e+"NoteHtml-PopupContent"},r)),0!==a.address.length&&k.parse("<span>"+m.getText("HTMLViewsFactory - Address")+"</span>Â :Â "+a.address,o.create("div",{className:e+"NoteHtml-Address"},r)),0!==a.phone.length&&k.parse(m.getText("HTMLViewsFactory - Phone")+"Â :Â "+a.phone,o.create("div",{className:e+"NoteHtml-Phone"},r)),0!==a.url.length&&k.parse(m.getText("HTMLViewsFactory - Link")+"<a href="+a.url+' target="_blank" >'+a.url.substr(0,40)+"...</a>",o.create("div",{className:e+"NoteHtml-Url"},r)),k.parse(v.formatLatLng(a.latLng),o.create("div",{className:e+"NoteHtml-LatLng"},r)),t.route){t.route.chain&&k.parse("<span>"+m.getText("HTMLViewsFactory - Distance from start of travel")+"</span>Â :Â "+v.formatDistance(a.chainedDistance+a.distance),o.create("div",{className:e+"NoteHtml-Distance"},r)),k.parse("<span>"+m.getText("HTMLViewsFactory - Distance from start of route")+"</span>Â :Â "+v.formatDistance(a.distance),o.create("div",{className:e+"NoteHtml-Distance"},r));let n=t.route.notes.next(a.objId);if(n){let t=n.distance-a.distance;9<t&&k.parse("<span>"+m.getText("HTMLViewsFactory - Next note after")+"</span>Â :Â "+v.formatDistance(t),o.create("div",{className:e+"NoteHtml-NextDistance"},r))}}return r}function de(e,a){let r=o.create("div"),n=o.create("div",{className:e+"Travel-Notes-IconCell"},r);k.parse(a.note.iconContent,n),"svg"===n.firstChild.tagName&&"TravelNotes-Roadbook-"===e&&n.firstChild.setAttributeNS(null,"viewBox","0 0 "+t.note.svgIconWidth+" "+t.note.svgIconWidth);let i=ce(e,a);return i.className=e+"Travel-Notes-Cell",r.appendChild(i),r.noteObjId=a.note.objId,r}function ue(e){let t=o.create("div",{className:e+"Travel-Notes"}),a=ae.travel.notes.iterator;for(;!a.done;){let o=de(e,{note:a.value,route:null});o.className=e+"Travel-Notes-Row",t.appendChild(o)}return t}function he(e,t){let a=o.create("div",{className:e+"Route-Header",id:"route"+t.objId});return k.parse(t.computedName,o.create("div",{className:e+"Route-Header-Name"},a)),0!==t.distance&&k.parse(m.getText("HTMLViewsFactory - Route distance",{distance:v.formatDistance(t.distance)}),o.create("div",{className:e+"Route-Header-Distance"},a)),ae.travel.readOnly||"bike"===t.itinerary.transitMode||k.parse(m.getText("HTMLViewsFactory - Duration",{duration:v.formatTime(t.duration)}),o.create("div",{className:e+"Route-Header-Duration"},a)),t.itinerary.hasProfile&&(k.parse(m.getText("HTMLViewsFactory - Ascent",{ascent:t.itinerary.ascent.toFixed(0)}),o.create("div",{className:e+"Route-Header-Ascent"},a)),k.parse(m.getText("HTMLViewsFactory - Descent",{descent:t.itinerary.descent.toFixed(0)}),o.create("div",{className:e+"Route-Header-Descent"},a))),a}function pe(e,t){let a=o.create("div");o.create("div",{className:e+"Route-ManeuversAndNotes-IconCell TravelNotes-ManeuverNote-"+t.maneuver.iconName},a);let n=o.create("div",{className:e+"Route-ManeuversAndNotes-Cell"},a);return k.parse(t.maneuver.instruction,o.create("div",null,n)),t.route.chain&&k.parse("<span>"+m.getText("HTMLViewsFactory - Distance from start of travel")+"</span>Â :Â "+v.formatDistance(t.route.chainedDistance+t.maneuverDistance),o.create("div",null,n)),k.parse("<span>"+m.getText("HTMLViewsFactory - Distance from start of route")+"</span>Â :Â "+v.formatDistance(t.maneuverDistance),o.create("div",null,n)),r.defaultValue<t.maneuver.distance&&k.parse("<span>"+m.getText("HTMLViewsFactory - Next maneuver after")+"</span>Â :Â "+v.formatDistance(t.maneuver.distance),o.create("div",null,n)),a}function ge(e,t){let a=[],r=t.notes.iterator;for(;!r.done;){let o=de(e,{note:r.value,route:t});o.className=e+"Route-Notes-Row",o.objId=h(),o.latLng=r.value.latLng,o.noteObjId=r.value.objId,o.distance=r.value.distance,a.push(o)}let n=t.itinerary.maneuvers.iterator,i=0;for(;!n.done;){let o=pe(e,{route:t,maneuver:n.value,maneuverDistance:i});o.className=e+"Route-Maneuvers-Row",o.objId=h(),o.latLng=t.itinerary.itineraryPoints.getAt(n.value.itineraryPointObjId).latLng,o.maneuverObjId=n.value.objId,o.distance=i,a.push(o),i+=n.value.distance}a.sort((e,t)=>e.distance-t.distance);let s=o.create("div",{className:e+"Route-ManeuversAndNotes"});return a.forEach(e=>s.appendChild(e)),s}function fe(e,t){let a="";""!==t.itinerary.provider&&""!==t.itinerary.transitMode&&(a=m.getText("HTMLViewsFactory - Itinerary computed by {provider} and optimized for {transitMode}",{provider:t.itinerary.provider,transitMode:m.getText("HTMLViewsFactory - TransitMode "+t.itinerary.transitMode)}));let r=o.create("div",{className:e+"RouteFooter"});return k.parse(a,r),r}function me(e,t){let a=o.create("div",{className:e+"RouteProfile"});return k.parse(m.getText("HTMLViewsFactory - Profile"),a),a.appendChild(le().createSvg(t)),a}function ve(e){let a=o.create("div",{className:e+"Travel"});a.appendChild(function(e){let a=o.create("div",{className:e+"Travel-Header"});k.parse(ae.travel.name,o.create("div",{className:e+"Travel-Header-Name"},a));let n=r.defaultValue,i=0,s=0,l=ae.travel.routes.iterator;for(;!l.done;){let r=l.value.objId===ae.editedRouteObjId&&t.routeEditor.displayEditionInHTMLPage?ae.travel.editedRoute:l.value;k.parse('<a href="#route'+r.objId+'" >'+r.computedName+"</a>Â :Â "+v.formatDistance(r.distance)+".",o.create("div",{className:e+"Travel-Header-RouteName"},a)),r.chain&&(n+=r.distance,i+=r.itinerary.ascent,s+=r.itinerary.descent)}return k.parse(m.getText("HTMLViewsFactory - Travel distance",{distance:v.formatDistance(n)}),o.create("div",{className:e+"Travel-Header-TravelDistance"},a)),0!==i&&k.parse(m.getText("HTMLViewsFactory - Travel ascent",{ascent:i.toFixed(0)}),o.create("div",{className:e+"Travel-Header-TravelAscent"},a)),0!==s&&k.parse(m.getText("HTMLViewsFactory - Travel descent",{descent:s.toFixed(0)}),o.create("div",{className:e+"Travel-Header-TravelDescent"},a)),a}(e)),a.appendChild(ue(e));let n=ae.travel.routes.iterator;for(;!n.done;){let o=t.routeEditor.displayEditionInHTMLPage&&n.value.objId===ae.editedRouteObjId?ae.travel.editedRoute:n.value;a.appendChild(he(e,o)),o.itinerary.hasProfile&&a.appendChild(me(e,o)),a.appendChild(ge(e,o)),a.appendChild(fe(e,o))}return a.appendChild(function(e){let t=m.getText("HTMLViewsFactory - Travel footer")+'<a href="https://github.com/wwwouaiebe/leaflet.TravelNotes" target="_blank" title="https://github.com/wwwouaiebe/leaflet.TravelNotes" >Travel & Notes</a>, Â© <a href="https://www.ouaie.be/" target="_blank" title="https://www.ouaie.be/" >wwwouaiebe 2017 2021</a> Â© <a href="https://www.openstreetmap.org/copyright" target="_blank" title="https://www.openstreetmap.org/copyright">'+m.getText("HTMLViewsFactory - OpenStreetMap contributors")+"</a>",a=o.create("div",{className:e+"TravelFooter"});return k.parse(t,a),a}(e)),a}const be=Object.freeze(new class{getTravelHTML(e){return ve(e)}getNoteTextHTML(e,t){return ce(e,t)}getEditedRouteManeuversAndNotesHTML(e){return ge(e,ae.travel.editedRoute)}getTravelNotesHTML(e){return ue(e)}getRouteHeaderHTML(e,t){return he(e,t)}});let ye=null,we=null;function je(e){let t=re.getRoute(e.target.objId),o=se.getClosestLatLngDistance(t,[e.latlng.lat,e.latlng.lng]).distance;o+=t.chainedDistance,o=v.formatDistance(o);let a=ae.mapObjects.get(e.target.objId);a.closeTooltip();let r=t.computedName;ae.travel.readOnly||(r+=0===r.length?"":" - ",r+=o),a.setTooltipContent(r),a.openTooltip(e.latlng)}function Ne(e,t){t.objId=e,t.addTo(ae.map),ae.mapObjects.set(e,t)}function Te(e){let o=re.getNoteAndRoute(e).note,a=L.marker(o.latLng,{icon:L.divIcon({iconSize:[t.note.grip.size,t.note.grip.size],iconAnchor:[t.note.grip.size/2,t.note.grip.size/2],html:"<div></div>",className:"TravelNotes-Note-Bullet"}),opacity:t.note.grip.opacity,draggable:!ae.travel.readOnly});a.objId=o.objId;let r=L.divIcon({iconSize:[o.iconWidth,o.iconHeight],iconAnchor:[o.iconWidth/2,o.iconHeight/2],popupAnchor:[0,-o.iconHeight/2],html:o.iconContent,className:"TravelNotes-AllNotes "+t.note.style});let n=L.marker(o.iconLatLng,{zIndexOffset:100,icon:r,draggable:!ae.travel.readOnly});n.objId=o.objId,n.bindPopup(e=>be.getNoteTextHTML("TravelNotes-",re.getNoteAndRoute(e.objId))),0!==o.tooltipContent.length&&(n.bindTooltip(e=>re.getNoteAndRoute(e.objId).note.tooltipContent),n.getTooltip().options.offset[0]=o.iconWidth/2);let i=L.polyline([o.latLng,o.iconLatLng],t.note.polyline);i.objId=o.objId;let s=L.layerGroup([n,i,a]);return s.markerId=L.Util.stamp(n),s.polylineId=L.Util.stamp(i),s.bulletId=L.Util.stamp(a),Ne(o.objId,s),t.note.haveBackground&&document.querySelectorAll(".TravelNotes-MapNote,.TravelNotes-SvgIcon").forEach(e=>e.classList.add("TravelNotes-MapNote-Background")),Object.freeze({marker:n,polyline:i,bullet:a})}function Le(e){e.dashArray>=t.route.dashChoices.length&&(e.dashArray=0);let o=t.route.dashChoices[e.dashArray].iDashArray;if(o){let t="",a=0;for(a=0;a<o.length-1;a++)t+=o[a]*e.width+",";return t+=o[a]*e.width,t}return null}const Oe=Object.seal(new class{addRoute(e){let t=re.getRoute(e),o=[],a=t.itinerary.itineraryPoints.iterator;for(;!a.done;)o.push(a.value.latLng);let r=L.polyline(o,{color:t.color,weight:t.width,dashArray:Le(t)});Ne(t.objId,r),l.notEdited===t.editionStatus&&(r.bindTooltip(t.computedName,{sticky:!0,direction:"right"}),r.on("mouseover",je),r.on("mousemove",je)),r.bindPopup(e=>{let t=re.getRoute(e.objId);return be.getRouteHeaderHTML("TravelNotes-UI-",t)}),L.DomEvent.on(r,"click",e=>e.target.openPopup(e.latlng));let n=t.notes.iterator;for(;!n.done;)Te(n.value.objId);return t}addNote(e){return Te(e)}getDashArray(e){return Le(e)}zoomTo(e,o){if(o){let e=[];o.forEach(t=>e=e.concat(t)),ae.map.fitBounds(se.getLatLngBounds(e))}else ae.map.setView(e,t.itineraryPointZoom)}setLayer(e){let t=null;t="wmts"===e.service.toLowerCase()?L.tileLayer(e.url):L.tileLayer.wms(e.url,e.wmsOptions),ye&&ae.map.removeLayer(ye),ae.map.addLayer(t),ye=t,ae.travel.readOnly||(ae.map.getZoom()<(e.minZoom||0)&&ae.map.setZoom(e.minZoom||0),ae.map.setMinZoom(e.minZoom||0),ae.map.getZoom()>(e.maxZoom||18)&&ae.map.setZoom(e.maxZoom||18),ae.map.setMaxZoom(e.maxZoom||18),e.bounds?(ae.map.getBounds().intersects(e.bounds)&&!ae.map.getBounds().contains(e.bounds)||(ae.map.setMaxBounds(null),ae.map.fitBounds(e.bounds),ae.map.setZoom(e.minZoom||0)),ae.map.setMaxBounds(e.bounds)):ae.map.setMaxBounds(null)),ae.map.fire("baselayerchange",t)}onGeolocationStatusChanged(e){n.active!==e&&we&&(ae.map.removeLayer(we),we=null)}onGeolocationPositionChanged(e){let o=t.geoLocation.zoomToPosition;we&&(ae.map.removeLayer(we),o=!1),we=L.circleMarker(L.latLng(e.coords.latitude,e.coords.longitude),{radius:t.geoLocation.radius,color:t.geoLocation.color}).bindTooltip(v.formatLatLng([e.coords.latitude,e.coords.longitude])).addTo(ae.map),o&&ae.map.setView(L.latLng(e.coords.latitude,e.coords.longitude),t.geoLocation.zoomFactor)}});const Me=Object.freeze(new class{dispatch(e,t){let o=function(e){return-1<["showitinerary","updateitinerary","showtravelnotes","updatetravelnotes","showsearch","updatesearch","setrouteslist","setprovider","providersadded","travelnameupdated","settransitmode"].indexOf(e)?document.getElementById("TravelNotes-UI-MainDiv"):-1<["removeobject","removeallobjects","zoomto","additinerarypointmarker","addsearchpointmarker","addrectangle","addwaypoint","layerchange","geolocationstatuschanged","geolocationpositionchanged","routeupdated","routepropertiesupdated","noteupdated","roadbookupdate","profileclosed"].indexOf(e)?document:null}(e);if(o){let a=new Event(e);t&&(a.data=t),o.dispatchEvent(a)}}});var xe={};function Ie(e){return Math.floor(Math.abs(e)+.5)*(e>=0?1:-1)}function Pe(e,t,o){var a=(e=Ie(e*o))-(t=Ie(t*o));a<<=1,e-t<0&&(a=~a);for(var r="";a>=32;)r+=String.fromCharCode(63+(32|31&a)),a>>=5;return r+=String.fromCharCode(a+63)}function Ae(e){for(var t=[],o=0;o<e.length;o++){var a=e[o].slice();t.push([a[1],a[0]])}return t}function Ce(){let e=[];function t(t){e.push(t.latLng),e.push(t.iconLatLng)}function o(o){o.itinerary.itineraryPoints.forEach(t=>e.push(t.latLng)),o.notes.forEach(e=>t(e))}return Object.seal(new class{zoomToLatLng(e){Me.dispatch("zoomto",{latLng:e})}zoomToManeuver(e){let t=ae.travel.editedRoute.itinerary.maneuvers.getAt(e).itineraryPointObjId,o=ae.travel.editedRoute.itinerary.itineraryPoints.getAt(t).latLng;Me.dispatch("zoomto",{latLng:o})}zoomToNote(o){e=[],t(re.getNoteAndRoute(o).note),Me.dispatch("zoomto",{geometry:[e]})}zoomToRoute(t){e=[],o(re.getRoute(t)),Me.dispatch("zoomto",{geometry:[e]})}zoomToTravel(){e=[],ae.travel.routes.forEach(e=>o(e)),-1!==ae.travel.editedRouteObjId&&o(ae.travel.editedRoute),ae.travel.notes.forEach(e=>t(e)),Me.dispatch("zoomto",{geometry:[e]})}zoomToPoi(e){Me.dispatch("zoomto",e)}})}function Ee(){return Object.seal(new class{openDistantFile(e){(function(){function e(e){let t={};0!==e.itinerary.itineraryPoints.length&&(t=e.itinerary.itineraryPoints[0].objType);let o={latLngs:[],distances:[],elevs:[],objIds:[],objType:t};e.itinerary.itineraryPoints.forEach(e=>{o.latLngs.push([e.lat,e.lng]),o.distances.push(e.distance),o.elevs.push(e.elev),o.objIds.push(e.objId)}),o.latLngs=xe.encode(o.latLngs,6),e.itinerary.itineraryPoints=o}function t(e){e.itinerary.itineraryPoints.latLngs=xe.decode(e.itinerary.itineraryPoints.latLngs,6);let t=[],o=0;e.itinerary.itineraryPoints.latLngs.forEach(a=>{let r={};r.lat=a[0],r.lng=a[1],r.distance=e.itinerary.itineraryPoints.distances[o],e.itinerary.itineraryPoints.elevs?r.elev=e.itinerary.itineraryPoints.elevs[o]:r.elev=i.defaultValue,r.objId=e.itinerary.itineraryPoints.objIds[o],r.objType=e.itinerary.itineraryPoints.objType,t.push(r),o++}),e.itinerary.itineraryPoints=t}function o(e){e.routes.forEach(t),e.editedRoute&&t(e.editedRoute)}return Object.seal(new class{decompress(e){o(e),ae.travel.jsonObject=e,ae.editedRouteObjId=-1,ae.travel.routes.forEach(e=>{l.notEdited!==e.editionStatus&&(ae.editedRouteObjId=e.objId)})}decompressMerge(e){o(e);let t=Y();t.jsonObject=e;let a=t.routes.iterator;for(;!a.done;)ae.travel.routes.add(a.value);let r=t.notes.iterator;for(;!r.done;)ae.travel.notes.add(r.value)}compress(){let t=ae.travel.jsonObject;return t.routes.forEach(e),e(t.editedRoute),t}})})().decompress(e),ae.travel.readOnly=!0,this.display()}display(){let e=ae.travel.routes.iterator;for(;!e.done;)l.notEdited===e.value.editionStatus&&Me.dispatch("routeupdated",{removedRouteObjId:-1,addedRouteObjId:e.value.objId});-1!==ae.editedRouteObjId&&Me.dispatch("routeupdated",{removedRouteObjId:-1,addedRouteObjId:ae.travel.editedRoute.objId});let t=ae.travel.notes.iterator;for(;!t.done;)Me.dispatch("noteupdated",{removedNoteObjId:-1,addedNoteObjId:t.value.objId});Ce().zoomToTravel()}})}xe.decode=function(e,t){for(var o,a=0,r=0,n=0,i=[],s=0,l=0,c=null,d=Math.pow(10,Number.isInteger(t)?t:5);a<e.length;){c=null,s=0,l=0;do{l|=(31&(c=e.charCodeAt(a++)-63))<<s,s+=5}while(c>=32);o=1&l?~(l>>1):l>>1,s=l=0;do{l|=(31&(c=e.charCodeAt(a++)-63))<<s,s+=5}while(c>=32);r+=o,n+=1&l?~(l>>1):l>>1,i.push([r/d,n/d])}return i},xe.encode=function(e,t){if(!e.length)return"";for(var o=Math.pow(10,Number.isInteger(t)?t:5),a=Pe(e[0][0],0,o)+Pe(e[0][1],0,o),r=1;r<e.length;r++){var n=e[r],i=e[r-1];a+=Pe(n[0],i[0],o),a+=Pe(n[1],i[1],o)}return a},xe.fromGeoJSON=function(e,t){if(e&&"Feature"===e.type&&(e=e.geometry),!e||"LineString"!==e.type)throw new Error("Input must be a GeoJSON LineString");return xe.encode(Ae(e.coordinates),t)},xe.toGeoJSON=function(e,t){return{type:"LineString",coordinates:Ae(xe.decode(e,t))}},"object"==typeof module&&module.exports&&(module.exports=xe);const Se=Object.seal(new class{createUI(){o.create("div",{id:"TravelNotes-AttributionsUI"},document.querySelector("body")),this.attributions=""}set attributions(e){let t='Â© <a href="https://leafletjs.com/" target="_blank" title="Leaflet">Leaflet</a> | Â© <a href="https://www.openstreetmap.org/copyright" target="_blank" title="OpenStreetMap contributors">OpenStreetMap contributors</a> '+e+'| Â© <a href="https://github.com/wwwouaiebe" target="_blank" title="https://github.com/wwwouaiebe">Travel & Notes</a>',o=document.getElementById("TravelNotes-AttributionsUI");for(;o.firstChild;)o.removeChild(o.firstChild);k.parse(t,o)}});let Re="geolocation"in navigator?n.inactive:n.disabled,De=null;function Fe(e){Me.dispatch("geolocationpositionchanged",{position:e})}function He(){n.active===Re&&(Re=n.inactive),Me.dispatch("geolocationstatuschanged",{status:Re}),navigator.geolocation.clearWatch(De),De=null}function Ve(e){1===e.code&&(Re=n.refusedByUser),He()}const ke=Object.seal(new class{get status(){return Re}switch(){switch(Re){case n.inactive:Re=n.active,Me.dispatch("geolocationstatuschanged",{status:Re}),navigator.geolocation.getCurrentPosition(Fe,Ve,t.geoLocation.options),De=navigator.geolocation.watchPosition(Fe,Ve,t.geoLocation.options);break;case n.active:He()}return Re}});let Ue=null,ze=[{service:"wmts",url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",name:"OSM - Color",toolbar:{text:"OSM",color:"red",backgroundColor:"white"},providerName:"OSM",providerKeyNeeded:!1,attribution:""}];function Be(e){e.stopPropagation(),Me.dispatch("layerchange",{layer:e.target.layer}),Se.attributions=e.target.layer.attribution}function We(e){e.stopPropagation(),ke.switch()}function qe(e){e.stopPropagation(),Ce().zoomToTravel()}function Ze(e){o.create("div",{className:"TravelNotes-ViewerLayersToolbarUI-Button",title:e.name,layer:e,textContent:e.toolbar.text,style:"color:"+e.toolbar.color+";background-color:"+e.toolbar.backgroundColor},Ue).addEventListener("click",Be,!1)}const Ge=Object.seal(new class{createUI(){Ue=o.create("div",{id:"TravelNotes-ViewerLayersToolbarUI"},document.querySelector("body")),o.create("div",{className:"TravelNotes-ViewerLayersToolbarUI-Button",title:"My position",textContent:"ðŸŒ",style:"color:black;background-color:white"},Ue).addEventListener("click",We,!1),o.create("div",{className:"TravelNotes-ViewerLayersToolbarUI-Button",title:"Zoom on the travel",textContent:"ðŸ”",style:"color:black;background-color:white"},Ue).addEventListener("click",qe,!1),ze.forEach(Ze)}setLayer(e){let t=ze.find(t=>t.name===e)||ze[0];Me.dispatch("layerchange",{layer:t}),Se.attributions=t.attribution}addLayers(e){e.forEach(e=>{e.providerKeyNeeded||ze.push(e)})}});let _e=!1;const Xe=Object.seal(new class{addReadOnlyMap(e,t){_e||(_e=!0,document.addEventListener("routeupdated",e=>{e.data&&Oe.addRoute(e.data.addedRouteObjId)},!1),document.addEventListener("noteupdated",e=>{e.data&&Oe.addNote(e.data.addedNoteObjId)},!1),document.addEventListener("zoomto",e=>{e.data&&Oe.zoomTo(e.data.latLng,e.data.geometry)},!1),document.addEventListener("layerchange",e=>{e.data&&Oe.setLayer(e.data.layer)}),document.addEventListener("geolocationpositionchanged",e=>{e.data&&Oe.onGeolocationPositionChanged(e.data.position)},!1),document.addEventListener("geolocationstatuschanged",e=>{e.data&&Oe.onGeolocationStatusChanged(e.data.status)},!1),Se.createUI(),t&&Ge.createUI(),Ge.setLayer("OSM - Color"),e&&a.getJsonPromise(e).then(e=>{Ee().openDistantFile(e)}).catch(e=>{console.log(e||"Not possible to load the .trv file"),ae.map.setView([s.defaultValue,s.defaultValue],2)}))}});(function(){let e=null,r=null,n=!1,i="";function l(o){var a,r,n,s;(a=o[0],i="fulfilled"===a.status?(a.value.language=e,"wwwouaiebe.github.io"===window.location.hostname&&(a.value.note.haveBackground=!0),t.overload(a.value),""):"Not possible to load the TravelNotesConfig.json file. ",i)?console.log(i):(r=o[1],n=o[3],i="fulfilled"===r.status?(m.setTranslations(r.value),""):"fulfilled"===n.status?(m.setTranslations(n.value),"Not possible to load the TravelNotes"+e.toUpperCase()+".json file. English will be used. "):"Not possible to load the translations. ",i+="fulfilled"===(s=o[2]).status?(Ge.addLayers(s.value),""):"Not possible to load the TravelNotesLayers.json file. Only the OpenStreetMap background will be available. ",""!==i&&(console.log(i),i=""))}return Object.freeze(new class{start(){window.L.travelNotes=Xe,window.location.search.substr(1).split("&").forEach(t=>{"fil="===t.substr(0,4).toLowerCase()?r=atob(t.substr(4)):"lng="===t.substr(0,4).toLowerCase()?e=t.substr(4).toLowerCase():"lay"===t.substr(0,3).toLowerCase()&&(n=!0)}),e=e||t.language,Promise.allSettled(function(){let t=window.location.origin+window.location.pathname+"TravelNotes";return[a.getJsonPromise(t+"Config.json"),a.getJsonPromise(t+e.toUpperCase()+".json"),a.getJsonPromise(t+"Layers.json"),a.getJsonPromise(t+"EN.json")]}()).then(e=>{l(e),function(){if(t.autoLoad&&""===i){o.create("div",{id:"Map"},document.querySelector("body"));let e=window.L.map("Map",{attributionControl:!1,zoomControl:!1}).setView([s.defaultValue,s.defaultValue],0);ae.map=e,Xe.addReadOnlyMap(r,n)}}()})}})})().start()}();