/**
 * 
 * @source: https://github.com/wwwouaiebe/leaflet.TravelNotes
 * 
 * @licstart  The following is the entire license notice for the
 * JavaScript code in this page.
 * 
 * leaflet.travelnotes - version 1.13.0
 * Build 00637 - 2020-12-20T13:11:09+0100 
 * Copyright 2017 2020 wwwouaiebe 
 * Contact: https://www.ouaie.be/
 * License: GPL-3.0
 * 
 * The JavaScript code in this page is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 * 
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 * 
 * @licend  The above is the entire license notice
 * for the JavaScript code in this page.
 * 
 */


!function(){"use strict";
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Translator.js
	@copyright Copyright - 2017 2020 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/let e=new Map;const t=Object.freeze(new class{setTranslations(t){t.forEach(t=>e.set(t.msgid,t.msgstr))}getText(t,o){let n=e.get(t);return o&&n&&Object.getOwnPropertyNames(o).forEach(e=>n=n.replace("{"+e+"}",o[e])),n||t}});const o=Object.freeze(new
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file HttpRequestBuilder.js
	@copyright Copyright - 2017 2020 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/
class{getTextPromise(e,t){return new Promise((function(o,n){let r=new XMLHttpRequest;r.timeout=4e4,r.ontimeout=function(){n("XMLHttpRequest TimeOut. File : "+r.responseURL)},r.onreadystatechange=function(){4===r.readyState&&(200===r.status?o(r.responseText):n("Error XMLHttpRequest - File : "+r.responseURL))},r.open("GET",e,!0),t&&t.forEach(e=>r.setRequestHeader(e.headerName,e.headerValue)),r.overrideMimeType("text/plain"),r.send(null)}))}getJsonPromise(e,t){return new Promise((function(o,n){let r=new XMLHttpRequest;r.timeout=4e4,r.ontimeout=function(){n("XMLHttpRequest TimeOut. File : "+r.responseURL)},r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){let e=null;try{e=JSON.parse(r.responseText)}catch(e){n(e.message+" File: "+r.responseURL)}o(e)}else n("Error XMLHttpRequest - File : "+r.responseURL)},r.open("GET",e,!0),t&&t.forEach(e=>r.setRequestHeader(e.headerName,e.headerValue)),r.overrideMimeType("application/json"),r.send(null)}))}getBinaryPromise(e,t){return new Promise((function(o,n){let r=new XMLHttpRequest;r.timeout=4e4,r.ontimeout=function(){n("XMLHttpRequest TimeOut. File : "+r.responseURL)},r.onload=function(){if(200===r.status){let e=r.response;e?o(e):n("Error XMLHttpRequest - File : "+r.responseURL)}else n("Error XMLHttpRequest - File : "+r.responseURL)},r.open("GET",e,!0),t&&t.forEach(e=>r.setRequestHeader(e.headerName,e.headerValue)),r.responseType="arraybuffer",r.send(null)}))}});
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file IndexedDb.js
	@copyright Copyright - 2017 2020 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/let n=null;const r=Object.freeze(new class{getOpenPromise(){return new Promise((function(e,t){if(n)return void e();let o=window.indexedDB.open("TravelNotesDb",1);o.onerror=function(){n=null,t(new Error("Not possible to open the db"))},o.onsuccess=function(t){n=t.target.result,e()},o.onupgradeneeded=function(e){n=e.target.result,n.createObjectStore("Travels",{keyPath:"UUID"})}}))}getReadPromise(e){return new Promise((function(t,o){if(!n)return void o(new Error("Database not opened"));let r=n.transaction(["Travels"],"readonly");r.onerror=function(){o(new Error("Transaction error"))},r.objectStore("Travels").get(e).onsuccess=function(e){t(e.target.result?e.target.result.data:null)}}))}getWritePromise(e,t){return new Promise((function(o,r){if(!n)return void r(new Error("Database not opened"));let s=null;try{s=n.transaction(["Travels"],"readwrite")}catch(e){return void r(e)}s.onerror=function(){r(new Error("Transaction error"))},s.objectStore("Travels").put({UUID:e,data:t}).onsuccess=function(){o()}}))}closeDb(e){if(!n)return;if(!e)return n.close(),void(n=null);let t=n.transaction(["Travels"],"readwrite");t.onerror=function(){};let o=t.objectStore("Travels").delete(e);o.onerror=function(){n.close(),n=null},o.onsuccess=function(){n.close(),n=null}}});
/**
	@------------------------------------------------------------------------------------------------------------------------------

	@file Constants.js
	@copyright Copyright - 2017 2020 - wwwouaiebe - Contact: https://www.ouaie.be/
	@license GNU General Public License
	@private

	@------------------------------------------------------------------------------------------------------------------------------
	*/Object.freeze({fixed:2,invalid:-1,defaultValue:0}),Object.freeze({refusedByUser:-1,disabled:0,inactive:1,active:2}),Object.freeze({invalidPane:"43a6a53e-008a-4910-80a6-7a87d301ea15",itineraryPane:"8fbf0da7-4e6f-4bc7-8e20-1388461ccde7",travelNotesPane:"dffe782b-07df-4b81-a318-f287c0cf5ec6",searchPane:"228f00d7-43a8-4c13-897d-70400cb6dd58"}),Object.freeze({fixed:2,defaultValue:0}),Object.freeze({defaultValue:0,fixed:6}),Object.freeze({notEdited:0,editedNoChange:1,editedChanged:2}),Object.freeze({margin:100,height:500,width:1e3,yDeltaText:30,xDeltaText:10,vScales:[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3],hScales:[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5]}),Object.freeze({width:40,height:40});function s(){let e=document.getElementById("TravelNotes-Travel-ShowNotes").checked,t=document.getElementsByClassName("TravelNotes-Roadbook-Travel-Notes-Row");for(let o=0;o<t.length;o++)e?t[o].classList.remove("TravelNotes-Roadbook-Hidden-Row"):t[o].classList.add("TravelNotes-Roadbook-Hidden-Row")}function a(){let e=document.getElementById("TravelNotes-Routes-ShowNotes").checked,t=document.getElementsByClassName("TravelNotes-Roadbook-Route-Notes-Row");for(let o=0;o<t.length;o++)e?t[o].classList.remove("TravelNotes-Roadbook-Hidden-Row"):t[o].classList.add("TravelNotes-Roadbook-Hidden-Row")}function l(){let e=document.getElementById("TravelNotes-Routes-ShowManeuvers").checked,t=document.getElementsByClassName("TravelNotes-Roadbook-Route-Maneuvers-Row");for(let o=0;o<t.length;o++)e?t[o].classList.remove("TravelNotes-Roadbook-Hidden-Row"):t[o].classList.add("TravelNotes-Roadbook-Hidden-Row")}document.getElementById("TravelNotes-Travel-ShowNotes").addEventListener("change",s),document.getElementById("TravelNotes-Routes-ShowNotes").addEventListener("change",a),document.getElementById("TravelNotes-Routes-ShowManeuvers").addEventListener("change",l);let d=new URLSearchParams(document.location.search.substring(1)),i=d.get("lng"),c=d.get("page");c?(r.getOpenPromise().then(()=>r.getReadPromise(c)).then(e=>{document.getElementById("TravelNotes").innerHTML=e,s(),a(),l()}).catch(e=>console.log(e||"An error occurs when loading the content")),window.addEventListener("storage",()=>{r.getReadPromise(c).then(e=>{e?(document.getElementById("TravelNotes").innerHTML=e,s(),a(),l()):document.getElementById("TravelNotes").innerHTML=""}).catch(e=>console.log(e||"An error occurs when loading the content"))}),window.addEventListener("unload",()=>{r.closeDb()})):document.getElementById("TravelNotes-Menu").removeChild(document.getElementById("TravelNotes-ButtonContainer")),i&&o.getJsonPromise(window.location.href.substr(0,window.location.href.lastIndexOf("/")+1)+"TravelNotes"+i.toUpperCase()+".json").then(e=>{t.setTranslations(e),document.getElementById("TravelNotes-Travel-ShowNotesLabel").innerHTML=t.getText("Roadbook - show travel notes"),document.getElementById("TravelNotes-Routes-ShowManeuversLabel").innerHTML=t.getText("Roadbook - show maneuver"),document.getElementById("TravelNotes-Routes-ShowNotesLabel").innerHTML=t.getText("Roadbook - show routes notes"),document.getElementById("TravelNotes-SaveFile").value=t.getText("Roadbook - Save")}).catch(e=>console.log(e||"An error occurs when loading translation")),s(),a(),l()}();